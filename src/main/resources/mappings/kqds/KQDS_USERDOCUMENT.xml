<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="KQDS_USERDOCUMENT">
    <resultMap id="BaseResultMap" type="com.kqds.entity.base.KqdsUserdocument">
        <id column="SEQ_ID" jdbcType="VARCHAR" property="seqId"/>
        <result column="UserCode" jdbcType="VARCHAR" property="usercode"/>
        <result column="UserName" jdbcType="VARCHAR" property="username"/>
        <result column="Sex" jdbcType="VARCHAR" property="sex"/>
        <result column="BirthDay" jdbcType="VARCHAR" property="birthday"/>
        <result column="Age" jdbcType="INTEGER" property="age"/>
        <result column="Profession" jdbcType="VARCHAR" property="profession"/>
        <result column="IDCardNo" jdbcType="VARCHAR" property="idcardno"/>
        <result column="PhoneNumber1" jdbcType="VARCHAR" property="phonenumber1"/>
        <result column="PhoneNumber2" jdbcType="VARCHAR" property="phonenumber2"/>
        <result column="guider" jdbcType="VARCHAR" property="guider"/>
        <result column="UserImpress" jdbcType="VARCHAR" property="userimpress"/>
        <result column="Introducer" jdbcType="VARCHAR" property="introducer"/>
        <result column="PlateNumber" jdbcType="VARCHAR" property="platenumber"/>
        <result column="CostLevel" jdbcType="VARCHAR" property="costlevel"/>
        <result column="Dress" jdbcType="VARCHAR" property="dress"/>
        <result column="FirstWord" jdbcType="VARCHAR" property="firstword"/>
        <result column="Province" jdbcType="VARCHAR" property="province"/>
        <result column="City" jdbcType="VARCHAR" property="city"/>
        <result column="Address" jdbcType="VARCHAR" property="address"/>
        <result column="DevChannel" jdbcType="VARCHAR" property="devchannel"/>
        <result column="CreateTime" jdbcType="VARCHAR" property="createtime"/>
        <result column="CreateUser" jdbcType="VARCHAR" property="createuser"/>
        <result column="AskPerson" jdbcType="VARCHAR" property="askperson"/>
        <result column="isdelete" jdbcType="INTEGER" property="isdelete"/>
        <result column="organization" jdbcType="VARCHAR" property="organization"/>
        <result column="medicalhistory" jdbcType="VARCHAR" property="medicalhistory"/>
        <result column="drugllergy" jdbcType="VARCHAR" property="drugllergy"/>
        <result column="remark" jdbcType="VARCHAR" property="remark"/>
        <result column="experience" jdbcType="VARCHAR" property="experience"/>
        <result column="habit" jdbcType="VARCHAR" property="habit"/>
        <result column="email" jdbcType="VARCHAR" property="email"/>
        <result column="type" jdbcType="INTEGER" property="type"/>
        <result column="xueli" jdbcType="VARCHAR" property="xueli"/>
        <result column="qq" jdbcType="VARCHAR" property="qq"/>
        <result column="doctor" jdbcType="VARCHAR" property="doctor"/>
        <result column="important" jdbcType="VARCHAR" property="important"/>
        <result column="nexttype" jdbcType="VARCHAR" property="nexttype"/>
        <result column="totalpay" jdbcType="DECIMAL" property="totalpay"/>
        <result column="developer" jdbcType="VARCHAR" property="developer"/>
        <result column="doorstatus" jdbcType="INTEGER" property="doorstatus"/>
        <result column="glr" jdbcType="VARCHAR" property="glr"/>
        <result column="glrremark" jdbcType="VARCHAR" property="glrremark"/>
        <result column="xgr" jdbcType="VARCHAR" property="xgr"/>
        <result column="xgtime" jdbcType="VARCHAR" property="xgtime"/>
        <result column="town" jdbcType="VARCHAR" property="town"/>
        <result column="kefu" jdbcType="VARCHAR" property="kefu"/>
        <result column="usersort" jdbcType="VARCHAR" property="usersort"/>
        <result column="openid" jdbcType="VARCHAR" property="openid"/>
        <result column="bindstatus" jdbcType="VARCHAR" property="bindstatus"/>
        <result column="pym" jdbcType="VARCHAR" property="pym"/>
        <result column="integral" jdbcType="DECIMAL" property="integral"/>
        <result column="blcode" jdbcType="VARCHAR" property="blcode"/>
        <result column="familyship" jdbcType="VARCHAR" property="familyship"/>
        <result column="area" jdbcType="VARCHAR" property="area"/>
        <result column="hobby" jdbcType="VARCHAR" property="hobby"/>
        <result column="activity" jdbcType="VARCHAR" property="activity"/>
        <result column="introduce" jdbcType="VARCHAR" property="introduce"/>
        <result column="iscreateLclj" jdbcType="VARCHAR" property="iscreateLclj"/>
        <result column="invoice" jdbcType="INTEGER" property="invoice"/>
        <result column="clipAddress" jdbcType="VARCHAR" property="clipAddress"/>
        <result column="accepttool" jdbcType="VARCHAR" property="accepttool"/>
    </resultMap>
    <resultMap extends="BaseResultMap" id="ResultMapWithBLOBs" type="com.kqds.entity.base.KqdsUserdocument">
        <result column="barcode" jdbcType="CLOB" property="barcode"/>
        <result column="headPic" jdbcType="CLOB" property="headPic"/>
        <result column="photoDisplay" jdbcType="CLOB" property="photoDisplay"/>
        <result column="emergencyContact" jdbcType="VARCHAR" property="emergencyContact"/>
        <result column="emergencyPhone" jdbcType="VARCHAR" property="emergencyPhone"/>
    </resultMap>
    <sql id="Base_Column_List">
		SEQ_ID, UserCode, UserName, Sex, BirthDay, Age, Profession, IDCardNo, PhoneNumber1,
		PhoneNumber2, guider, UserImpress, Introducer, PlateNumber, CostLevel, Dress,
		FirstWord,
		Province, City, Address, DevChannel, CreateTime, CreateUser, AskPerson, isdelete,
		organization, medicalhistory, drugllergy, remark, experience, habit, email, type,
		xueli, qq, doctor, important, nexttype, totalpay, developer, doorstatus, glr, glrremark,
		xgr, xgtime, town, kefu, usersort, openid, bindstatus, pym, integral, blcode, familyship, area, hobby, activity, introduce,iscreateLclj,clipAddress,
		area, hobby, activity, introduce, iscreateLclj,accepttool,headPic, photoDisplay,emergencyContact,emergencyPhone
	</sql>
    <sql id="Blob_Column_List">
		barcode
	</sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="ResultMapWithBLOBs">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from KQDS_UserDocument
        where SEQ_ID = #{seqId,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
		delete from KQDS_UserDocument
		where SEQ_ID = #{seqId,jdbcType=VARCHAR}
	</delete>
    <insert id="insert" parameterType="com.kqds.entity.base.KqdsUserdocument">
		insert into KQDS_UserDocument (SEQ_ID, UserCode, UserName,
		Sex, BirthDay, Age,
		Profession, IDCardNo, PhoneNumber1,
		PhoneNumber2, guider,
		UserImpress,
		Introducer, PlateNumber, CostLevel,
		Dress, FirstWord, Province,
		City, Address, DevChannel,
		CreateTime, CreateUser, AskPerson,
		isdelete, organization, medicalhistory,
		drugllergy, remark, experience,
		habit, email, type,
		xueli, qq, doctor,
		important, nexttype, totalpay,
		developer, doorstatus, glr,
		glrremark, xgr, xgtime,
		town, kefu, usersort,
		openid,
		bindstatus, pym,
		integral, blcode, barcode,clipAddress,accepttool
		)
		values (#{seqId,jdbcType=VARCHAR}, #{usercode,jdbcType=VARCHAR}, #{username,jdbcType=VARCHAR},
		#{sex,jdbcType=VARCHAR},
		#{birthday,jdbcType=VARCHAR}, #{age,jdbcType=INTEGER},
		#{profession,jdbcType=VARCHAR}, #{idcardno,jdbcType=VARCHAR}, #{phonenumber1,jdbcType=VARCHAR},
		#{phonenumber2,jdbcType=VARCHAR}, #{guider,jdbcType=VARCHAR}, #{userimpress,jdbcType=VARCHAR},
		#{introducer,jdbcType=VARCHAR}, #{platenumber,jdbcType=VARCHAR},
		#{costlevel,jdbcType=VARCHAR},
		#{dress,jdbcType=VARCHAR}, #{firstword,jdbcType=VARCHAR}, #{province,jdbcType=VARCHAR},
		#{city,jdbcType=VARCHAR}, #{address,jdbcType=VARCHAR},
		#{devchannel,jdbcType=VARCHAR},
		#{createtime,jdbcType=VARCHAR}, #{createuser,jdbcType=VARCHAR}, #{askperson,jdbcType=VARCHAR},
		#{isdelete,jdbcType=INTEGER},
		#{organization,jdbcType=VARCHAR}, #{medicalhistory,jdbcType=VARCHAR},
		#{drugllergy,jdbcType=VARCHAR}, #{remark,jdbcType=VARCHAR}, #{experience,jdbcType=VARCHAR},
		#{habit,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR}, #{type,jdbcType=INTEGER},
		#{xueli,jdbcType=VARCHAR}, #{qq,jdbcType=VARCHAR}, #{doctor,jdbcType=VARCHAR},
		#{important,jdbcType=VARCHAR}, #{nexttype,jdbcType=VARCHAR}, #{totalpay,jdbcType=DECIMAL},
		#{developer,jdbcType=VARCHAR}, #{doorstatus,jdbcType=INTEGER}, #{glr,jdbcType=VARCHAR},
		#{glrremark,jdbcType=VARCHAR}, #{xgr,jdbcType=VARCHAR}, #{xgtime,jdbcType=VARCHAR},
		#{town,jdbcType=VARCHAR}, #{kefu,jdbcType=VARCHAR}, #{usersort,jdbcType=VARCHAR},
		#{openid,jdbcType=VARCHAR}, #{bindstatus,jdbcType=VARCHAR}, #{pym,jdbcType=VARCHAR},
		#{integral,jdbcType=DECIMAL}, #{blcode,jdbcType=VARCHAR}, #{barcode,jdbcType=CLOB},
		#{clipAddress,jdbcType=VARCHAR},#{accepttool,jdbcType=VARCHAR})
	</insert>
    <insert id="insertSelective" parameterType="com.kqds.entity.base.KqdsUserdocument">
        insert into KQDS_UserDocument
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="seqId != null">
                SEQ_ID,
            </if>
            <if test="usercode != null">
                UserCode,
            </if>
            <if test="username != null">
                UserName,
            </if>
            <if test="sex != null">
                Sex,
            </if>
            <if test="birthday != null">
                BirthDay,
            </if>
            <if test="age != null">
                Age,
            </if>
            <if test="profession != null">
                Profession,
            </if>
            <if test="idcardno != null">
                IDCardNo,
            </if>
            <if test="phonenumber1 != null">
                PhoneNumber1,
            </if>
            <if test="phonenumber2 != null">
                PhoneNumber2,
            </if>
            <if test="guider != null">
                guider,
            </if>
            <if test="userimpress != null">
                UserImpress,
            </if>
            <if test="introducer != null">
                Introducer,
            </if>
            <if test="platenumber != null">
                PlateNumber,
            </if>
            <if test="costlevel != null">
                CostLevel,
            </if>
            <if test="dress != null">
                Dress,
            </if>
            <if test="firstword != null">
                FirstWord,
            </if>
            <if test="province != null">
                Province,
            </if>
            <if test="city != null">
                City,
            </if>
            <if test="address != null">
                Address,
            </if>
            <if test="devchannel != null">
                DevChannel,
            </if>
            <if test="createtime != null">
                CreateTime,
            </if>
            <if test="createuser != null">
                CreateUser,
            </if>
            <if test="askperson != null">
                AskPerson,
            </if>
            <if test="isdelete != null">
                isdelete,
            </if>
            <if test="organization != null">
                organization,
            </if>
            <if test="medicalhistory != null">
                medicalhistory,
            </if>
            <if test="drugllergy != null">
                drugllergy,
            </if>
            <if test="remark != null">
                remark,
            </if>
            <if test="experience != null">
                experience,
            </if>
            <if test="habit != null">
                habit,
            </if>
            <if test="email != null">
                email,
            </if>
            <if test="type != null">
                type,
            </if>
            <if test="xueli != null">
                xueli,
            </if>
            <if test="qq != null">
                qq,
            </if>
            <if test="doctor != null">
                doctor,
            </if>
            <if test="important != null">
                important,
            </if>
            <if test="nexttype != null">
                nexttype,
            </if>
            <if test="totalpay != null">
                totalpay,
            </if>
            <if test="developer != null">
                developer,
            </if>
            <if test="doorstatus != null">
                doorstatus,
            </if>
            <if test="glr != null">
                glr,
            </if>
            <if test="glrremark != null">
                glrremark,
            </if>
            <if test="xgr != null">
                xgr,
            </if>
            <if test="xgtime != null">
                xgtime,
            </if>
            <if test="town != null">
                town,
            </if>
            <if test="kefu != null">
                kefu,
            </if>
            <if test="usersort != null">
                usersort,
            </if>
            <if test="openid != null">
                openid,
            </if>
            <if test="bindstatus != null">
                bindstatus,
            </if>
            <if test="pym != null">
                pym,
            </if>
            <if test="integral != null">
                integral,
            </if>
            <if test="blcode != null">
                blcode,
            </if>
            <if test="barcode != null">
                barcode,
            </if>
            <if test="familyship != null">
                familyship,
            </if>
            <if test="area != null">
                area,
            </if>
            <if test="hobby != null">
                hobby,
            </if>
            <if test="activity != null">
                activity,
            </if>
            <if test="introduce != null">
                introduce,
            </if>
            <if test="introduce != null">
                clipAddress,
            </if>
            <if test="accepttool != null">
                accepttool,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="seqId != null">
                #{seqId,jdbcType=VARCHAR},
            </if>
            <if test="usercode != null">
                #{usercode,jdbcType=VARCHAR},
            </if>
            <if test="username != null">
                #{username,jdbcType=VARCHAR},
            </if>
            <if test="sex != null">
                #{sex,jdbcType=VARCHAR},
            </if>
            <if test="birthday != null">
                #{birthday,jdbcType=VARCHAR},
            </if>
            <if test="age != null">
                #{age,jdbcType=INTEGER},
            </if>
            <if test="profession != null">
                #{profession,jdbcType=VARCHAR},
            </if>
            <if test="idcardno != null">
                #{idcardno,jdbcType=VARCHAR},
            </if>
            <if test="phonenumber1 != null">
                #{phonenumber1,jdbcType=VARCHAR},
            </if>
            <if test="phonenumber2 != null">
                #{phonenumber2,jdbcType=VARCHAR},
            </if>
            <if test="guider != null">
                #{guider,jdbcType=VARCHAR},
            </if>
            <if test="userimpress != null">
                #{userimpress,jdbcType=VARCHAR},
            </if>
            <if test="introducer != null">
                #{introducer,jdbcType=VARCHAR},
            </if>
            <if test="platenumber != null">
                #{platenumber,jdbcType=VARCHAR},
            </if>
            <if test="costlevel != null">
                #{costlevel,jdbcType=VARCHAR},
            </if>
            <if test="dress != null">
                #{dress,jdbcType=VARCHAR},
            </if>
            <if test="firstword != null">
                #{firstword,jdbcType=VARCHAR},
            </if>
            <if test="province != null">
                #{province,jdbcType=VARCHAR},
            </if>
            <if test="city != null">
                #{city,jdbcType=VARCHAR},
            </if>
            <if test="address != null">
                #{address,jdbcType=VARCHAR},
            </if>
            <if test="devchannel != null">
                #{devchannel,jdbcType=VARCHAR},
            </if>
            <if test="createtime != null">
                #{createtime,jdbcType=VARCHAR},
            </if>
            <if test="createuser != null">
                #{createuser,jdbcType=VARCHAR},
            </if>
            <if test="askperson != null">
                #{askperson,jdbcType=VARCHAR},
            </if>
            <if test="isdelete != null">
                #{isdelete,jdbcType=INTEGER},
            </if>
            <if test="organization != null">
                #{organization,jdbcType=VARCHAR},
            </if>
            <if test="medicalhistory != null">
                #{medicalhistory,jdbcType=VARCHAR},
            </if>
            <if test="drugllergy != null">
                #{drugllergy,jdbcType=VARCHAR},
            </if>
            <if test="remark != null">
                #{remark,jdbcType=VARCHAR},
            </if>
            <if test="experience != null">
                #{experience,jdbcType=VARCHAR},
            </if>
            <if test="habit != null">
                #{habit,jdbcType=VARCHAR},
            </if>
            <if test="email != null">
                #{email,jdbcType=VARCHAR},
            </if>
            <if test="type != null">
                #{type,jdbcType=INTEGER},
            </if>
            <if test="xueli != null">
                #{xueli,jdbcType=VARCHAR},
            </if>
            <if test="qq != null">
                #{qq,jdbcType=VARCHAR},
            </if>
            <if test="doctor != null">
                #{doctor,jdbcType=VARCHAR},
            </if>
            <if test="important != null">
                #{important,jdbcType=VARCHAR},
            </if>
            <if test="nexttype != null">
                #{nexttype,jdbcType=VARCHAR},
            </if>
            <if test="totalpay != null">
                #{totalpay,jdbcType=DECIMAL},
            </if>
            <if test="developer != null">
                #{developer,jdbcType=VARCHAR},
            </if>
            <if test="doorstatus != null">
                #{doorstatus,jdbcType=INTEGER},
            </if>
            <if test="glr != null">
                #{glr,jdbcType=VARCHAR},
            </if>
            <if test="glrremark != null">
                #{glrremark,jdbcType=VARCHAR},
            </if>
            <if test="xgr != null">
                #{xgr,jdbcType=VARCHAR},
            </if>
            <if test="xgtime != null">
                #{xgtime,jdbcType=VARCHAR},
            </if>
            <if test="town != null">
                #{town,jdbcType=VARCHAR},
            </if>
            <if test="kefu != null">
                #{kefu,jdbcType=VARCHAR},
            </if>
            <if test="usersort != null">
                #{usersort,jdbcType=VARCHAR},
            </if>
            <if test="openid != null">
                #{openid,jdbcType=VARCHAR},
            </if>
            <if test="bindstatus != null">
                #{bindstatus,jdbcType=VARCHAR},
            </if>
            <if test="pym != null">
                #{pym,jdbcType=VARCHAR},
            </if>
            <if test="integral != null">
                #{integral,jdbcType=DECIMAL},
            </if>
            <if test="blcode != null">
                #{blcode,jdbcType=VARCHAR},
            </if>
            <if test="barcode != null">
                #{barcode,jdbcType=CLOB},
            </if>
            <if test="familyship != null">
                #{familyship,jdbcType=VARCHAR},
            </if>
            <if test="area != null">
                #{area,jdbcType=VARCHAR},
            </if>
            <if test="hobby != null">
                #{hobby,jdbcType=VARCHAR},
            </if>
            <if test="activity != null">
                #{activity,jdbcType=VARCHAR},
            </if>
            <if test="introduce != null">
                #{introduce,jdbcType=VARCHAR},
            </if>
            <if test="introduce != null">
                #{clipAddress,jdbcType=VARCHAR},
            </if>
            <if test="accepttool != null">
                #{accepttool,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.kqds.entity.base.KqdsUserdocument">
        update KQDS_UserDocument
        <set>
            <if test="usercode != null">
                UserCode = #{usercode,jdbcType=VARCHAR},
            </if>
            <if test="username != null">
                UserName = #{username,jdbcType=VARCHAR},
            </if>
            <if test="sex != null">
                Sex = #{sex,jdbcType=VARCHAR},
            </if>
            <if test="birthday != null">
                BirthDay = #{birthday,jdbcType=VARCHAR},
            </if>
            <if test="age != null">
                Age = #{age,jdbcType=INTEGER},
            </if>
            <if test="profession != null">
                Profession = #{profession,jdbcType=VARCHAR},
            </if>
            <if test="idcardno != null">
                IDCardNo = #{idcardno,jdbcType=VARCHAR},
            </if>
            <if test="phonenumber1 != null">
                PhoneNumber1 = #{phonenumber1,jdbcType=VARCHAR},
            </if>
            <if test="phonenumber2 != null">
                PhoneNumber2 = #{phonenumber2,jdbcType=VARCHAR},
            </if>
            <if test="guider != null">
                guider = #{guider,jdbcType=VARCHAR},
            </if>
            <if test="userimpress != null">
                UserImpress = #{userimpress,jdbcType=VARCHAR},
            </if>
            <if test="introducer != null">
                Introducer = #{introducer,jdbcType=VARCHAR},
            </if>
            <if test="platenumber != null">
                PlateNumber = #{platenumber,jdbcType=VARCHAR},
            </if>
            <if test="costlevel != null">
                CostLevel = #{costlevel,jdbcType=VARCHAR},
            </if>
            <if test="dress != null">
                Dress = #{dress,jdbcType=VARCHAR},
            </if>
            <if test="firstword != null">
                FirstWord = #{firstword,jdbcType=VARCHAR},
            </if>
            <if test="province != null">
                Province = #{province,jdbcType=VARCHAR},
            </if>
            <if test="city != null">
                City = #{city,jdbcType=VARCHAR},
            </if>
            <if test="address != null">
                Address = #{address,jdbcType=VARCHAR},
            </if>
            <if test="devchannel != null">
                DevChannel = #{devchannel,jdbcType=VARCHAR},
            </if>
            <if test="createtime != null">
                CreateTime = #{createtime,jdbcType=VARCHAR},
            </if>
            <if test="createuser != null">
                CreateUser = #{createuser,jdbcType=VARCHAR},
            </if>
            <if test="askperson != null">
                AskPerson = #{askperson,jdbcType=VARCHAR},
            </if>
            <if test="isdelete != null">
                isdelete = #{isdelete,jdbcType=INTEGER},
            </if>
            <if test="organization != null">
                organization = #{organization,jdbcType=VARCHAR},
            </if>
            <if test="medicalhistory != null">
                medicalhistory = #{medicalhistory,jdbcType=VARCHAR},
            </if>
            <if test="drugllergy != null">
                drugllergy = #{drugllergy,jdbcType=VARCHAR},
            </if>
            <if test="remark != null">
                remark = #{remark,jdbcType=VARCHAR},
            </if>
            <if test="experience != null">
                experience = #{experience,jdbcType=VARCHAR},
            </if>
            <if test="habit != null">
                habit = #{habit,jdbcType=VARCHAR},
            </if>
            <if test="email != null">
                email = #{email,jdbcType=VARCHAR},
            </if>
            <if test="type != null">
                type = #{type,jdbcType=INTEGER},
            </if>
            <if test="xueli != null">
                xueli = #{xueli,jdbcType=VARCHAR},
            </if>
            <if test="qq != null">
                qq = #{qq,jdbcType=VARCHAR},
            </if>
            <if test="doctor != null">
                doctor = #{doctor,jdbcType=VARCHAR},
            </if>
            <if test="important != null">
                important = #{important,jdbcType=VARCHAR},
            </if>
            <if test="nexttype != null">
                nexttype = #{nexttype,jdbcType=VARCHAR},
            </if>
            <if test="totalpay != null">
                totalpay = #{totalpay,jdbcType=DECIMAL},
            </if>
            <if test="developer != null">
                developer = #{developer,jdbcType=VARCHAR},
            </if>
            <if test="doorstatus != null">
                doorstatus = #{doorstatus,jdbcType=INTEGER},
            </if>
            <if test="glr != null">
                glr = #{glr,jdbcType=VARCHAR},
            </if>
            <if test="glrremark != null">
                glrremark = #{glrremark,jdbcType=VARCHAR},
            </if>
            <if test="xgr != null">
                xgr = #{xgr,jdbcType=VARCHAR},
            </if>
            <if test="xgtime != null">
                xgtime = #{xgtime,jdbcType=VARCHAR},
            </if>
            <if test="town != null">
                town = #{town,jdbcType=VARCHAR},
            </if>
            <if test="kefu != null">
                kefu = #{kefu,jdbcType=VARCHAR},
            </if>
            <if test="usersort != null">
                usersort = #{usersort,jdbcType=VARCHAR},
            </if>
            <if test="openid != null">
                openid = #{openid,jdbcType=VARCHAR},
            </if>
            <if test="bindstatus != null">
                bindstatus = #{bindstatus,jdbcType=VARCHAR},
            </if>
            <if test="pym != null">
                pym = #{pym,jdbcType=VARCHAR},
            </if>
            <if test="integral != null">
                integral = #{integral,jdbcType=DECIMAL},
            </if>
            <if test="blcode != null">
                blcode = #{blcode,jdbcType=VARCHAR},
            </if>
            <if test="barcode != null">
                barcode = #{barcode,jdbcType=CLOB},
            </if>
            <if test="headPic != null">
                headPic = #{headPic,jdbcType=CLOB},
            </if>
            <if test="photoDisplay != null">
                photoDisplay = #{photoDisplay,jdbcType=CLOB},
            </if>
            <if test="area != null">
                area = #{area,jdbcType=VARCHAR},
            </if>
            <if test="iscreateLclj != null">
                iscreateLclj = #{iscreateLclj,jdbcType=VARCHAR},
            </if>
            <if test="activity != null">
                activity = #{activity,jdbcType=VARCHAR},
            </if>
            <if test="hobby != null">
                hobby = #{hobby,jdbcType=VARCHAR},
            </if>
            <if test="clipAddress != null">
                clipAddress = #{clipAddress,jdbcType=VARCHAR},
            </if>
            <if test="accepttool != null">
                accepttool = #{accepttool,jdbcType=VARCHAR},
            </if>
            <if test="introduce != null">
                introduce = #{introduce,jdbcType=VARCHAR},
            </if>
        </set>
        where SEQ_ID = #{seqId,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.kqds.entity.base.KqdsUserdocument">
		update KQDS_UserDocument
		set UserCode = #{usercode,jdbcType=VARCHAR},
		UserName = #{username,jdbcType=VARCHAR},
		Sex =
		#{sex,jdbcType=VARCHAR},
		BirthDay = #{birthday,jdbcType=VARCHAR},
		Age = #{age,jdbcType=INTEGER},
		Profession = #{profession,jdbcType=VARCHAR},
		IDCardNo = #{idcardno,jdbcType=VARCHAR},
		PhoneNumber1 = #{phonenumber1,jdbcType=VARCHAR},
		PhoneNumber2 = #{phonenumber2,jdbcType=VARCHAR},
		guider = #{guider,jdbcType=VARCHAR},
		UserImpress = #{userimpress,jdbcType=VARCHAR},
		Introducer = #{introducer,jdbcType=VARCHAR},
		PlateNumber = #{platenumber,jdbcType=VARCHAR},
		CostLevel = #{costlevel,jdbcType=VARCHAR},
		Dress = #{dress,jdbcType=VARCHAR},
		FirstWord =
		#{firstword,jdbcType=VARCHAR},
		Province = #{province,jdbcType=VARCHAR},
		City = #{city,jdbcType=VARCHAR},
		Address = #{address,jdbcType=VARCHAR},
		DevChannel =
		#{devchannel,jdbcType=VARCHAR},
		CreateTime = #{createtime,jdbcType=VARCHAR},
		CreateUser = #{createuser,jdbcType=VARCHAR},
		AskPerson = #{askperson,jdbcType=VARCHAR},
		isdelete =
		#{isdelete,jdbcType=INTEGER},
		organization = #{organization,jdbcType=VARCHAR},
		medicalhistory = #{medicalhistory,jdbcType=VARCHAR},
		drugllergy = #{drugllergy,jdbcType=VARCHAR},
		remark = #{remark,jdbcType=VARCHAR},
		experience = #{experience,jdbcType=VARCHAR},
		habit = #{habit,jdbcType=VARCHAR},
		email = #{email,jdbcType=VARCHAR},
		type =
		#{type,jdbcType=INTEGER},
		xueli = #{xueli,jdbcType=VARCHAR},
		qq = #{qq,jdbcType=VARCHAR},
		doctor = #{doctor,jdbcType=VARCHAR},
		important = #{important,jdbcType=VARCHAR},
		nexttype =
		#{nexttype,jdbcType=VARCHAR},
		totalpay = #{totalpay,jdbcType=DECIMAL},
		developer = #{developer,jdbcType=VARCHAR},
		doorstatus = #{doorstatus,jdbcType=INTEGER},
		glr =
		#{glr,jdbcType=VARCHAR},
		glrremark = #{glrremark,jdbcType=VARCHAR},
		xgr = #{xgr,jdbcType=VARCHAR},
		xgtime = #{xgtime,jdbcType=VARCHAR},
		town = #{town,jdbcType=VARCHAR},
		kefu =
		#{kefu,jdbcType=VARCHAR},
		usersort = #{usersort,jdbcType=VARCHAR},
		openid = #{openid,jdbcType=VARCHAR},
		bindstatus = #{bindstatus,jdbcType=VARCHAR},
		pym = #{pym,jdbcType=VARCHAR},
		integral = #{integral,jdbcType=DECIMAL},
		blcode = #{blcode,jdbcType=VARCHAR},
		barcode = #{barcode,jdbcType=CLOB},
		clipAddress = #{clipAddress,jdbcType=CLOB}
		where SEQ_ID = #{seqId,jdbcType=VARCHAR}
	</update>
    <update id="updateByPrimaryKey" parameterType="com.kqds.entity.base.KqdsUserdocument">
		update KQDS_UserDocument
		set UserCode = #{usercode,jdbcType=VARCHAR},
		UserName = #{username,jdbcType=VARCHAR},
		Sex =
		#{sex,jdbcType=VARCHAR},
		BirthDay = #{birthday,jdbcType=VARCHAR},
		Age = #{age,jdbcType=INTEGER},
		Profession = #{profession,jdbcType=VARCHAR},
		IDCardNo = #{idcardno,jdbcType=VARCHAR},
		PhoneNumber1 = #{phonenumber1,jdbcType=VARCHAR},
		PhoneNumber2 = #{phonenumber2,jdbcType=VARCHAR},
		guider = #{guider,jdbcType=VARCHAR},
		UserImpress = #{userimpress,jdbcType=VARCHAR},
		Introducer = #{introducer,jdbcType=VARCHAR},
		PlateNumber = #{platenumber,jdbcType=VARCHAR},
		CostLevel = #{costlevel,jdbcType=VARCHAR},
		Dress = #{dress,jdbcType=VARCHAR},
		FirstWord =
		#{firstword,jdbcType=VARCHAR},
		Province = #{province,jdbcType=VARCHAR},
		City = #{city,jdbcType=VARCHAR},
		Address = #{address,jdbcType=VARCHAR},
		DevChannel =
		#{devchannel,jdbcType=VARCHAR},
		CreateTime = #{createtime,jdbcType=VARCHAR},
		CreateUser = #{createuser,jdbcType=VARCHAR},
		AskPerson = #{askperson,jdbcType=VARCHAR},
		isdelete =
		#{isdelete,jdbcType=INTEGER},
		organization = #{organization,jdbcType=VARCHAR},
		medicalhistory = #{medicalhistory,jdbcType=VARCHAR},
		drugllergy = #{drugllergy,jdbcType=VARCHAR},
		remark = #{remark,jdbcType=VARCHAR},
		experience = #{experience,jdbcType=VARCHAR},
		habit = #{habit,jdbcType=VARCHAR},
		email = #{email,jdbcType=VARCHAR},
		type =
		#{type,jdbcType=INTEGER},
		xueli = #{xueli,jdbcType=VARCHAR},
		qq = #{qq,jdbcType=VARCHAR},
		doctor = #{doctor,jdbcType=VARCHAR},
		important = #{important,jdbcType=VARCHAR},
		nexttype =
		#{nexttype,jdbcType=VARCHAR},
		totalpay = #{totalpay,jdbcType=DECIMAL},
		developer = #{developer,jdbcType=VARCHAR},
		doorstatus = #{doorstatus,jdbcType=INTEGER},
		glr =
		#{glr,jdbcType=VARCHAR},
		glrremark = #{glrremark,jdbcType=VARCHAR},
		xgr = #{xgr,jdbcType=VARCHAR},
		xgtime = #{xgtime,jdbcType=VARCHAR},
		town = #{town,jdbcType=VARCHAR},
		kefu =
		#{kefu,jdbcType=VARCHAR},
		usersort = #{usersort,jdbcType=VARCHAR},
		openid = #{openid,jdbcType=VARCHAR},
		bindstatus = #{bindstatus,jdbcType=VARCHAR},
		pym = #{pym,jdbcType=VARCHAR},
		integral = #{integral,jdbcType=DECIMAL},
		blcode = #{blcode,jdbcType=VARCHAR},
		clipAddress = #{clipAddress,jdbcType=VARCHAR},
		where SEQ_ID = #{seqId,jdbcType=VARCHAR}
	</update>


    <!--#################################### auto create ################################# -->
    <!--表名 -->
    <sql id="tableName">
		KQDS_USERDOCUMENT
	</sql>
    <select id="selectCountByMap" resultType="int">
        select
        count(1)
        from
        <include refid="tableName"></include>
        where 1=1
        <foreach collection="params" index="key" item="val" open="" close="" separator=" ">  <!-- separator为空格 -->
            and ${key} = #{val}
        </foreach>
    </select>
    <select id="selectBeanListByMap" parameterType="map" resultType="KqdsUserdocument">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from
        <include refid="tableName"></include>
        <!-- u.SEQ_ID,
		u.UserCode,
		u.UserName,
		u.Sex,
		u.BirthDay,
		u.Age,
		u.Profession,
		u.IDCardNo,
		u.PhoneNumber1,
		u.PhoneNumber2,
		u.guider,
		u.UserImpress,
		u.Introducer,
		u.PlateNumber,
		u.CostLevel,
		u.Dress,
		u.FirstWord,
		u.Province,
		u.City,
		u.Address,
		u.DevChannel,
		u.CreateTime,
		u.CreateUser,
		u.AskPerson,
		u.isdelete,
		u.organization,
		u.medicalhistory,
		u.drugllergy,
		u.remark,
		u.experience,
		u.habit,
		u.email,
		u.type,
		u.xueli,
		u.qq,
		u.doctor,
		u.important,
		u.nexttype,
		u.totalpay,
		u.developer,
		u.doorstatus,
		u.glr,
		u.glrremark,
		u.xgr,
		u.xgtime,
		u.town,
		u.kefu,
		u.usersort,
		u.openid,
		u.bindstatus,
		u.pym,
		u.integral,
		u.blcode,
		u.barcode,
		c.recipecode,
		p.totalcost
		FROM KQDS_USERDOCUMENT u
		LEFT JOIN KQDS_CHUFANG c
		ON u.UserCode=c.usercode
		LEFT JOIN KQDS_PAYCOST p
		ON c.costno=p.costno  -->
        where 1=1
        <foreach collection="params" index="key" item="val" open="" close="" separator=" ">  <!-- separator为空格 -->
            and ${key} = #{val}
        </foreach>
    </select>

    <select id="getBindUserDocByOpenId" parameterType="java.lang.String" resultType="KqdsUserdocument">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from KQDS_USERDOCUMENT
        where openid = #{_parameter} and bindstatus = 0
    </select>
    <select id="phoneIsExist" parameterType="map" resultType="int">
		select count(1) as num from KQDS_USERDOCUMENT where 1=1
		and ( phonenumber1 = #{phonenumber1} or phonenumber2 =
		#{phonenumber1} )
		and (openid is not null and openid != '' and openid != #{openid} ) and bindstatus = 0
		and isdelete !=1
	</select>
    <select id="getUserDocByNameAndPhonenumber" parameterType="map" resultType="json">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from KQDS_USERDOCUMENT where 1=1
        and ( phonenumber1 = #{phonenumber1} or phonenumber2 =
        #{phonenumber1} )
        and username = #{username}
    </select>
    <select id="getMaxUserCode" parameterType="java.lang.String" resultType="json">
		select max(UserCode) as maxusercode from KQDS_USERDOCUMENT
		where 1=1
		and UserCode like
		'${_parameter}______'
	</select>
    <select id="getmaxblcode" parameterType="java.lang.String" resultType="json">
		select max(blcode) as maxblcode from KQDS_USERDOCUMENT
	</select>
    <select id="getSingUserByPhoneNumber" parameterType="java.lang.String" resultType="json">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from KQDS_USERDOCUMENT where 1=1 and (phonenumber1 = #{_parameter} or
        phonenumber2=#{_parameter})
    </select>
    <select id="getSingUserNameAndCodeByPhoneNumber" parameterType="java.lang.String" resultType="json">
		select username,usercode from KQDS_USERDOCUMENT where 1=1 and (phonenumber1 =
		#{_parameter} or phonenumber2=#{_parameter})
	</select>
    <select id="selectNoPymList" parameterType="java.lang.String" resultType="json">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from KQDS_UserDocument
        where 1=1 and (pym is null or pym='')
    </select>
    <!--查询门诊挂号个人信息  修改日期:2019/04/11  修改人:多永浩 修改内容: 新增修复医生字段联查展示-->
    <select id="getBaseUserInfoByUsercode" parameterType="java.lang.String" resultType="json">
		SELECT
	( SELECT COUNT ( v.usercode ) FROM KQDS_Visit v WHERE v.usercode= u.UserCode ) AS ywhf,
	(
	SELECT
		sy.USER_NAME
	FROM
		( SELECT MAX ( repairdoctor ) AS repairdoctor FROM KQDS_REG WHERE usercode = u.usercode GROUP BY usercode ) kr
		LEFT JOIN sys_person sy ON sy.SEQ_ID = kr.repairdoctor
	) AS repairdoctor,
	u.SEQ_ID,u.UserCode,u.UserName, u.Sex, u.BirthDay, u.Age, u.Profession, u.IDCardNo, u.PhoneNumber1,
	u.PhoneNumber2, u.guider, u.UserImpress, u.Introducer, u.PlateNumber, u.CostLevel, u.Dress,
	u.FirstWord,u.Province, u.City, u.Address, u.DevChannel, u.CreateTime, u.CreateUser, u.AskPerson, u.isdelete,
	u.organization, u.medicalhistory, u.drugllergy, u.remark, u.experience, u.habit, u.email, u.type,
	u.xueli, u.qq, u.doctor, u.important, u.nexttype, u.totalpay, u.developer, u.doorstatus, u.glr, u.glrremark,
	u.xgr, u.xgtime, u.town, u.kefu, u.usersort, u.openid, u.bindstatus, u.pym, u.integral, u.blcode, u.familyship,
	u.area, u.hobby, u.activity, u.introduce,u.iscreateLclj,u.clipAddress,
	u.area, u.hobby, u.activity, u.introduce, u.iscreateLclj,u.accepttool,
	u.headPic, u.photoDisplay,u.emergencyContact,u.emergencyPhone,u.barcode,
	per1.user_name AS doctorname,
	per2.user_name AS askpersonname,
	per3.user_name AS developername,
	per3.user_name AS developer_desc,
	per4.user_name AS createusername,
	per4.user_name AS createuser_desc,
	per5.user_name AS guidername,
	per5.user_name AS guider_desc,
	per6.user_name AS kefuname,
	u1.username AS introducername,
	u1.username AS introducer_desc,
	dev.dict_name AS devchannelname,
	NEXT.dict_name AS nexttypename,
	pro.dict_name AS professionname,
	okdi1.dict_name AS devchannelname,
	hztype.dict_name AS nexttypename,
	u.familyship
FROM
	KQDS_USERDOCUMENT AS u
	LEFT JOIN SYS_DICT okdi1 ON okdi1.seq_id = u.devchannel
	LEFT JOIN SYS_DICT hztype ON hztype.seq_id = u.nexttype
	LEFT JOIN SYS_PERSON per1 ON per1.seq_id = u.doctor
	LEFT JOIN SYS_PERSON per2 ON per2.seq_id = u.askperson
	LEFT JOIN SYS_PERSON per3 ON per3.seq_id = u.developer
	LEFT JOIN SYS_PERSON per4 ON per4.seq_id = u.createuser
	LEFT JOIN SYS_PERSON per5 ON per5.seq_id = u.guider
	LEFT JOIN SYS_PERSON per6 ON per6.seq_id = u.kefu
	LEFT JOIN KQDS_USERDOCUMENT u1 ON u1.usercode = u.introducer
	LEFT JOIN SYS_DICT dev ON dev.seq_id = u.devchannel
	LEFT JOIN SYS_DICT NEXT ON NEXT.seq_id = u.nexttype
	LEFT JOIN SYS_DICT pro ON pro.seq_id = u.profession
WHERE
	1 = 1
	AND u.usercode = #{_parameter}
	</select>
    <select id="countByUserCode" parameterType="java.lang.String" resultType="int">
		select count(1) from KQDS_USERDOCUMENT where usercode = #{_parameter}
	</select>
    <select id="selectDoctorByusercode" parameterType="java.lang.String" resultType="json">
		select doctor from KQDS_USERDOCUMENT where usercode=#{_parameter} and doctor != '' ORDER BY
		CreateTime desc
	</select>
    <select id="selectusercodeByusername" parameterType="java.lang.String" resultType="json">
		select usercode from KQDS_USERDOCUMENT where username=#{_parameter}
	</select>
    <select id="selectWithNopage" parameterType="map" resultType="json">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from KQDS_USERDOCUMENT where 1=1
        <if test="username != null and username !=''">
            and (username like '%' + #{username} + '%' or pym like '%' + #{username} + '%')
        </if>
        <if test="PhoneNumber1 != null and PhoneNumber1 !=''">
            and ( ${p1} or ${p2})
        </if>
        <if test="idcardno != null and idcardno !='' ">
            and idcardno like '%' + #{idcardno} + '%'
        </if>
        <if test="isdelete != null and isdelete !='' ">
            and isdelete = #{isdelete}
        </if>
        <if test="organization != null and organization !='' ">
            and organization = #{organization}
        </if>
        <if test="type != null and type !='' ">
            and type = #{type}
        </if>
        <if test="usercode != null and usercode !='' ">
            and usercode = #{usercode}
        </if>
        ORDER BY CreateTime desc
    </select>
    <select id="selectWithNopageReg" parameterType="map" resultType="json">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from KQDS_USERDOCUMENT where 1=1
        <!-- <if test="username != null and username !=''">
			and (username like '%' + #{username} + '%' or pym like '%' + #{username} + '%')
		</if> -->
        <if test="searchValue != null and searchValue !='' ">
            and (usercode like '%' + #{searchValue} + '%'
            or username like '%' + #{searchValue} + '%'
            or PhoneNumber1 like '%' + #{searchValue} + '%'
            or PhoneNumber2 like '%' + #{searchValue} + '%'
            )
        </if>
        <if test="PhoneNumber1 != null and PhoneNumber1 !=''">
            and ( ${p1} or ${p2})
        </if>
        <if test="idcardno != null and idcardno !='' ">
            and idcardno like '%' + #{idcardno} + '%'
        </if>
        <if test="isdelete != null and isdelete !='' ">
            and isdelete = #{isdelete}
        </if>
        <if test="organization != null and organization !='' ">
            and organization = #{organization}
        </if>
        <if test="type != null and type !='' ">
            and type = #{type}
        </if>
        <if test="usercode != null and usercode !='' ">
            and usercode = #{usercode}
        </if>
        ORDER BY CreateTime desc
    </select>
    <select id="selectWithNopageGh" parameterType="map" resultType="json">
        select u.seq_id,
        u.usercode,
        u.username,
        u.sex,
        u.type,
        u.birthday,
        u.idcardno,
        u.phonenumber1,
        u.phonenumber2,
        u.createuser,
        u.askperson,
        u.doctor,
        u.familyship,
        per1.user_name as createusername,
        odept.dept_name as organizationname,
        u.organization
        from KQDS_USERDOCUMENT u
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        left join SYS_PERSON per1 on per1.seq_id = u.createuser
        where 1=1 and isdelete !=1
        <if test="username != null and username !=''">
            and (u.username like '%' + #{username} + '%' or u.pym like '%' + #{username} + '%')
        </if>
        <if test="PhoneNumber1 != null and PhoneNumber1 !=''">
            and ( ${p1} or ${p2})
        </if>
        <if test="idcardno != null and idcardno !='' ">
            and idcardno like '%' + #{idcardno} + '%'
        </if>
        <if test="querydata != null and querydata !='' ">
            and (u.usercode like '%' + #{querydata} + '%'
            or u.username like '%' + #{querydata} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{querydata} + '%'
            )
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        <if test="type != null and type !='' ">
            and u.type = #{type}
        </if>
        <if test="usercode != null and usercode !='' ">
            and u.usercode = #{usercode}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        ORDER BY u.CreateTime desc
    </select>
    <!-- 注释原有查询改为模糊查询 -->
    <select id="selectWithNopageGhLike" parameterType="map" resultType="json">
        select u.seq_id,
        u.usercode,
        u.username,
        u.sex,
        u.type,
        u.birthday,
        u.idcardno,
        u.phonenumber1,
        u.phonenumber2,
        u.createuser,
        u.askperson,
        u.doctor,
        u.familyship,
        per1.user_name as createusername,
        per2.user_name as askpersonname,
        odept.dept_name as organizationname,
        odept.SEQ_ID as organizationId
        from KQDS_USERDOCUMENT u
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        left join SYS_PERSON per1 on per1.seq_id = u.createuser
        left join sys_person per2 on per2.seq_id = u.askperson
        where 1=1 and isdelete !=1
        <if test="searchValue != null and searchValue !='' ">
            and (u.usercode like '%' + #{searchValue} + '%'
            or u.username like '%' + #{searchValue} + '%'
            or u.PhoneNumber1 like '%' + #{searchValue} + '%'
            or u.PhoneNumber2 like '%' + #{searchValue} + '%'
            )
        </if>
        <if test="usercode != null and usercode !='' ">
            and u.usercode = #{usercode}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        ORDER BY u.CreateTime desc
    </select>
    <!-- 咨询创建临床路径按权限查找患者  2019-7-30  syp -->
    <select id="selectWithNopageGhPermission" parameterType="map" resultType="json">
        select u.seq_id,
        u.usercode,
        u.username,
        u.sex,
        u.type,
        u.birthday,
        u.idcardno,
        u.phonenumber1,
        u.phonenumber2,
        u.createuser,
        u.askperson,
        u.doctor,
        u.familyship,
        n.regsort,
        n.askperson,
        n.createtime,
        per1.user_name as createusername,
        per2.user_name as askpersonname,
        per3.USER_NAME as firstaskpersonname,
        odept.dept_name as organizationname
        from KQDS_USERDOCUMENT u
        LEFT JOIN (select a.SEQ_ID, a.createuser, a.createtime, a.usercode, a.regway, a.regsort, a.recesort, a.regmoney,
        a.reggoal,
        a.regdept, a.doctor, a.askperson, a.ifmedrecord, a.ifcost, a.editreason, a.receiveno, a.status,
        a.username, a.del, a.cjstatus, a.remark, a.organization , a.repairdoctor, a.askpersondept, a.jh
        from KQDS_REG a,(select usercode,max(createtime) createtime from
        KQDS_REG group by usercode) b where a.usercode=b.usercode and
        a.createtime = b.createtime) n on n.usercode = u.usercode
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        left join SYS_PERSON per1 on per1.seq_id = u.createuser
        left join SYS_PERSON per2 on per2.seq_id = n.askperson
        LEFT JOIN sys_person per3 ON per3.SEQ_ID = u.askperson
        where 1=1
        <if test="username != null and username !=''">
            and (u.username like '%' + #{username} + '%' or u.pym like '%' + #{username} + '%')
        </if>
        <if test="PhoneNumber1 != null and PhoneNumber1 !=''">
            and ( ${p1} or ${p2})
        </if>
        <if test="idcardno != null and idcardno !='' ">
            and idcardno like '%' + #{idcardno} + '%'
        </if>
        <if test="querydata != null and querydata !='' ">
            and (u.usercode like '%' + #{querydata} + '%'
            or u.username like '%' + #{querydata} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{querydata} + '%'
            )
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        <if test="querytype != null and querytype !='' ">
            and (per2.seq_id in (${querytype})
            OR per3.seq_id IN (${querytype}))
        </if>
        <if test="type != null and type !='' ">
            and u.type = #{type}
        </if>
        <if test="usercode != null and usercode !='' ">
            and u.usercode = #{usercode}
        </if>
        <if test="regsort != null and regsort !='' ">
            and n.regsort = #{regsort}
        </if>
        ORDER BY u.CreateTime desc
    </select>
    <select id="selectByUserCodes" parameterType="java.lang.String" resultType="json">
		select
		t.seq_id,
		t.usercode,
		t.username,
		t.kefu,
		per1.user_name as kefuname,
		t.sex,
		t.birthday,
		t.idcardno,
		t.phonenumber1,
		t.phonenumber2,
		t.createuser,
		per2.user_name as createusername,
		t.createtime
		from KQDS_USERDOCUMENT t
		LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = t.kefu
		LEFT
		JOIN SYS_PERSON per2 on per2.SEQ_ID = t.createuser
		where 1=1
		and t.usercode in (${_parameter})
		ORDER BY t.CreateTime desc
	</select>
    <select id="selectWithNopage2" parameterType="map" resultType="json">
        <bind name="temp_dbType" value="${system_dbType}"/>
        select (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) as ywhf,
        u.createtime,
        u.seq_id,
        u.username,
        u.iscreatelclj,
        u.usercode,
        u.doorstatus,
        u.sex,
        u.age,u.blcode,
        u.phonenumber1,
        u.phonenumber2,
        u.devchannel,
        u.nexttype,
        u.city,
        u.province,
        u.openid,
        u.bindstatus,
        reg.createtime as regcreatetime
        from KQDS_USERDOCUMENT as u
        left join (select createtime,usercode from KQDS_REG where recesort = '20') reg on reg.usercode=u.usercode
        where 1=1
        and u.organization = #{organization}
        <if test="bindWX != null and bindWX !='' ">
            <if test='bindWX == "1"'>
                and (u.openid is not null and u.openid != '' and u.bindstatus = 0)
            </if>
            <if test='bindWX == "0"'>
                and (u.openid is null or u.openid = '' or u.bindstatus != 0)
            </if>
        </if>
        <if test="starttime != null and starttime !=''">
            and u.createtime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !=''">
            and u.createtime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="username != null and username !=''">
            and (u.usercode like '%' + #{username} + '%'
            or u.username like '%' + #{username} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{username} + '%'
            or u.blcode like '%' +
            #{username} + '%'
            )
        </if>
        <if test="ywhf != null and ywhf !='' ">
            <if test='ywhf == "0"'>
                and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) = 0
            </if>
            <if test='ywhf != "0"'>
                and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) > 0
            </if>
        </if>
        <!-- <if test="dystarttime != null and dystarttime !='' ">
			and (${subsql}) <![CDATA[ >= ]]>
			#{dystarttime}
		</if>
		<if test="dyendtime != null and dyendtime !='' ">
			and (${subsql}) <![CDATA[ <= ]]>
			#{dyendtime}
		</if> -->
        <if test="dystarttime != null and dystarttime !='' ">
            and (reg.createtime) <![CDATA[ >= ]]>
            #{dystarttime}
        </if>
        <if test="dyendtime != null and dyendtime !='' ">
            and (reg.createtime) <![CDATA[ <= ]]>
            #{dyendtime}
        </if>
        <if test="usercodes != null and usercodes !=''">
            and u.usercode in (${usercodes})
        </if>
        <if test="developer != null and developer !='' ">
            and u.developer = #{developer}
        </if>
        <if test="createuser != null and createuser !='' ">
            and u.createuser = #{createuser}
        </if>
        <if test="city != null and city !='' ">
            and u.city = #{city}
        </if>
        <if test="province != null and province !='' ">
            and u.province = #{province}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="doctor != null and doctor !='' ">
            and u.doctor = #{doctor}
        </if>
        <if test="askperson != null and askperson !='' ">
            and u.askperson = #{askperson}
        </if>
        <if test="isdelete != null and isdelete !='' ">
            and u.isdelete = #{isdelete}
        </if>
        <if test="type != null and type !='' ">
            and u.type = #{type}
        </if>
        <!-- 2019-3-10 修改信息查询页面可以查询到所有患者，去掉此处的权限校验 -->
        <if test="visualstaff != null and visualstaff !='' ">
            and (u.askperson in (${visualstaff}) or u.createuser in (${visualstaff}) or u.doctor in (${visualstaff})
            or EXISTS (select usercode from KQDS_COSTORDER_DETAIL where u.usercode=usercode and (askperson in(
            ${visualstaff}) or doctor in (${visualstaff})))
            or EXISTS (select usercode from KQDS_REG where u.usercode=usercode AND (askperson in( ${visualstaff}) or
            doctor in (${visualstaff}) ))
            )
        </if>
        <if test="sortName != null and sortName != '' ">
            ORDER BY ${sortName} ${sortOrder}
        </if>
        <if test="sortName == null">
            ORDER BY u.CreateTime desc
        </if>
    </select>
    <select id="selectCountxxcx" parameterType="map" resultType="int">
        select count(1)
        from KQDS_USERDOCUMENT as u
        where 1=1
        and u.organization = #{organization}
        <if test="bindWX != null and bindWX !='' ">
            <if test='bindWX == "1"'>
                and (u.openid is not null and u.openid != '' and u.bindstatus = 0)
            </if>
            <if test='bindWX == "0"'>
                and (u.openid is null or u.openid = '' or u.bindstatus != 0)
            </if>
        </if>
        <if test="starttime != null and starttime !=''">
            and u.createtime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !=''">
            and u.createtime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="username != null and username !=''">
            and (u.usercode like '%' + #{username} + '%'
            or u.username like '%' + #{username} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{username} + '%'
            or u.blcode like '%' +
            #{username} + '%'
            )
        </if>
        <if test="ywhf != null and ywhf !='' ">
            <if test='ywhf == "0"'>
                and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) = 0
            </if>
            <if test='ywhf != "0"'>
                and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) > 0
            </if>
        </if>
        <if test="dystarttime != null and dystarttime !='' ">
            and (${subsql}) <![CDATA[ >= ]]>
            #{dystarttime}
        </if>
        <if test="dyendtime != null and dyendtime !='' ">
            and (${subsql}) <![CDATA[ <= ]]>
            #{dyendtime}
        </if>
        <if test="usercodes != null and usercodes !=''">
            and u.usercode in (${usercodes})
        </if>
        <if test="developer != null and developer !='' ">
            and u.developer = #{developer}
        </if>
        <if test="createuser != null and createuser !='' ">
            and u.createuser = #{createuser}
        </if>
        <if test="city != null and city !='' ">
            and u.city = #{city}
        </if>
        <if test="province != null and province !='' ">
            and u.province = #{province}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="doctor != null and doctor !='' ">
            and u.doctor = #{doctor}
        </if>
        <if test="askperson != null and askperson !='' ">
            and u.askperson = #{askperson}
        </if>
        <if test="isdelete != null and isdelete !='' ">
            and u.isdelete = #{isdelete}
        </if>
        <if test="type != null and type !='' ">
            and u.type = #{type}
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and (u.askperson in (${visualstaff}) or u.createuser in (${visualstaff}) or u.doctor in (${visualstaff})
            or EXISTS (select usercode from KQDS_COSTORDER_DETAIL where u.usercode=usercode AND (askperson in (
            ${visualstaff}) or doctor in (${visualstaff})))
            or EXISTS (select usercode from KQDS_REG where u.usercode=usercode AND (askperson in( ${visualstaff}) or
            doctor in (${visualstaff})))
            )
        </if>
    </select>
    <select id="checkIdcardnoBySeqIdAndIdcardno" parameterType="map" resultType="int">
		select count(1) as num from KQDS_USERDOCUMENT where seq_id not in (#{seqId}) and IDCardNo =
		#{idcardno} and isdelete !=1
	</select>
    <select id="checkphonenumber" parameterType="map" resultType="int">
        select count(1) as num from KQDS_USERDOCUMENT where 1=1
        <if test="seqId != null and seqId !='' ">
            and seq_id not in (#{seqId})
        </if>
        <if test="phonenumber1 != null and phonenumber1 !=''">
            and (phonenumber1 = #{phonenumber1} or phonenumber2=#{phonenumber1})
        </if>
        <if test="phonenumber2 != null and phonenumber2 !='' ">
            and (phonenumber1 = #{phonenumber2} or phonenumber2=#{phonenumber2})
        </if>
        and isdelete !=1
    </select>
    <!-- 根据手机号查询患者档案表数据 2019-7-24 syp -->
    <select id="selectUserdocumentByPhonenumber" parameterType="map" resultType="com.kqds.entity.base.KqdsUserdocument">
        select PhoneNumber1,familyship from KQDS_USERDOCUMENT where 1=1
        <if test="phoneNumber != null and phoneNumber !=''">
            and (phonenumber1 = #{phoneNumber})
        </if>
        and isdelete !=1
    </select>
    <!-- 验证患者姓名是否已存在2019-7-23 syp -->
    <select id="checkUsername" parameterType="map" resultType="int">
        select count(1) as num from KQDS_USERDOCUMENT where 1=1
        <if test="seqId != null and seqId !='' ">
            and seq_id not in (#{seqId})
        </if>
        <if test="phonenumber1 != null and phonenumber1 !=''">
            and (phonenumber1 = #{phonenumber1} or phonenumber2=#{phonenumber1})
        </if>
        <if test="phonenumber2 != null and phonenumber2 !='' ">
            and (phonenumber1 = #{phonenumber2} or phonenumber2=#{phonenumber2})
        </if>
        <if test="username != null and username !='' ">
            and (username = #{username})
        </if>
        and isdelete !=1
    </select>
    <select id="checkBlcode" parameterType="map" resultType="int">
        select count(1) as num from KQDS_USERDOCUMENT where 1=1
        <if test="seqId != null and seqId !='' ">
            and seq_id not in (#{seqId})
        </if>
        <if test="blcode != null and blcode !='' ">
            and blcode = #{blcode}
        </if>
    </select>
    <update id="updateFlagBySeqIds1" parameterType="json">
		update KQDS_MEMBER set username = #{username} where usercode = #{usercode}
	</update>
    <update id="updateFlagBySeqIds2" parameterType="json">
		update KQDS_MEMBER_RECORD set szrusername = #{username} where szrusercode = #{usercode}
	</update>
    <update id="updateFlagBySeqIds3" parameterType="json">
		update ${tablename} set username = #{username} where usercode = #{usercode}
	</update>
    <update id="updateFlagBySeqIds4" parameterType="json">
		update ${tablename} set participant = #{username} where participantcode = #{usercode}
	</update>
    <update id="updateUser1" parameterType="json">
		update ${tablename} set usercode = #{usercode2} where usercode = #{usercode1}
	</update>
    <update id="updateUser2" parameterType="json">
		update ${tablename} set username = #{username2},usercode = #{usercode2} where usercode = #{usercode1}
	</update>
    <delete id="deleteuser" parameterType="json">
		delete from ${tablename} where usercode in(#{usercode})
	</delete>
    <update id="updateusers" parameterType="java.lang.String">
		update KQDS_USERDOCUMENT set isdelete = 1 where 1=1 and usercode in (${_parameter})
	</update>
    <select id="getSfuser" parameterType="map" resultType="json">
		SELECT usercode from KQDS_UserDocument u WHERE u.UserCode in (select usercode from KQDS_COSTORDER where status = 2)
	</select>
    <select id="getusercodeBYsjhm" parameterType="java.lang.String" resultType="json">
		select usercode from KQDS_USERDOCUMENT where phonenumber1 =#{_parameter} or phonenumber2
		=#{_parameter}
	</select>
    <select id="getSsje" parameterType="java.lang.String" resultType="json">
		select sum(detail.paymoney)as paymoney,
		sum(detail.payother2) as zs,
		sum(detail.paydjq) as djq,
		sum(detail.payintegral) as integral
		from KQDS_COSTORDER_DETAIL detail
		LEFT JOIN KQDS_COSTORDER cost on cost.costno = detail.costno
		left join KQDS_UserDocument u on u.usercode =
		detail.usercode
		where 1=1
		and cost.status = 2 and u.usercode = #{_parameter} and detail.isyjjitem != 1
	</select>
    <select id="getSsjeReg" parameterType="java.util.Map" resultType="json">
        select sum(detail.paymoney)as paymoney,
        sum(detail.payother2) as zs,
        sum(detail.paydjq) as djq,
        sum(detail.payintegral) as integral,
        cost.regno as regno
        from KQDS_COSTORDER_DETAIL detail
        LEFT JOIN KQDS_COSTORDER cost on cost.costno = detail.costno
        where 1=1
        and cost.status = 2 and cost.regno in (${regno}) <!--= #{_parameter}  -->
        and detail.isyjjitem != 1
        GROUP BY cost.regno
    </select>
    <select id="getSsjeOne" parameterType="java.lang.String" resultType="json">
		select sum(detail.paymoney)as paymoney,
		sum(detail.payother2) as zs,
		sum(detail.paydjq) as djq,
		sum(detail.payintegral) as integral
		from KQDS_COSTORDER_DETAIL detail
		LEFT JOIN KQDS_COSTORDER cost on cost.costno = detail.costno
		where 1=1
		and cost.status = 2 and cost.costno =
		#{_parameter} and detail.isyjjitem != 1
	</select>
    <select id="getJFjeOne" parameterType="java.lang.String" resultType="json">
		select
		sum(detail.payintegral) as integral
		from KQDS_COSTORDER_DETAIL detail
		LEFT JOIN KQDS_COSTORDER cost
		on cost.costno = detail.costno
		where 1=1
		and cost.status = 2 and cost.costno = #{_parameter} and detail.isyjjitem != 1
	</select>

    <select id="userManger4WdzxNum" parameterType="map" resultType="json">
        select
        sum(n.cjstatus) as cjstatus,
        sum(n.doorstatus) as doorstatus
        from kqds_userdocument u
        ${netsql} on n.usercode = u.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = u.createuser
        LEFT JOIN SYS_PERSON per2 on per2.SEQ_ID = u.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.glr
        LEFT JOIN SYS_DICT kcit3 on u.devchannel =kcit3.seq_id
        LEFT JOIN SYS_DICT hzly on u.nexttype = hzly.seq_id
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool = kcit2.seq_id
        LEFT JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        LEFT JOIN SYS_AREA a1 on u.province = a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town =a3.seq_id
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        where 1=1 and u.type = '1' and u.isdelete != '1'
        <if test="jdtime1 != null and jdtime1 !='' ">
            and u.createtime <![CDATA[ >= ]]>
            #{jdtime1}
        </if>
        <if test="jdtime2 != null and jdtime2 !='' ">
            and u.createtime <![CDATA[ <= ]]>
            #{jdtime2}
        </if>
        <if test="important != null and important !='' ">
            and u.important = #{important}
        </if>
        <if test="queryinput != null and queryinput !='' ">
            and (u.usercode like '%' + #{queryinput} + '%'
            or u.username like '%' + #{queryinput} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{queryinput} + '%'
            )
        </if>
        <if test="yewu2 != null and yewu2 !='' ">
            and ( u.createuser = #{yewu2} or u.glr = #{yewu2})
        </if>
        <if test="yewu3 != null and yewu3 !='' ">
            and 1 != 1
        </if>
        <if test="yewu4 != null and yewu4 !='' ">
            and (u.createuser in (${yewu4}) or u.askperson in (${yewu4}) or u.glr in (${yewu4}))
        </if>
        <if test="shouli != null and shouli !='' ">
            and n.accepttype = #{shouli}
        </if>
        <if test="gongju != null and gongju !='' ">
            and n.accepttool = #{gongju}
        </if>
        <if test="yytime1 != null and yytime1 !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{yytime1}
        </if>
        <if test="yytime2 != null and yytime2 !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{yytime2}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and n.cjstatus = #{cjstatus}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and u.doorstatus = #{doorstatus}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
    </select>

    <select id="userManger4Wdzx" parameterType="map" resultType="json">
        select
        odept.dept_name as organizationname,
        a1.area_name as provincename,
        a2.area_name as cityname,
        a3.area_name as townname,
        u.seq_id,
        u.province,
        u.city,
        u.town,
        u.phonenumber1,
        u.phonenumber2,
        u.xueli,
        u.qq,
        u.usercode,
        u.username,
        u.age,
        u.important,
        per1.user_name as createuser,
        u.createtime,
        u.remark,
        kcit3.dict_name as devchannel,
        hzly.dict_name as nexttype,
        per2.user_name as askperson,
        per3.user_name as glr,
        u.glrremark,
        u.familyship,
        u.type,
        u.doorstatus as zdoorstatus,
        kcit4.dict_name as askitem ,
        n.organization,
        n.ordertime,
        n.guidetime,
        n.askcontent,
        kcit1.dict_name as accepttype,
        n.cjstatus,
        kcit2.dict_name as accepttool,
        n.doorstatus,
        p.PROVINCE_NAME,
        c.CITY_NAME,
        a.AREA_NAME,
        s.STREET_NAME
        from kqds_userdocument u
        ${netsql} on n.usercode = u.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = u.createuser
        LEFT JOIN SYS_PERSON per2 on per2.SEQ_ID = u.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.glr
        LEFT JOIN SYS_DICT kcit3 on u.devchannel =kcit3.seq_id
        LEFT JOIN SYS_DICT hzly on u.nexttype = hzly.seq_id
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool = kcit2.seq_id
        LEFT JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        LEFT JOIN SYS_AREA a1 on u.province = a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town = a3.seq_id
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        left join bs_province p on p.PROVINCE_CODE = u.province
        left join bs_city c on c.CITY_CODE = u.city
        left join bs_area a on a.AREA_CODE = u.area
        left join bs_street s on s.STREET_CODE = u.town
        where 1=1 and u.type = '1' and u.isdelete != '1'
        <if test="jdtime1 != null and jdtime1 !='' ">
            and u.createtime <![CDATA[ >= ]]>
            #{jdtime1}
        </if>
        <if test="jdtime2 != null and jdtime2 !='' ">
            and u.createtime <![CDATA[ <= ]]>
            #{jdtime2}
        </if>
        <if test="important != null and important !='' ">
            and u.important = #{important}
        </if>
        <if test="queryinput != null and queryinput !='' ">
            and (u.usercode like '%' + #{queryinput} + '%'
            or u.username like '%' + #{queryinput} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{queryinput} + '%'
            )
        </if>
        <if test="yewu2 != null and yewu2 !='' ">
            and ( u.createuser = #{yewu2} or u.glr = #{yewu2})
        </if>
        <if test="yewu3 != null and yewu3 !='' ">
            and 1 != 1
        </if>
        <if test="yewu4 != null and yewu4 !='' ">
            and (u.createuser in (${yewu4}) or u.askperson in (${yewu4}) or u.glr in (${yewu4}))
        </if>
        <if test="shouli != null and shouli !='' ">
            and n.accepttype = #{shouli}
        </if>
        <if test="gongju != null and gongju !='' ">
            and n.accepttool = #{gongju}
        </if>
        <if test="yytime1 != null and yytime1 !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{yytime1}
        </if>
        <if test="yytime2 != null and yytime2 !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{yytime2}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and n.cjstatus = #{cjstatus}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and u.doorstatus = #{doorstatus}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        <if test="sortName != null and sortName !='' ">
            ORDER BY ${sortName} ${sortOrder}
        </if>
        <if test="sortName == null">
            ORDER BY u.createtime desc
        </if>
    </select>

    <!-- 正畸人员查找网电数据 -->
    <select id="userManger4WdzxNetNum" parameterType="map" resultType="json">
        select
        sum(n.cjstatus) as cjstatus,
        sum(n.doorstatus) as doorstatus
        from kqds_userdocument u
        ${netsql} on n.usercode = u.usercode
        LEFT JOIN SYS_PERSON per1 on
        per1.SEQ_ID = u.createuser
        LEFT JOIN SYS_PERSON per2 on per2.SEQ_ID = u.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.glr
        LEFT JOIN SYS_DICT kcit3 on u.devchannel =
        kcit3.seq_id
        LEFT JOIN SYS_DICT hzly on u.nexttype = hzly.seq_id
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool = kcit2.seq_id
        LEFT
        JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        LEFT JOIN SYS_AREA a1 on u.province = a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town =
        a3.seq_id
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        where 1=1 and u.type = '1' and u.isdelete != '1'
        <if test="jdtime1 != null and jdtime1 !='' ">
            and u.createtime <![CDATA[ >= ]]>
            #{jdtime1}
        </if>
        <if test="jdtime2 != null and jdtime2 !='' ">
            and u.createtime <![CDATA[ <= ]]>
            #{jdtime2}
        </if>
        <if test="important != null and important !='' ">
            and u.important = #{important}
        </if>
        <if test="queryinput != null and queryinput !='' ">
            and (u.usercode like '%' + #{queryinput} + '%'
            or u.username like '%' + #{queryinput} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{queryinput} + '%'
            )
        </if>
        <if test="yewu2 != null and yewu2 !='' ">
            and ( u.createuser = #{yewu2} or u.glr = #{yewu2})
        </if>
        <if test="yewu3 != null and yewu3 !='' ">
            and 1 != 1
        </if>
        <if test="yewu4 != null and yewu4 !='' ">
            and (u.createuser in (${yewu4}) or u.askperson in (${yewu4}) or u.glr in (${yewu4}))
        </if>
        <!-- 		<if test="shouli != null and shouli !='' "> -->
        and n.accepttype = 'zj634'
        <!-- 	</if> -->
        <if test="gongju != null and gongju !='' ">
            and n.accepttool = #{gongju}
        </if>
        <if test="yytime1 != null and yytime1 !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{yytime1}
        </if>
        <if test="yytime2 != null and yytime2 !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{yytime2}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and n.cjstatus = #{cjstatus}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and u.doorstatus = #{doorstatus}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
    </select>

    <!-- 正畸人员查找网电数据 -->
    <select id="userManger4WdzxNet" parameterType="map" resultType="json">
        select
        odept.dept_name as organizationname,
        a1.area_name as provincename,
        a2.area_name as cityname,
        a3.area_name as townname,
        u.seq_id,
        u.province,
        u.city,
        u.town,
        u.phonenumber1,
        u.phonenumber2,
        u.xueli,
        u.qq,
        u.usercode,
        u.username,
        u.age,
        u.important,
        per1.user_name as createuser,
        u.createtime,
        u.remark,
        kcit3.dict_name as devchannel,
        hzly.dict_name as nexttype,
        per2.user_name as askperson,
        per3.user_name as glr,
        u.glrremark,
        u.type,
        u.doorstatus as zdoorstatus,
        kcit4.dict_name as askitem ,
        n.organization,
        n.ordertime,
        n.guidetime,
        n.askcontent,
        kcit1.dict_name as accepttype,
        n.cjstatus,
        kcit2.dict_name as accepttool,
        n.doorstatus,
        p.PROVINCE_NAME,
        c.CITY_NAME,
        a.AREA_NAME,
        s.STREET_NAME
        from kqds_userdocument u
        ${netsql} on n.usercode = u.usercode
        LEFT JOIN SYS_PERSON per1 on
        per1.SEQ_ID = u.createuser
        LEFT JOIN SYS_PERSON per2 on per2.SEQ_ID = u.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.glr
        LEFT JOIN SYS_DICT kcit3 on u.devchannel =
        kcit3.seq_id
        LEFT JOIN SYS_DICT hzly on u.nexttype = hzly.seq_id
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool = kcit2.seq_id
        LEFT
        JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        LEFT JOIN SYS_AREA a1 on u.province = a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town =
        a3.seq_id
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        left join bs_province p on p.PROVINCE_CODE = u.province
        left join bs_city c on c.CITY_CODE = u.city
        left join bs_area a on a.AREA_CODE = u.area
        left join bs_street s on s.STREET_CODE = u.town
        where 1=1 and u.type = '1' and u.isdelete != '1'
        <if test="jdtime1 != null and jdtime1 !='' ">
            and u.createtime <![CDATA[ >= ]]>
            #{jdtime1}
        </if>
        <if test="jdtime2 != null and jdtime2 !='' ">
            and u.createtime <![CDATA[ <= ]]>
            #{jdtime2}
        </if>
        <if test="important != null and important !='' ">
            and u.important = #{important}
        </if>
        <if test="queryinput != null and queryinput !='' ">
            and (u.usercode like '%' + #{queryinput} + '%'
            or u.username like '%' + #{queryinput} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{queryinput} + '%'
            )
        </if>
        <if test="yewu2 != null and yewu2 !='' ">
            and ( u.createuser = #{yewu2} or u.glr = #{yewu2})
        </if>
        <if test="yewu3 != null and yewu3 !='' ">
            and 1 != 1
        </if>
        <if test="yewu4 != null and yewu4 !='' ">
            and (u.createuser in (${yewu4}) or u.askperson in (${yewu4}) or u.glr in (${yewu4}))
        </if>
        <!-- 		<if test="shouli != null and shouli !='' "> -->
        and n.accepttype = 'zj634'
        <!-- 	</if> -->
        <if test="gongju != null and gongju !='' ">
            and n.accepttool = #{gongju}
        </if>
        <if test="yytime1 != null and yytime1 !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{yytime1}
        </if>
        <if test="yytime2 != null and yytime2 !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{yytime2}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and n.cjstatus = #{cjstatus}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and u.doorstatus = #{doorstatus}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        <if test="sortName != null and sortName !='' ">
            ORDER BY ${sortName} ${sortOrder}
        </if>
        <if test="sortName == null">
            ORDER BY u.createtime desc
        </if>
    </select>

    <select id="userManger4KfzxNum" parameterType="map" resultType="json">
        select
        sum(n.cjstatus) as cjstatus,
        sum(n.doorstatus) as doorstatus
        from kqds_userdocument u
        left join (select a.SEQ_ID, a.createuser, a.createtime, a.usercode, a.acceptdate, a.acceptphone, a.accepttype,
        a.accepttool,
        a.askitem, a.askperson, a.askno, a.organization, a.orderperson, a.ordertime, a.doorstatus,a.guidetime,
        a.jzxx, a.regdept, a.remark, a.username, a.daoyi, a.cjstatus, a.zxremark, a.regno, a.source, a.isdelete,
        a.askcontent from KQDS_NET_ORDER a,(select usercode,max(createtime) createtime from KQDS_NET_ORDER group by
        usercode) b where a.usercode=b.usercode and
        a.createtime=b.createtime ) n on n.usercode = u.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = u.createuser
        LEFT JOIN SYS_PERSON
        per2 on per2.SEQ_ID = u.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.glr
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.kefu
        LEFT JOIN SYS_DICT kcit3 on u.devchannel =
        kcit3.seq_id
        LEFT JOIN SYS_DICT hzly on u.nexttype = hzly.seq_id
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool = kcit2.seq_id
        LEFT
        JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        LEFT JOIN SYS_AREA a1 on u.province =
        a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town = a3.seq_id
        ${netsql} on r.usercode = u.usercode
        where 1=1 and u.isdelete != '1'
        <if test="jdtime1 != null and jdtime1 !='' ">
            and u.createtime <![CDATA[ >= ]]>
            #{jdtime1}
        </if>
        <if test="jdtime2 != null and jdtime2 !='' ">
            and u.createtime <![CDATA[ <= ]]>
            #{jdtime2}
        </if>
        <if test="important != null and important !='' ">
            and u.important = #{important}
        </if>
        <if test="queryinput != null and queryinput !='' ">
            and (u.usercode like '%' + #{queryinput} + '%'
            or u.username like '%' + #{queryinput} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{queryinput} + '%'
            )
        </if>
        <if test="yewu2 != null and yewu2 !='' ">
            and ( u.createuser = #{yewu2} or u.glr = #{yewu2})
        </if>
        <if test="yewu3 != null and yewu3 !='' ">
            and 1 != 1
        </if>
        <if test="yewu4 != null and yewu4 !='' ">
            and (u.createuser in (${yewu4}) or u.kefu in (${yewu4}) or u.askperson in (${yewu4}) or u.glr in (${yewu4}))
        </if>
        <if test="shouli != null and shouli !='' ">
            and n.accepttype = #{shouli}
        </if>
        <if test="gongju != null and gongju !='' ">
            and n.accepttool = #{gongju}
        </if>
        <if test="yytime1 != null and yytime1 !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{yytime1}
        </if>
        <if test="yytime2 != null and yytime2 !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{yytime2}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="customer != null and customer !='' ">
            and per4.user_name = #{customer}  <!-- 添加指定客服条件查询 -->
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and n.cjstatus = #{cjstatus}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and u.doorstatus = #{doorstatus}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        <if test="nohf != null and nohf !='' ">
            and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) = 0
        </if>
        <if test="ishf != null and ishf !='' ">
            and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) > 0
        </if>
    </select>
    <select id="userManger4KfzxNumByUsercodes" parameterType="map" resultType="json">
        select
        sum(n.cjstatus) as cjstatus,
        sum(n.doorstatus) as doorstatus
        from kqds_userdocument u
        left join (select a.SEQ_ID, a.createuser, a.createtime, a.usercode, a.acceptdate, a.acceptphone, a.accepttype,
        a.accepttool,
        a.askitem, a.askperson, a.askno, a.organization, a.orderperson, a.ordertime, a.doorstatus,a.guidetime,
        a.jzxx, a.regdept, a.remark, a.username, a.daoyi, a.cjstatus, a.zxremark, a.regno, a.source, a.isdelete,
        a.askcontent from KQDS_NET_ORDER a,(select usercode,max(createtime) createtime from KQDS_NET_ORDER group by
        usercode) b where a.usercode=b.usercode and
        a.createtime=b.createtime ) n on n.usercode = u.usercode
        where 1=1 and u.isdelete != '1'
        <if test="jdtime1 != null and jdtime1 !='' ">
            and u.createtime <![CDATA[ >= ]]>
            #{jdtime1}
        </if>
        <if test="jdtime2 != null and jdtime2 !='' ">
            and u.createtime <![CDATA[ <= ]]>
            #{jdtime2}
        </if>
        <if test="important != null and important !='' ">
            and u.important = #{important}
        </if>
        <if test="queryinput != null and queryinput !='' ">
            and (u.usercode like '%' + #{queryinput} + '%'
            or u.username like '%' + #{queryinput} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{queryinput} + '%'
            )
        </if>
        <if test="yewu2 != null and yewu2 !='' ">
            and ( u.createuser = #{yewu2} or u.glr = #{yewu2})
        </if>
        <if test="yewu3 != null and yewu3 !='' ">
            and 1 != 1
        </if>
        <if test="yewu4 != null and yewu4 !='' ">
            and (u.createuser in (${yewu4}) or u.kefu in (${yewu4}) or u.askperson in (${yewu4}) or u.glr in (${yewu4}))
        </if>
        <if test="shouli != null and shouli !='' ">
            and n.accepttype = #{shouli}
        </if>
        <if test="gongju != null and gongju !='' ">
            and n.accepttool = #{gongju}
        </if>
        <if test="yytime1 != null and yytime1 !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{yytime1}
        </if>
        <if test="yytime2 != null and yytime2 !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{yytime2}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="customer != null and customer !='' ">
            and per4.user_name = #{customer}  <!-- 添加指定客服条件查询 -->
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and n.cjstatus = #{cjstatus}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and u.doorstatus = #{doorstatus}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        <if test="nohf != null and nohf !='' ">
            and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) = 0
        </if>
        <if test="ishf != null and ishf !='' ">
            and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) > 0
        </if>
        <if test="usercodealls!=null">
            and u.usercode in (${usercodealls})
        </if>
    </select>
    <select id="userManger4KfzxByUsercodes" parameterType="map" resultType="json">
        select
        odept.dept_name as organizationname,
        a1.area_name as provincename,
        a2.area_name as cityname,
        a3.area_name as townname,
        u.seq_id,
        u.province,
        u.city,
        u.town,
        u.type,
        u.phonenumber1,
        u.phonenumber2,
        u.xueli,
        u.qq,
        u.usercode,
        u.username,
        u.age,
        u.important,
        per1.user_name as createuser,
        u.createtime,
        u.remark,
        kcit3.dict_name as devchannel,
        hzly.dict_name as nexttype,
        per2.user_name as askperson,
        per3.user_name as glr,
        per4.user_name as kefuname,
        u.glrremark,
        u.familyship,
        u.doorstatus as zdoorstatus,
        kcit4.dict_name as askitem ,
        n.organization,
        n.ordertime,
        n.guidetime,
        n.askcontent,
        kcit1.dict_name as accepttype,
        n.cjstatus,
        kcit2.dict_name as
        accepttool,
        n.doorstatus,
        (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) as ywhf
        from kqds_userdocument u
        left join (select a.SEQ_ID, a.createuser, a.createtime, a.usercode, a.acceptdate, a.acceptphone, a.accepttype,
        a.accepttool,
        a.askitem, a.askperson, a.askno, a.organization, a.orderperson, a.ordertime, a.doorstatus,a.guidetime,
        a.jzxx, a.regdept, a.remark, a.username, a.daoyi, a.cjstatus, a.zxremark, a.regno, a.source, a.isdelete,
        a.askcontent from KQDS_NET_ORDER a,(select usercode,max(createtime) createtime from KQDS_NET_ORDER group by
        usercode) b where a.usercode=b.usercode and
        a.createtime=b.createtime ) n on n.usercode = u.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = u.createuser
        LEFT JOIN SYS_PERSON
        per2 on per2.SEQ_ID = u.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.glr
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.kefu
        LEFT JOIN SYS_DICT kcit3 on u.devchannel =
        kcit3.seq_id
        LEFT JOIN SYS_DICT hzly on u.nexttype = hzly.seq_id
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool = kcit2.seq_id
        LEFT
        JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        LEFT JOIN SYS_AREA a1 on u.province =
        a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town = a3.seq_id
        ${netsql} on r.usercode = u.usercode
        where 1=1 and u.isdelete != '1'

        <if test="jdtime1 != null and jdtime1 !='' ">
            and u.createtime <![CDATA[ >= ]]>
            #{jdtime1}
        </if>
        <if test="jdtime2 != null and jdtime2 !='' ">
            and u.createtime <![CDATA[ <= ]]>
            #{jdtime2}
        </if>
        <if test="important != null and important !='' ">
            and u.important = #{important}
        </if>
        <if test="queryinput != null and queryinput !='' ">
            and (u.usercode like '%' + #{queryinput} + '%'
            or u.username like '%' + #{queryinput} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{queryinput} + '%'
            )
        </if>
        <if test="yewu2 != null and yewu2 !='' ">
            and ( u.createuser = #{yewu2} or u.glr = #{yewu2})
        </if>
        <if test="yewu3 != null and yewu3 !='' ">
            and 1 != 1
        </if>
        <if test="yewu4 != null and yewu4 !='' ">
            and (u.createuser in (${yewu4}) or u.kefu in (${yewu4}) or u.askperson in (${yewu4}) or u.glr in (${yewu4}))
        </if>
        <if test="shouli != null and shouli !='' ">
            and n.accepttype = #{shouli}
        </if>
        <if test="gongju != null and gongju !='' ">
            and n.accepttool = #{gongju}
        </if>
        <if test="yytime1 != null and yytime1 !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{yytime1}
        </if>
        <if test="yytime2 != null and yytime2 !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{yytime2}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="customer != null and customer !='' ">
            and per4.user_name = #{customer}  <!-- 添加指定客服条件查询 -->
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and n.cjstatus = #{cjstatus}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and u.doorstatus = #{doorstatus}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        <if test="nohf != null and nohf !='' ">
            and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) = 0
        </if>
        <if test="ishf != null and ishf !='' ">
            and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) > 0
        </if>
        <if test="usercode!=null">
            and u.usercode=#{usercode}
        </if>
        <if test="usercodealls !=null">
            and u.usercode IN (${usercodealls})
        </if>
        <if test="sortName != null and sortName !='' ">
            ORDER BY ${sortName} ${sortOrder}
        </if>
        <if test="sortName == null">
            ORDER BY u.createtime desc
        </if>
    </select>
    <select id="userManger4KfzxNumsByUsercodes" parameterType="map" resultType="json">
        select
        count(*) as linage
        from kqds_userdocument u
        left join (select a.SEQ_ID, a.createuser, a.createtime, a.usercode, a.acceptdate, a.acceptphone, a.accepttype,
        a.accepttool,
        a.askitem, a.askperson, a.askno, a.organization, a.orderperson, a.ordertime, a.doorstatus,a.guidetime,
        a.jzxx, a.regdept, a.remark, a.username, a.daoyi, a.cjstatus, a.zxremark, a.regno, a.source, a.isdelete,
        a.askcontent from KQDS_NET_ORDER a,(select usercode,max(createtime) createtime from KQDS_NET_ORDER group by
        usercode) b where a.usercode=b.usercode and
        a.createtime=b.createtime ) n on n.usercode = u.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = u.createuser
        LEFT JOIN SYS_PERSON
        per2 on per2.SEQ_ID = u.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.glr
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.kefu
        LEFT JOIN SYS_DICT kcit3 on u.devchannel =
        kcit3.seq_id
        LEFT JOIN SYS_DICT hzly on u.nexttype = hzly.seq_id
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool = kcit2.seq_id
        LEFT
        JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        LEFT JOIN SYS_AREA a1 on u.province =
        a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town = a3.seq_id
        ${netsql} on r.usercode = u.usercode
        where 1=1 and u.isdelete != '1'

        <if test="jdtime1 != null and jdtime1 !='' ">
            and u.createtime <![CDATA[ >= ]]>
            #{jdtime1}
        </if>
        <if test="jdtime2 != null and jdtime2 !='' ">
            and u.createtime <![CDATA[ <= ]]>
            #{jdtime2}
        </if>
        <if test="important != null and important !='' ">
            and u.important = #{important}
        </if>
        <if test="queryinput != null and queryinput !='' ">
            and (u.usercode like '%' + #{queryinput} + '%'
            or u.username like '%' + #{queryinput} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{queryinput} + '%'
            )
        </if>
        <if test="yewu2 != null and yewu2 !='' ">
            and ( u.createuser = #{yewu2} or u.glr = #{yewu2})
        </if>
        <if test="yewu3 != null and yewu3 !='' ">
            and 1 != 1
        </if>
        <if test="yewu4 != null and yewu4 !='' ">
            and (u.createuser in (${yewu4}) or u.kefu in (${yewu4}) or u.askperson in (${yewu4}) or u.glr in (${yewu4}))
        </if>
        <if test="shouli != null and shouli !='' ">
            and n.accepttype = #{shouli}
        </if>
        <if test="gongju != null and gongju !='' ">
            and n.accepttool = #{gongju}
        </if>
        <if test="yytime1 != null and yytime1 !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{yytime1}
        </if>
        <if test="yytime2 != null and yytime2 !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{yytime2}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="customer != null and customer !='' ">
            and per4.user_name = #{customer}  <!-- 添加指定客服条件查询 -->
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and n.cjstatus = #{cjstatus}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and u.doorstatus = #{doorstatus}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        <if test="nohf != null and nohf !='' ">
            and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) = 0
        </if>
        <if test="ishf != null and ishf !='' ">
            and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) > 0
        </if>
        <if test="usercodealls !=null">
            and u.usercode in (${usercodealls})
        </if>
    </select>

    <select id="userManger4Kfzx" parameterType="map" resultType="json">
        select
        odept.dept_name as organizationname,
        a1.area_name as provincename,
        a2.area_name as cityname,
        a3.area_name as townname,
        u.seq_id,
        u.province,
        u.city,
        u.town,
        u.type,
        u.phonenumber1,
        u.phonenumber2,
        u.xueli,
        u.qq,
        u.usercode,
        u.username,
        u.age,
        u.important,
        per1.user_name as createuser,
        u.createtime,
        u.remark,
        kcit3.dict_name as devchannel,
        hzly.dict_name as nexttype,
        per2.user_name as askperson,
        per3.user_name as glr,
        per4.user_name as kefuname,
        u.glrremark,
        u.familyship,
        u.doorstatus as zdoorstatus,
        kcit4.dict_name as askitem ,
        n.organization,
        n.ordertime,
        n.guidetime,
        n.askcontent,
        kcit1.dict_name as accepttype,
        n.cjstatus,
        kcit2.dict_name as
        accepttool,
        n.doorstatus,
        (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) as ywhf
        from kqds_userdocument u
        left join (select a.SEQ_ID, a.createuser, a.createtime, a.usercode, a.acceptdate, a.acceptphone, a.accepttype,
        a.accepttool,
        a.askitem, a.askperson, a.askno, a.organization, a.orderperson, a.ordertime, a.doorstatus,a.guidetime,
        a.jzxx, a.regdept, a.remark, a.username, a.daoyi, a.cjstatus, a.zxremark, a.regno, a.source, a.isdelete,
        a.askcontent from KQDS_NET_ORDER a,(select usercode,max(createtime) createtime from KQDS_NET_ORDER group by
        usercode) b where a.usercode=b.usercode and
        a.createtime=b.createtime ) n on n.usercode = u.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = u.createuser
        LEFT JOIN SYS_PERSON
        per2 on per2.SEQ_ID = u.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.glr
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.kefu
        LEFT JOIN SYS_DICT kcit3 on u.devchannel =
        kcit3.seq_id
        LEFT JOIN SYS_DICT hzly on u.nexttype = hzly.seq_id
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool = kcit2.seq_id
        LEFT
        JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        LEFT JOIN SYS_AREA a1 on u.province =
        a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town = a3.seq_id
        ${netsql} on r.usercode = u.usercode
        where 1=1 and u.isdelete != '1'

        <if test="jdtime1 != null and jdtime1 !='' ">
            and u.createtime <![CDATA[ >= ]]>
            #{jdtime1}
        </if>
        <if test="jdtime2 != null and jdtime2 !='' ">
            and u.createtime <![CDATA[ <= ]]>
            #{jdtime2}
        </if>
        <if test="important != null and important !='' ">
            and u.important = #{important}
        </if>
        <if test="queryinput != null and queryinput !='' ">
            and (u.usercode like '%' + #{queryinput} + '%'
            or u.username like '%' + #{queryinput} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{queryinput} + '%'
            )
        </if>
        <if test="yewu2 != null and yewu2 !='' ">
            and ( u.createuser = #{yewu2} or u.glr = #{yewu2})
        </if>
        <if test="yewu3 != null and yewu3 !='' ">
            and 1 != 1
        </if>
        <if test="yewu4 != null and yewu4 !='' ">
            and (u.createuser in (${yewu4}) or u.kefu in (${yewu4}) or u.askperson in (${yewu4}) or u.glr in (${yewu4}))
        </if>
        <if test="shouli != null and shouli !='' ">
            and n.accepttype = #{shouli}
        </if>
        <if test="gongju != null and gongju !='' ">
            and n.accepttool = #{gongju}
        </if>
        <if test="yytime1 != null and yytime1 !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{yytime1}
        </if>
        <if test="yytime2 != null and yytime2 !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{yytime2}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="customer != null and customer !='' ">
            and per4.user_name = #{customer}  <!-- 添加指定客服条件查询 -->
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and n.cjstatus = #{cjstatus}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and u.doorstatus = #{doorstatus}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        <if test="nohf != null and nohf !='' ">
            and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) = 0
        </if>
        <if test="ishf != null and ishf !='' ">
            and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) > 0
        </if>
        <if test="sortName != null and sortName !='' ">
            ORDER BY ${sortName} ${sortOrder}
        </if>
        <if test="sortName == null">
            ORDER BY u.createtime desc
        </if>
    </select>

    <select id="userManger4YxzxNum" parameterType="map" resultType="json">
        select
        sum(n.cjstatus) as cjstatus,
        sum(n.doorstatus) as doorstatus
        from kqds_userdocument u ${netsql}
        on n.usercode = u.usercode
        LEFT JOIN SYS_PERSON
        per1 on per1.SEQ_ID = u.createuser
        LEFT JOIN SYS_PERSON per2 on per2.SEQ_ID = u.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.glr
        LEFT JOIN SYS_DICT kcit3 on u.devchannel =
        kcit3.seq_id
        LEFT JOIN SYS_DICT hzly on u.nexttype = hzly.seq_id
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool = kcit2.seq_id
        LEFT
        JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        LEFT JOIN SYS_AREA a1 on u.province =
        a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town = a3.seq_id
        where 1=1 and u.type = '1' and u.isdelete != '1'
        <if test="jdtime1 != null and jdtime1 !='' ">
            and u.createtime <![CDATA[ >= ]]>
            #{jdtime1}
        </if>
        <if test="jdtime2 != null and jdtime2 !='' ">
            and u.createtime <![CDATA[ <= ]]>
            #{jdtime2}
        </if>
        <if test="important != null and important !='' ">
            and u.important = #{important}
        </if>
        <if test="queryinput != null and queryinput !='' ">
            and (u.usercode like '%' + #{queryinput} + '%'
            or u.username like '%' + #{queryinput} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{queryinput} + '%'
            )
        </if>
        <if test="yewu2 != null and yewu2 !='' ">
            and ( u.createuser = #{yewu2} or u.glr = #{yewu2})
        </if>
        <if test="yewu3 != null and yewu3 !='' ">
            and 1 != 1
        </if>
        <if test="yewu4 != null and yewu4 !='' ">
            and (u.createuser in (${yewu4}) or u.askperson in (${yewu4}) or u.glr in (${yewu4}))
        </if>
        <if test="shouli != null and shouli !='' ">
            and n.accepttype = #{shouli}
        </if>
        <if test="gongju != null and gongju !='' ">
            and n.accepttool = #{gongju}
        </if>
        <if test="yytime1 != null and yytime1 !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{yytime1}
        </if>
        <if test="yytime2 != null and yytime2 !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{yytime2}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and n.cjstatus = #{cjstatus}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and u.doorstatus = #{doorstatus}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
    </select>


    <select id="userManger4Yxzx" parameterType="map" resultType="json">
        select
        odept.dept_name as organizationname,
        a1.area_name as provincename,
        a2.area_name as cityname,
        a3.area_name as townname,
        u.seq_id,
        u.province,
        u.city,
        u.town,
        u.phonenumber1,
        u.phonenumber2,
        u.xueli,
        u.qq,
        u.usercode,
        u.username,
        u.age,
        u.important,
        per1.user_name as createuser,
        u.createtime,
        u.remark,
        u.type,
        kcit3.dict_name as devchannel,
        hzly.dict_name as
        nexttype,
        per2.user_name as askperson,
        per3.user_name as glr,
        u.glrremark,
        u.doorstatus as zdoorstatus,
        u.familyship,
        kcit4.dict_name as askitem ,
        n.organization,
        n.ordertime,
        n.guidetime,
        n.askcontent,
        kcit1.dict_name as accepttype,
        n.cjstatus,
        kcit2.dict_name as accepttool,
        n.doorstatus,
        p.PROVINCE_NAME,
        c.CITY_NAME,
        a.AREA_NAME,
        s.STREET_NAME
        from kqds_userdocument u ${netsql}
        on n.usercode = u.usercode
        LEFT JOIN SYS_PERSON
        per1 on per1.SEQ_ID = u.createuser
        LEFT JOIN SYS_PERSON per2 on per2.SEQ_ID = u.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.glr
        LEFT JOIN SYS_DICT kcit3 on u.devchannel =
        kcit3.seq_id
        LEFT JOIN SYS_DICT hzly on u.nexttype = hzly.seq_id
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool = kcit2.seq_id
        LEFT
        JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        LEFT JOIN SYS_AREA a1 on u.province =
        a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town = a3.seq_id
        left join bs_province p on p.PROVINCE_CODE = u.province
        left join bs_city c on c.CITY_CODE = u.city
        left join bs_area a on a.AREA_CODE = u.area
        left join bs_street s on s.STREET_CODE = u.town
        where 1=1 and u.type = '1' and u.isdelete != '1'
        <if test="jdtime1 != null and jdtime1 !='' ">
            and u.createtime <![CDATA[ >= ]]>
            #{jdtime1}
        </if>
        <if test="jdtime2 != null and jdtime2 !='' ">
            and u.createtime <![CDATA[ <= ]]>
            #{jdtime2}
        </if>
        <if test="important != null and important !='' ">
            and u.important = #{important}
        </if>
        <if test="queryinput != null and queryinput !='' ">
            and (u.usercode like '%' + #{queryinput} + '%'
            or u.username like '%' + #{queryinput} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{queryinput} + '%'
            )
        </if>
        <if test="yewu2 != null and yewu2 !='' ">
            and ( u.createuser = #{yewu2} or u.glr = #{yewu2})
        </if>
        <if test="yewu3 != null and yewu3 !='' ">
            and 1 != 1
        </if>
        <if test="yewu4 != null and yewu4 !='' ">
            and (u.createuser in (${yewu4}) or u.askperson in (${yewu4}) or u.glr in (${yewu4}))
        </if>
        <if test="shouli != null and shouli !='' ">
            and n.accepttype = #{shouli}
        </if>
        <if test="gongju != null and gongju !='' ">
            and n.accepttool = #{gongju}
        </if>
        <if test="yytime1 != null and yytime1 !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{yytime1}
        </if>
        <if test="yytime2 != null and yytime2 !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{yytime2}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and n.cjstatus = #{cjstatus}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and u.doorstatus = #{doorstatus}
        </if>
        <if test="organization != null and organization !='' ">
            and u.organization = #{organization}
        </if>
        <if test="sortName !=null and sortName !=''">
            ORDER BY ${sortName} ${sortOrder}
        </if>
        <if test="sortName==null">
            ORDER BY u.createtime desc
        </if>
    </select>
    <select id="jingQueChaXun4Net" parameterType="map" resultType="json">
        select
        odept.dept_name as organizationname,
        u.seq_id,
        u.province,
        u.city,
        u.town,
        a1.area_name as provincename,
        a2.area_name as cityname,
        a3.area_name as townname,
        u.phonenumber1,
        u.phonenumber2,
        u.xueli,
        u.qq,
        u.usercode,
        u.username,
        u.age,
        u.important,
        per1.user_name as createuser,
        u.createtime,
        u.remark,
        kcit3.dict_name as devchannel,
        hzly.dict_name as nexttype,
        per2.user_name as askperson,
        per3.user_name as glr,
        u.glrremark,
        u.doorstatus as zdoorstatus,
        kcit4.dict_name as askitem ,
        n.organization,
        n.ordertime,
        n.guidetime,
        n.askcontent,
        kcit1.dict_name as accepttype,
        n.cjstatus,
        kcit2.dict_name as accepttool,
        n.doorstatus
        from kqds_userdocument u
        left join (select a.SEQ_ID, a.createuser, a.createtime, a.usercode, a.acceptdate, a.acceptphone, a.accepttype,
        a.accepttool,
        a.askitem, a.askperson, a.askno, a.organization, a.orderperson, a.ordertime, a.doorstatus,a.guidetime,
        a.jzxx, a.regdept, a.remark, a.username, a.daoyi, a.cjstatus, a.zxremark, a.regno, a.source, a.isdelete,
        a.askcontent from KQDS_NET_ORDER a,(select
        usercode,max(createtime) createtime from KQDS_NET_ORDER group by usercode) b where a.usercode=b.usercode and
        a.createtime=b.createtime ) n
        on n.usercode = u.usercode
        LEFT JOIN
        SYS_PERSON per1 on per1.SEQ_ID = u.createuser
        LEFT JOIN SYS_PERSON per2 on per2.SEQ_ID = u.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.glr
        LEFT JOIN SYS_DICT kcit3 on
        u.devchannel = kcit3.seq_id
        LEFT JOIN SYS_DICT hzly on u.nexttype = hzly.seq_id
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool =
        kcit2.seq_id
        LEFT JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        LEFT JOIN SYS_AREA
        a1 on
        u.province = a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town = a3.seq_id
        where 1=1 and u.isdelete != '1'
        <if test="queryinput != null and queryinput !='' ">
            and (${p1}or ${p2})
        </if>
        <if test="queryInputName != null and queryInputName !='' ">
            and (u.usercode like '%' + #{queryInputName} + '%'
            or u.username like '%' + #{queryInputName} + '%'
            or u.pym like '%' + #{queryInputName} + '%'
            )
        </if>
        ORDER BY u.createtime desc
    </select>
    <select id="selectWithPage" parameterType="map" resultType="json">
        select u.SEQ_ID, u.UserCode, u.UserName, u.Sex, u.BirthDay, u.Age, u.Profession, u.IDCardNo, u.PhoneNumber1,
        u.PhoneNumber2, u.guider, u.UserImpress, u.Introducer, u.PlateNumber, u.CostLevel, u.Dress,
        u.FirstWord, u.Province, u.City, u.Address, u.DevChannel, u.CreateTime, u.CreateUser, u.AskPerson, u.isdelete,
        u.organization, u.medicalhistory, u.drugllergy, u.remark, u.experience, u.habit, u.email, u.type,
        u.xueli, u.qq, u.doctor, u.important, u.nexttype, u.totalpay, u.developer, u.doorstatus, u.glr, u.glrremark,
        u.xgr, u.xgtime, u.town, u.kefu, u.usersort, u.openid, u.bindstatus, u.pym, u.integral, u.blcode, u.familyship,
        u.area,
        u.hobby, u.activity, u.introduce,u.iscreateLclj,u.clipAddress,u.area, u.hobby, u.activity, u.introduce,
        u.iscreateLclj,
        u.accepttool,u.headPic, u.photoDisplay,u.emergencyContact,u.emergencyPhone,u.barcode,p.user_name as
        createusername from KQDS_USERDOCUMENT u
        LEFT JOIN SYS_PERSON p on p.SEQ_ID = u.CreateUser
        LEFT JOIN SYS_DEPT d1 on p.DEPT_ID = d1.SEQ_ID
        LEFT JOIN
        SYS_DEPT
        d2 on d1.DEPT_PARENT = d2.SEQ_ID
        where 1=1
        <if test="username != null and username !=''">
            and (u.username like '%' + #{username} + '%' or u.pym like '%' + #{username} + '%')
        </if>
        <if test="sjhm != null and sjhm !='' ">
            and ( u.PhoneNumber1 like '%' + #{sjhm} + '%' or u.PhoneNumber2 like '%' + #{sjhm} + '%')
        </if>
        <if test="createuser != null and createuser !='' ">
            and u.createuser = #{createuser}
        </if>
        <if test="starttime != null and starttime !=''">
            and u.createtime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !=''">
            and u.createtime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="deptparentId != null and deptparentId !='' ">
            and d2.SEQ_ID = #{deptparentId}
        </if>
        <if test="deptId != null and deptId !='' ">
            and d1.SEQ_ID = #{deptId}
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and u.createuser in (${visualstaff})
        </if>
        ORDER BY u.CreateTime desc
    </select>
    <select id="selectListByBirth" parameterType="map" resultType="json">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from KQDS_USERDOCUMENT where 1=1
        <if test="month != null and month !='' ">
            and Month(Birthday) = #{month}
        </if>
        <if test="day != null and day !='' ">
            and Day(Birthday) = #{day}
        </if>
        <if test="organization != null and organization !='' ">
            and organization = #{organization}
        </if>
        ORDER BY CreateTime desc
    </select>
    <select id="getUserInfoByUserCode" parameterType="java.lang.String" resultType="json">
		select username,phonenumber1,phonenumber2 from KQDS_USERDOCUMENT where usercode =
		#{_parameter}
	</select>
    <select id="getCountJd" parameterType="map" resultType="int">
        select count(1) nums from KQDS_UserDocument where 1=1
        <if test="wdperson != null and wdperson !='' ">
            and createuser = #{wdperson}
        </if>
        <if test="starttime != null and starttime !=''">
            and createtime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !=''">
            and createtime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="usercodes != null and usercodes !=''">
            and usercode in(#{regsort})
        </if>
    </select>
    <!-- 2019-08-15 lwg 咨询统计表 -->
    <select id="getCountJdList" parameterType="map" resultType="json">
        SELECT ISNULL(a.nums, 0) as num,c.user_name,c.seq_id
        from sys_person c
        LEFT JOIN
        (select COUNT(u.CreateUser) as nums,p.SEQ_ID as seq
        from sys_person p
        LEFT JOIN KQDS_UserDocument u on u.CreateUser=p.SEQ_ID
        <if test="askitem != null and askitem != '' or accepttool != null and accepttool != '' ">
            LEFT JOIN KQDS_NET_ORDER o ON o.usercode = u.usercode
        </if>
        where 1=1
        <if test="askitem != null and askitem != '' or accepttool != null and accepttool != '' ">
            and o.isdelete!=1
        </if>
        and p.SEQ_ID IN (${visualstaff})
        <if test="organization2 != null and organization2 !='' ">
            and u.organization= #{organization2}
        </if>
        <if test="devchannel !=null and devchannel !='' ">
            and u.devchannel=#{devchannel}
        </if>
        <if test="nexttype !=null and nexttype !='' ">
            and u.nexttype=#{nexttype}
        </if>
        <if test="jdtime2!=null and jdtime2 !=''">
            and u.createtime <![CDATA[ <= ]]> #{jdtime2}
        </if>
        <if test="jdtime1!=null and jdtime1 !=''">
            and u.createtime <![CDATA[ >= ]]> #{jdtime1}
        </if>
        <if test="askitem != null and askitem != '' ">
            and o.askitem=#{askitem}
        </if>
        <if test="accepttool != null and accepttool != '' ">
            and o.accepttool=#{accepttool}
        </if>
        <!-- 		<if test="yytime2 !=null and yytime2!=''">
		AND o.createtime <![CDATA[ <= ]]> #{yytime2}
		</if>
		<if test="yytime1 !=null and yytime1!=''">
		AND o.createtime <![CDATA[ >= ]]> #{yytime1}
		</if> -->
        GROUP BY p.SEQ_ID
        <if test="askitem != null and askitem != '' ">
            ,o.askitem
        </if>
        ) as a on a.seq=c.SEQ_ID
        where 1=1
        and c.SEQ_ID IN (${visualstaff})
    </select>

    <select id="getCountJdItem" parameterType="map" resultType="int">
        select count(1) nums from KQDS_UserDocument u
        left join (select a.SEQ_ID, a.createuser, a.createtime, a.usercode, a.acceptdate, a.acceptphone, a.accepttype,
        a.accepttool,
        a.askitem, a.askperson, a.askno, a.organization, a.orderperson, a.ordertime, a.doorstatus,a.guidetime,
        a.jzxx, a.regdept, a.remark, a.username, a.daoyi, a.cjstatus, a.zxremark, a.regno, a.source, a.isdelete,
        a.askcontent from KQDS_NET_ORDER a,(select usercode,max(createtime) createtime from KQDS_NET_ORDER group by
        usercode) b
        where a.usercode=b.usercode and a.createtime=b.createtime ) n
        on n.usercode = u.usercode
        where 1=1
        <if test="wdperson != null and wdperson !='' ">
            and u.createuser = #{wdperson}
        </if>
        <if test="starttime != null and starttime !=''">
            and u.createtime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !=''">
            and u.createtime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="visualstaffwd != null and visualstaffwd !=''">
            and u.createuser in(${visualstaffwd})
        </if>
        <if test="askitem != null and askitem !='' ">
            and n.askitem = #{askitem}
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and u.createuser in(${visualstaff})
        </if>
    </select>
    <!-- 2019-08-15 lwg 录单人数(咨询项目情况统计) -->
    <select id="getCountJdItemList" parameterType="map" resultType="json">
        SELECT
        COUNT(n.askitem) as ldnums,n.askitem,p.SEQ_ID,p.USER_NAME
        FROM
        sys_person p
        LEFT JOIN KQDS_UserDocument u ON u.CreateUser = p.SEQ_ID
        left join (select a.usercode,a.askitem,a.createtime,a.accepttool,a.isdelete from KQDS_NET_ORDER a,
        (select usercode,min(createtime) createtime from KQDS_NET_ORDER group by usercode) b
        where a.usercode=b.usercode and a.createtime=b.createtime and a.isdelete!=1) n
        on n.usercode = u.usercode
        WHERE
        1 = 1
        and p.SEQ_ID IN (${visualstaff})
        <if test="organization2 != null and organization2 !='' ">
            and u.organization= #{organization2}
        </if>
        <if test="devchannel !=null and devchannel !='' ">
            and u.devchannel=#{devchannel}
        </if>
        <if test="nexttype !=null and nexttype !='' ">
            and u.nexttype=#{nexttype}
        </if>
        <if test="jdtime2!=null and jdtime2 !=''">
            and u.createtime <![CDATA[ <= ]]> #{jdtime2}
        </if>
        <if test="jdtime1!=null and jdtime1 !=''">
            and u.createtime <![CDATA[ >= ]]> #{jdtime1}
        </if>
        <if test="askitem != null and askitem != '' ">
            and n.askitem=#{askitem}
        </if>
        <if test="accepttool != null and accepttool != '' ">
            and n.accepttool=#{accepttool}
        </if>
        GROUP BY p.SEQ_ID,n.askitem,p.USER_NAME
    </select>
    <!-- 2019-08-15 lwg 咨询项目统计表 -->
    <select id="getCountJdItemStatisticsList" parameterType="map" resultType="json">
        SELECT
        COUNT(n.askitem) as ldnums,n.askitem
        FROM
        sys_person p
        LEFT JOIN KQDS_UserDocument u ON u.CreateUser = p.SEQ_ID
        left join (select a.usercode,a.askitem,a.createtime,a.accepttool,a.isdelete from KQDS_NET_ORDER a,
        (select usercode,min(createtime) createtime from KQDS_NET_ORDER group by usercode) b
        where a.usercode=b.usercode and a.createtime=b.createtime ) n
        on n.usercode = u.usercode
        WHERE
        1 = 1
        and n.isdelete!=1
        and p.SEQ_ID IN (${visualstaff})
        <if test="organization2 != null and organization2 !='' ">
            and u.organization= #{organization2}
        </if>
        <if test="devchannel !=null and devchannel !='' ">
            and u.devchannel=#{devchannel}
        </if>
        <if test="nexttype !=null and nexttype !='' ">
            and u.nexttype=#{nexttype}
        </if>
        <if test="jdtime2!=null and jdtime2 !=''">
            and u.createtime <![CDATA[ <= ]]> #{jdtime2}
        </if>
        <if test="jdtime1!=null and jdtime1 !=''">
            and u.createtime <![CDATA[ >= ]]> #{jdtime1}
        </if>
        <if test="askitem != null and askitem != '' ">
            and n.askitem=#{askitem}
        </if>
        <if test="accepttool != null and accepttool != '' ">
            and n.accepttool=#{accepttool}
        </if>
        GROUP BY n.askitem
    </select>

    <select id="selectUserInfo" parameterType="java.lang.String" resultType="json">
		select odept.dept_name as organizationname,u.usercode,p.user_name as askpersonname,p1.user_name as
		doctorname,p2.user_name as jdrname,u.username,u.sex,u.age,u.totalpay,u.remark from KQDS_USERDOCUMENT u
		LEFT JOIN SYS_PERSON p on p.SEQ_ID = u.askperson
		LEFT JOIN SYS_PERSON p1 on
		p1.SEQ_ID = u.doctor
		LEFT JOIN SYS_PERSON p2 on p2.SEQ_ID = u.createuser
		LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
		where 1=1
		and
		u.usercode = #{_parameter}
	</select>
    <select id="getHfList" parameterType="map" resultType="json">
        select p.user_name as visitorname,kcit1.dict_name as hfflname,kcit2.dict_name as mydname,
        v.SEQ_ID, v.createuser, v.createtime, v.visittime, v.visitor, v.usercode, v.username, v.sex, v.telphone,
        v.hffl, v.finishtime, v.hfyd, v.organization, v.myd, v.postperson, v.hfresult, v.status, v.regno,
        v.remark, v.purpose, v.isauto, v.isfirstday
        from KQDS_VISIT v
        LEFT JOIN SYS_DICT kcit1 on v.hffl = kcit1.seq_id
        LEFT JOIN
        SYS_PERSON p on p.SEQ_ID = v.visitor
        LEFT JOIN SYS_DICT kcit2 on v.myd = kcit2.seq_id
        where 1=1
        and v.visitor in (${visualstaff})
        <if test="organization != null and organization !='' ">
            and v.organization = #{organization}
        </if>
        <if test="visittime != null and visittime !='' ">
            ${visittime}
        </if>
        order by v.visittime desc
    </select>
    <select id="getHfListByUsercode" parameterType="map" resultType="json">
		select p.user_name as visitorname,kcit1.dict_name as hfflname,kcit2.dict_name as mydname,
		v.SEQ_ID, v.createuser, v.createtime, v.visittime, v.visitor, v.usercode, v.username, v.sex, v.telphone,
		v.hffl, v.finishtime, v.hfyd, v.organization, v.myd, v.postperson, v.hfresult, v.status, v.regno,
		v.remark, v.purpose, v.isauto, v.isfirstday
		from KQDS_VISIT v
		LEFT JOIN SYS_DICT kcit1 on v.hffl = kcit1.seq_id
		LEFT JOIN SYS_PERSON p on p.SEQ_ID = v.visitor
		LEFT JOIN SYS_DICT kcit2 on v.myd = kcit2.seq_id
		where 1=1
		and v.usercode =#{usercode}
		and v.organization = #{organization}
		order by v.visittime desc
	</select>

    <!-- 添加判断该患者是否创建临床路径 -->
    <update id="isCreateLclj" parameterType="java.util.Map">
        update KQDS_USERDOCUMENT
        <set>
            <if test="iscreateLclj = null and iscreateLclj =''">
                iscreateLclj = '1'
            </if>
        </set>
        where SEQ_ID = #{seqId}
    </update>

    <!-- 获取当前患者介绍他人的数量  2019-8-21   syp -->
    <select id="findIntroducerNum" parameterType="String" resultType="int">
		select count(Introducer) from KQDS_USERDOCUMENT where Introducer = #{usercode}
	</select>

    <select id="findKqdsUserdocumentByUsercodes" parameterType="String" resultType="json">
		select
		SEQ_ID,UserCode,UserName,Sex,BirthDay,Age,Profession,IDCardNo,PhoneNumber1,PhoneNumber2,guider,
		UserImpress,Introducer,PlateNumber,CostLevel,Dress,FirstWord,Province,City,Address,
		CreateTime,CreateUser,isdelete,organization,medicalhistory,drugllergy,remark,experience,habit,
		email,xueli,qq,doctor,important,totalpay,developer,barcode,doorstatus,glr,glrremark,
		xgr,xgtime,town,usersort,openid,bindstatus,pym,integral,blcode,iscreateLclj,familyship,
		area,hobby,activity,introduce,invoice
		from KQDS_USERDOCUMENT where UserCode in (${_parameter})
	</select>

    <update id="updateUserdocumentInvoiceByUsercode" parameterType="java.lang.String">
	update KQDS_USERDOCUMENT set invoice=1 where usercode=#{usercode}
	</update>

    <!-- 渠道 -->
    <select id="findDevchannel" parameterType="map" resultType="json">
        SELECT
        devchannelname,
        SUM (paymoney) AS paymoney
        FROM
        (
        SELECT
        d.dict_name AS devchannelname,
        (
        p.actualmoney - (
        SELECT
        ISNULL(
        SUM (
        paymoney - payyjj - payother2 - payintegral - paydjq
        ),
        0
        ) AS paymoney
        FROM
        KQDS_COSTORDER_DETAIL
        WHERE
        1 = 1
        AND itemname IN (
        SELECT
        treatitemname
        FROM
        KQDS_TREATITEM
        WHERE
        basetype = 'jyk671'
        AND nexttype = 'b87aa149-a257-4b00-8fad-2c9b331af38e'
        )
        AND costno = p.costno
        ) - (
        SELECT
        ISNULL(
        SUM (
        paymoney - payyjj - payother2 - payintegral - paydjq
        ),
        0
        ) AS paymoney
        FROM
        KQDS_COSTORDER_DETAIL
        WHERE
        1 = 1
        AND isyjjitem = 1
        AND costno = p.costno
        )
        ) paymoney,
        p.costno AS costno
        FROM
        KQDS_REG r
        LEFT JOIN KQDS_PAYCOST p ON r.seq_id = p.regno
        LEFT JOIN KQDS_COSTORDER cost ON p.costno = cost.costno
        LEFT JOIN KQDS_UserDocument u ON u.UserCode = p.usercode
        LEFT JOIN sys_dict d ON u.DevChannel = d.SEQ_ID
        WHERE
        1 = 1
        <if test="years != null and years != ''">
            AND (${years})
        </if>
        AND MONTH (r.createtime) <![CDATA[ >= ]]> #{startmonth}
        AND MONTH (r.createtime) <![CDATA[ <= ]]> #{endmonth}
        AND r.organization = #{organization}
        AND r.cjstatus = 1
        AND cost.isdrugs = 0
        AND r.askperson IN (${askperson})
        GROUP BY
        d.dict_name,
        p.actualmoney,
        p.costno
        ) AS detail
        GROUP BY
        devchannelname
    </select>

    <!-- 总 -->
    <select id="findDevchannelAll" parameterType="map" resultType="json">
        SELECT
        SUM (paymoney) AS paymoney
        FROM
        (
        SELECT
        d.dict_name AS devchannelname,
        (
        p.actualmoney - (
        SELECT
        ISNULL(
        SUM (
        paymoney - payyjj - payother2 - payintegral - paydjq
        ),
        0
        ) AS paymoney
        FROM
        KQDS_COSTORDER_DETAIL
        WHERE
        1 = 1
        AND itemname IN (
        SELECT
        treatitemname
        FROM
        KQDS_TREATITEM
        WHERE
        basetype = 'jyk671'
        AND nexttype = 'b87aa149-a257-4b00-8fad-2c9b331af38e'
        )
        AND costno = p.costno
        ) - (
        SELECT
        ISNULL(
        SUM (
        paymoney - payyjj - payother2 - payintegral - paydjq
        ),
        0
        ) AS paymoney
        FROM
        KQDS_COSTORDER_DETAIL
        WHERE
        1 = 1
        AND isyjjitem = 1
        AND costno = p.costno
        )
        ) paymoney,
        p.costno AS costno
        FROM
        KQDS_REG r
        LEFT JOIN KQDS_PAYCOST p ON r.seq_id = p.regno
        LEFT JOIN KQDS_COSTORDER cost ON p.costno = cost.costno
        LEFT JOIN KQDS_UserDocument u ON u.UserCode = p.usercode
        LEFT JOIN sys_dict d ON u.DevChannel = d.SEQ_ID
        WHERE
        1 = 1
        <if test="years != null and years != ''">
            AND (${years})
        </if>
        AND MONTH (r.createtime) <![CDATA[ >= ]]> #{startmonth}
        AND MONTH (r.createtime) <![CDATA[ <= ]]> #{endmonth}
        AND r.organization = #{organization}
        AND r.cjstatus = 1
        AND cost.isdrugs = 0
        AND r.askperson IN (${askperson})
        GROUP BY
        d.dict_name,
        p.actualmoney,
        p.costno
        ) AS detail
    </select>

    <select id="findConsumptionInterval" parameterType="map" resultType="json">
        SELECT
        COUNT (*) AS num
        FROM
        (
        SELECT
        usercode,
        SUM (paymoney) paymoney
        FROM
        (
        SELECT
        r.usercode AS usercode,
        (
        p.actualmoney - (
        SELECT
        ISNULL(
        SUM (
        paymoney - payyjj - payother2 - payintegral - paydjq
        ),
        0
        ) AS paymoney
        FROM
        KQDS_COSTORDER_DETAIL
        WHERE
        1 = 1
        AND itemname IN (
        SELECT
        treatitemname
        FROM
        KQDS_TREATITEM
        WHERE
        basetype = 'jyk671'
        AND nexttype = 'b87aa149-a257-4b00-8fad-2c9b331af38e'
        )
        AND costno = p.costno
        ) - (
        SELECT
        ISNULL(
        SUM (
        paymoney - payyjj - payother2 - payintegral - paydjq
        ),
        0
        ) AS paymoney
        FROM
        KQDS_COSTORDER_DETAIL
        WHERE
        1 = 1
        AND isyjjitem = 1
        AND costno = p.costno
        )
        ) paymoney,
        p.costno AS costno
        FROM
        KQDS_REG r
        LEFT JOIN KQDS_PAYCOST p ON r.seq_id = p.regno
        LEFT JOIN KQDS_COSTORDER cost ON p.costno = cost.costno
        WHERE
        1 = 1
        AND MONTH (r.createtime) <![CDATA[ >= ]]> #{startmonth}
        AND MONTH (r.createtime) <![CDATA[ <= ]]> #{endmonth}
        <if test="years != null and years != ''">
            AND (${years})
        </if>
        AND r.organization = 'HUDH'
        AND r.cjstatus = 1
        AND cost.isdrugs = 0
        AND r.askperson IN (${askperson})
        GROUP BY
        r.usercode,
        p.actualmoney,
        p.costno
        ) AS detail
        GROUP BY
        usercode
        ) AS cost
        WHERE
        paymoney <![CDATA[ >= ]]> #{start}
        AND paymoney <![CDATA[ <= ]]> #{end}
    </select>

    <select id="findOrganizationBySeqid" parameterType="java.lang.String" resultType="java.lang.String">
		select
		organization
		from KQDS_UserDocument
		where SEQ_ID = #{seqId,jdbcType=VARCHAR}
	</select>
    <!-- 根据患者编号查询地址 -->
    <select id="findAreaByUsercode" parameterType="java.util.Map" resultType="json">
		select
		u.usercode,
		a1.area_name as provincename,
		a2.area_name as cityname,
		a3.area_name as townname,
		p.PROVINCE_NAME,
		c.CITY_NAME,
		a.AREA_NAME,
		s.STREET_NAME
		from KQDS_UserDocument u
		LEFT JOIN SYS_AREA a1 on u.province = a1.seq_id
		LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
		LEFT JOIN SYS_AREA a3 on u.town = a3.seq_id
		left join bs_province p on p.PROVINCE_CODE = u.province
		left join bs_city c on c.CITY_CODE = u.city
		left join bs_area a on a.AREA_CODE = u.area
		left join bs_street s on s.STREET_CODE = u.town
		where u.usercode in (${usercode})
	</select>
    <!-- 接诊查询,查询名字 -->
    <select id="findNameByUsercode" parameterType="java.util.Map" resultType="json">
		select
		u.usercode,
		per3.USER_NAME as jdr,
		per4.USER_NAME as jddy,
		per7.USER_NAME as faskperson,
		per8.USER_NAME as developername,
		kcit3.dict_name as devchannel,
		hzly.dict_name as nexttype,
		kcit7.dict_name as slgj
		from KQDS_UserDocument u
		LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = u.createuser
		LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.guider
		LEFT JOIN SYS_PERSON per7 on per7.SEQ_ID = u.askperson
		LEFT JOIN SYS_PERSON per8 on per8.SEQ_ID = u.developer
		LEFT JOIN SYS_DICT kcit3 on kcit3.seq_id = u.devchannel
		LEFT JOIN SYS_DICT hzly on hzly.seq_id = u.nexttype
		LEFT JOIN sys_dict kcit7 ON kcit7.SEQ_ID=u.accepttool
		where u.usercode in (${usercode})
	</select>

    <insert id="batchSaveUserDocument" parameterType="java.util.List">
        insert into KQDS_UserDocument
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="seqId != null">
                SEQ_ID,
            </if>
            <if test="usercode != null">
                UserCode,
            </if>
            <if test="username != null">
                UserName,
            </if>
            <if test="sex != null">
                Sex,
            </if>
            <if test="birthday != null">
                BirthDay,
            </if>
            <if test="age != null">
                Age,
            </if>
            <if test="profession != null">
                Profession,
            </if>
            <if test="idcardno != null">
                IDCardNo,
            </if>
            <if test="phonenumber1 != null">
                PhoneNumber1,
            </if>
            <if test="phonenumber2 != null">
                PhoneNumber2,
            </if>
            <if test="guider != null">
                guider,
            </if>
            <if test="userimpress != null">
                UserImpress,
            </if>
            <if test="introducer != null">
                Introducer,
            </if>
            <if test="platenumber != null">
                PlateNumber,
            </if>
            <if test="costlevel != null">
                CostLevel,
            </if>
            <if test="dress != null">
                Dress,
            </if>
            <if test="firstword != null">
                FirstWord,
            </if>
            <if test="province != null">
                Province,
            </if>
            <if test="city != null">
                City,
            </if>
            <if test="address != null">
                Address,
            </if>
            <if test="devchannel != null">
                DevChannel,
            </if>
            <if test="createtime != null">
                CreateTime,
            </if>
            <if test="createuser != null">
                CreateUser,
            </if>
            <if test="askperson != null">
                AskPerson,
            </if>
            <if test="isdelete != null">
                isdelete,
            </if>
            <if test="organization != null">
                organization,
            </if>
            <if test="medicalhistory != null">
                medicalhistory,
            </if>
            <if test="drugllergy != null">
                drugllergy,
            </if>
            <if test="remark != null">
                remark,
            </if>
            <if test="experience != null">
                experience,
            </if>
            <if test="habit != null">
                habit,
            </if>
            <if test="email != null">
                email,
            </if>
            <if test="type != null">
                type,
            </if>
            <if test="xueli != null">
                xueli,
            </if>
            <if test="qq != null">
                qq,
            </if>
            <if test="doctor != null">
                doctor,
            </if>
            <if test="important != null">
                important,
            </if>
            <if test="nexttype != null">
                nexttype,
            </if>
            <if test="totalpay != null">
                totalpay,
            </if>
            <if test="developer != null">
                developer,
            </if>
            <if test="doorstatus != null">
                doorstatus,
            </if>
            <if test="glr != null">
                glr,
            </if>
            <if test="glrremark != null">
                glrremark,
            </if>
            <if test="xgr != null">
                xgr,
            </if>
            <if test="xgtime != null">
                xgtime,
            </if>
            <if test="town != null">
                town,
            </if>
            <if test="kefu != null">
                kefu,
            </if>
            <if test="usersort != null">
                usersort,
            </if>
            <if test="openid != null">
                openid,
            </if>
            <if test="bindstatus != null">
                bindstatus,
            </if>
            <if test="pym != null">
                pym,
            </if>
            <if test="integral != null">
                integral,
            </if>
            <if test="blcode != null">
                blcode,
            </if>
            <if test="barcode != null">
                barcode,
            </if>
            <if test="familyship != null">
                familyship,
            </if>
            <if test="area != null">
                area,
            </if>
            <if test="hobby != null">
                hobby,
            </if>
            <if test="activity != null">
                activity,
            </if>
            <if test="introduce != null">
                introduce,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="seqId != null">
                #{seqId,jdbcType=VARCHAR},
            </if>
            <if test="usercode != null">
                #{usercode,jdbcType=VARCHAR},
            </if>
            <if test="username != null">
                #{username,jdbcType=VARCHAR},
            </if>
            <if test="sex != null">
                #{sex,jdbcType=VARCHAR},
            </if>
            <if test="birthday != null">
                #{birthday,jdbcType=VARCHAR},
            </if>
            <if test="age != null">
                #{age,jdbcType=INTEGER},
            </if>
            <if test="profession != null">
                #{profession,jdbcType=VARCHAR},
            </if>
            <if test="idcardno != null">
                #{idcardno,jdbcType=VARCHAR},
            </if>
            <if test="phonenumber1 != null">
                #{phonenumber1,jdbcType=VARCHAR},
            </if>
            <if test="phonenumber2 != null">
                #{phonenumber2,jdbcType=VARCHAR},
            </if>
            <if test="guider != null">
                #{guider,jdbcType=VARCHAR},
            </if>
            <if test="userimpress != null">
                #{userimpress,jdbcType=VARCHAR},
            </if>
            <if test="introducer != null">
                #{introducer,jdbcType=VARCHAR},
            </if>
            <if test="platenumber != null">
                #{platenumber,jdbcType=VARCHAR},
            </if>
            <if test="costlevel != null">
                #{costlevel,jdbcType=VARCHAR},
            </if>
            <if test="dress != null">
                #{dress,jdbcType=VARCHAR},
            </if>
            <if test="firstword != null">
                #{firstword,jdbcType=VARCHAR},
            </if>
            <if test="province != null">
                #{province,jdbcType=VARCHAR},
            </if>
            <if test="city != null">
                #{city,jdbcType=VARCHAR},
            </if>
            <if test="address != null">
                #{address,jdbcType=VARCHAR},
            </if>
            <if test="devchannel != null">
                #{devchannel,jdbcType=VARCHAR},
            </if>
            <if test="createtime != null">
                #{createtime,jdbcType=VARCHAR},
            </if>
            <if test="createuser != null">
                #{createuser,jdbcType=VARCHAR},
            </if>
            <if test="askperson != null">
                #{askperson,jdbcType=VARCHAR},
            </if>
            <if test="isdelete != null">
                #{isdelete,jdbcType=INTEGER},
            </if>
            <if test="organization != null">
                #{organization,jdbcType=VARCHAR},
            </if>
            <if test="medicalhistory != null">
                #{medicalhistory,jdbcType=VARCHAR},
            </if>
            <if test="drugllergy != null">
                #{drugllergy,jdbcType=VARCHAR},
            </if>
            <if test="remark != null">
                #{remark,jdbcType=VARCHAR},
            </if>
            <if test="experience != null">
                #{experience,jdbcType=VARCHAR},
            </if>
            <if test="habit != null">
                #{habit,jdbcType=VARCHAR},
            </if>
            <if test="email != null">
                #{email,jdbcType=VARCHAR},
            </if>
            <if test="type != null">
                #{type,jdbcType=INTEGER},
            </if>
            <if test="xueli != null">
                #{xueli,jdbcType=VARCHAR},
            </if>
            <if test="qq != null">
                #{qq,jdbcType=VARCHAR},
            </if>
            <if test="doctor != null">
                #{doctor,jdbcType=VARCHAR},
            </if>
            <if test="important != null">
                #{important,jdbcType=VARCHAR},
            </if>
            <if test="nexttype != null">
                #{nexttype,jdbcType=VARCHAR},
            </if>
            <if test="totalpay != null">
                #{totalpay,jdbcType=DECIMAL},
            </if>
            <if test="developer != null">
                #{developer,jdbcType=VARCHAR},
            </if>
            <if test="doorstatus != null">
                #{doorstatus,jdbcType=INTEGER},
            </if>
            <if test="glr != null">
                #{glr,jdbcType=VARCHAR},
            </if>
            <if test="glrremark != null">
                #{glrremark,jdbcType=VARCHAR},
            </if>
            <if test="xgr != null">
                #{xgr,jdbcType=VARCHAR},
            </if>
            <if test="xgtime != null">
                #{xgtime,jdbcType=VARCHAR},
            </if>
            <if test="town != null">
                #{town,jdbcType=VARCHAR},
            </if>
            <if test="kefu != null">
                #{kefu,jdbcType=VARCHAR},
            </if>
            <if test="usersort != null">
                #{usersort,jdbcType=VARCHAR},
            </if>
            <if test="openid != null">
                #{openid,jdbcType=VARCHAR},
            </if>
            <if test="bindstatus != null">
                #{bindstatus,jdbcType=VARCHAR},
            </if>
            <if test="pym != null">
                #{pym,jdbcType=VARCHAR},
            </if>
            <if test="integral != null">
                #{integral,jdbcType=DECIMAL},
            </if>
            <if test="blcode != null">
                #{blcode,jdbcType=VARCHAR},
            </if>
            <if test="barcode != null">
                #{barcode,jdbcType=CLOB},
            </if>
            <if test="familyship != null">
                #{familyship,jdbcType=VARCHAR},
            </if>
            <if test="area != null">
                #{area,jdbcType=VARCHAR},
            </if>
            <if test="hobby != null">
                #{hobby,jdbcType=VARCHAR},
            </if>
            <if test="activity != null">
                #{activity,jdbcType=VARCHAR},
            </if>
            <if test="introduce != null">
                #{introduce,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateBlcode" parameterType="java.util.Map">
		update KQDS_UserDocument set blcode=#{blcode} where usercode=#{usercode}
	</update>
    <!-- 信息查询，根据患者编号查询名字 -->
    <select id="findXxcxNameByUsercode" parameterType="java.util.Map" resultType="json">
		select
		u.usercode,
		per4.user_name as CreateUser,
		per2.user_name as askperson,
		per1.user_name as doctor,
		okdi1.dict_name as devchannelname,
		hztype.dict_name as nexttypename
		from KQDS_UserDocument u
		left join SYS_PERSON per1 on per1.seq_id = u.doctor
		left join SYS_PERSON per2 on per2.seq_id = u.askperson
		left join SYS_PERSON per4 on per4.seq_id = u.createuser
		left join SYS_DICT okdi1 on okdi1.seq_id = u.devchannel
		left join SYS_DICT hztype on hztype.seq_id = u.nexttype
		where u.usercode in (${usercode})
	</select>
    <select id="selectWithNopage3" parameterType="map" resultType="json">
        <bind name="temp_dbType" value="${system_dbType}"/>
        select (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) as ywhf,
        u.createtime,
        a1.area_name as provincename,
        a2.area_name as cityname,
        a3.area_name as
        townname,
        <!-- <if test="temp_dbType == 0">
			(select CreateTime from KQDS_REG reg where reg.usercode=u.UserCode ORDER BY CreateTime desc limit 0,1) as lasttime,
		</if>
		<if test="temp_dbType == 1">
			(select top 1 CreateTime from KQDS_REG reg where reg.usercode=u.UserCode ORDER BY CreateTime desc) as lasttime,
		</if> -->
        per4.user_name as CreateUser,
        u.seq_id,
        u.username,
        u.iscreatelclj,
        u.usercode,
        u.doorstatus,
        u.sex,
        u.age,u.blcode,
        per2.user_name as askperson,
        per1.user_name as doctor,
        per3.user_name as developer,
        u.phonenumber1,
        u.phonenumber2,
        u.devchannel,
        u.nexttype,
        u.city,
        u.province,
        u.openid,
        u.bindstatus,
        okdi1.dict_name as devchannelname,
        hztype.dict_name as nexttypename,
        reg.createtime as regcreatetime,
        p.PROVINCE_NAME,
        c.CITY_NAME,
        a.AREA_NAME,
        s.STREET_NAME
        from KQDS_USERDOCUMENT as u
        left join (
        <!-- select a.* from KQDS_REG a,(select usercode,max(createtime) createtime from
		KQDS_REG group by usercode) b where a.usercode=b.usercode and
		a.createtime=b.createtime -->
        select createtime,usercode from KQDS_REG where recesort = '20') reg on reg.usercode=u.usercode
        left join SYS_DICT okdi1 on okdi1.seq_id = u.devchannel
        left join SYS_DICT hztype on hztype.seq_id = u.nexttype
        left join SYS_PERSON per1 on per1.seq_id = u.doctor
        left join SYS_PERSON per2 on per2.seq_id = u.askperson
        left join SYS_PERSON per3 on per3.seq_id = u.developer
        left join SYS_PERSON per4 on per4.seq_id = u.createuser
        LEFT JOIN SYS_AREA a1 on u.province = a1.seq_id
        LEFT JOIN SYS_AREA a2 on u.city = a2.seq_id
        LEFT JOIN SYS_AREA a3 on u.town = a3.seq_id
        left join bs_province p on p.PROVINCE_CODE = u.province
        left join bs_city c on c.CITY_CODE = u.city
        left join bs_area a on a.AREA_CODE = u.area
        left join bs_street s on s.STREET_CODE = u.town
        where 1=1
        and u.organization = #{organization}
        <if test="bindWX != null and bindWX !='' ">
            <if test='bindWX == "1"'>
                and (u.openid is not null and u.openid != '' and u.bindstatus = 0)
            </if>
            <if test='bindWX == "0"'>
                and (u.openid is null or u.openid = '' or u.bindstatus != 0)
            </if>
        </if>
        <if test="starttime != null and starttime !=''">
            and u.createtime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !=''">
            and u.createtime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="username != null and username !=''">
            and (u.usercode like '%' + #{username} + '%'
            or u.username like '%' + #{username} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{username} + '%'
            or u.blcode like '%' +
            #{username} + '%'
            )
        </if>
        <if test="ywhf != null and ywhf !='' ">
            <if test='ywhf == "0"'>
                and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) = 0
            </if>
            <if test='ywhf != "0"'>
                and (select count(v.usercode) from KQDS_Visit v where v.usercode=u.UserCode) > 0
            </if>
        </if>
        <!-- <if test="dystarttime != null and dystarttime !='' ">
			and (${subsql}) <![CDATA[ >= ]]>
			#{dystarttime}
		</if>
		<if test="dyendtime != null and dyendtime !='' ">
			and (${subsql}) <![CDATA[ <= ]]>
			#{dyendtime}
		</if> -->
        <if test="dystarttime != null and dystarttime !='' ">
            and (reg.createtime) <![CDATA[ >= ]]>
            #{dystarttime}
        </if>
        <if test="dyendtime != null and dyendtime !='' ">
            and (reg.createtime) <![CDATA[ <= ]]>
            #{dyendtime}
        </if>
        <if test="usercodes != null and usercodes !=''">
            and u.usercode in (${usercodes})
        </if>
        <if test="developer != null and developer !='' ">
            and u.developer = #{developer}
        </if>
        <if test="createuser != null and createuser !='' ">
            and u.createuser = #{createuser}
        </if>
        <if test="city != null and city !='' ">
            and u.city = #{city}
        </if>
        <if test="province != null and province !='' ">
            and u.province = #{province}
        </if>
        <if test="nexttype != null and nexttype !='' ">
            and u.nexttype = #{nexttype}
        </if>
        <if test="devchannel != null and devchannel !='' ">
            and u.devchannel = #{devchannel}
        </if>
        <if test="doctor != null and doctor !='' ">
            and u.doctor = #{doctor}
        </if>
        <if test="askperson != null and askperson !='' ">
            and u.askperson = #{askperson}
        </if>
        <if test="isdelete != null and isdelete !='' ">
            and u.isdelete = #{isdelete}
        </if>
        <if test="type != null and type !='' ">
            and u.type = #{type}
        </if>
        <!-- 2019-3-10 修改信息查询页面可以查询到所有患者，去掉此处的权限校验 -->
        <if test="visualstaff != null and visualstaff !='' ">
            and (
            u.askperson in (${visualstaff}) or u.createuser in (${visualstaff}) or u.doctor in (${visualstaff})
            or EXISTS (select usercode from KQDS_COSTORDER_DETAIL where u.usercode=usercode AND (askperson in(
            ${visualstaff}) or doctor in (${visualstaff})))
            or EXISTS (select usercode from KQDS_REG where u.usercode=usercode AND (askperson in( ${visualstaff}) or
            doctor in (${visualstaff})))
            )
        </if>
        <if test="sortName != null and sortName != '' ">
            ORDER BY ${sortName} ${sortOrder}
        </if>
        <if test="sortName == null">
            ORDER BY u.CreateTime desc
        </if>
    </select>
    <select id="getSsjeReg1" parameterType="java.util.List" resultType="json">
        select sum(detail.paymoney)as paymoney,
        sum(detail.payother2) as zs,
        sum(detail.paydjq) as djq,
        sum(detail.payintegral) as integral,
        cost.regno as regno
        from KQDS_COSTORDER_DETAIL detail
        LEFT JOIN KQDS_COSTORDER cost on cost.costno = detail.costno
        where 1=1
        and cost.status = 2 and cost.regno in
        <foreach item="item" index="index" collection="list" open="(" separator="," close=")">
            #{item}
        </foreach>
        and detail.isyjjitem != 1
        GROUP BY cost.regno
    </select>
    <select id="findByUsercode" parameterType="java.lang.String" resultType="json">
		select UserName, Sex, PhoneNumber1, PhoneNumber2, Age , kefu from KQDS_UserDocument where UserCode=#{usercode}
	</select>

    <update id="updaterecord" parameterType="com.kqds.entity.base.KqdsUserdocument">
        UPDATE KQDS_UserDocument set contagion = #{contagion} where usercode = #{usercode}
    </update>

    <select id="getrecord" parameterType="java.lang.String" resultType="json">
        SELECT contagion FROM KQDS_UserDocument WHERE usercode = #{usercode}
    </select>
</mapper>