<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="KQDS_NET_ORDER">

    <resultMap id="BaseResultMap" type="com.kqds.entity.base.KqdsNetOrder">
        <id column="SEQ_ID" jdbcType="VARCHAR" property="seqId"/>
        <result column="createuser" jdbcType="VARCHAR" property="createuser"/>
        <result column="createtime" jdbcType="VARCHAR" property="createtime"/>
        <result column="usercode" jdbcType="VARCHAR" property="usercode"/>
        <result column="acceptdate" jdbcType="VARCHAR" property="acceptdate"/>
        <result column="acceptphone" jdbcType="VARCHAR" property="acceptphone"/>
        <result column="accepttype" jdbcType="VARCHAR" property="accepttype"/>
        <result column="accepttool" jdbcType="VARCHAR" property="accepttool"/>
        <result column="askitem" jdbcType="VARCHAR" property="askitem"/>
        <result column="askperson" jdbcType="VARCHAR" property="askperson"/>
        <result column="askno" jdbcType="VARCHAR" property="askno"/>
        <result column="organization" jdbcType="VARCHAR" property="organization"/>
        <result column="orderperson" jdbcType="VARCHAR" property="orderperson"/>
        <result column="ordertime" jdbcType="VARCHAR" property="ordertime"/>
        <result column="doorstatus" jdbcType="INTEGER" property="doorstatus"/>
        <result column="guidetime" jdbcType="VARCHAR" property="guidetime"/>
        <result column="jzxx" jdbcType="VARCHAR" property="jzxx"/>
        <result column="regdept" jdbcType="VARCHAR" property="regdept"/>
        <result column="remark" jdbcType="VARCHAR" property="remark"/>
        <result column="username" jdbcType="VARCHAR" property="username"/>
        <result column="daoyi" jdbcType="VARCHAR" property="daoyi"/>
        <result column="cjstatus" jdbcType="INTEGER" property="cjstatus"/>
        <result column="zxremark" jdbcType="VARCHAR" property="zxremark"/>
        <result column="regno" jdbcType="VARCHAR" property="regno"/>
        <result column="source" jdbcType="VARCHAR" property="source"/>
        <result column="isdelete" jdbcType="INTEGER" property="isdelete"/>
    </resultMap>
    <resultMap extends="BaseResultMap" id="ResultMapWithBLOBs" type="com.kqds.entity.base.KqdsNetOrder">
        <result column="askcontent" jdbcType="CLOB" property="askcontent"/>
    </resultMap>
    <sql id="Base_Column_List">
		SEQ_ID, createuser, createtime, usercode, acceptdate, acceptphone, accepttype, accepttool,
		askitem, askperson, askno, organization, orderperson, ordertime, doorstatus,
		guidetime,
		jzxx, regdept, remark, username, daoyi, cjstatus, zxremark, regno, source, isdelete
	</sql>
    <sql id="Blob_Column_List">
		askcontent
	</sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="ResultMapWithBLOBs">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from KQDS_NET_ORDER
        where SEQ_ID = #{seqId,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
		delete from KQDS_NET_ORDER
		where SEQ_ID = #{seqId,jdbcType=VARCHAR}
	</delete>
    <insert id="insert" parameterType="com.kqds.entity.base.KqdsNetOrder">
		insert into KQDS_NET_ORDER (SEQ_ID, createuser, createtime,
		usercode, acceptdate, acceptphone,
		accepttype, accepttool, askitem,
		askperson,
		askno, organization,
		orderperson, ordertime, doorstatus,
		guidetime, jzxx, regdept,
		remark, username, daoyi,
		cjstatus, zxremark, regno,
		source, isdelete, askcontent
		)
		values
		(#{seqId,jdbcType=VARCHAR}, #{createuser,jdbcType=VARCHAR}, #{createtime,jdbcType=VARCHAR},
		#{usercode,jdbcType=VARCHAR}, #{acceptdate,jdbcType=VARCHAR},
		#{acceptphone,jdbcType=VARCHAR},
		#{accepttype,jdbcType=VARCHAR}, #{accepttool,jdbcType=VARCHAR}, #{askitem,jdbcType=VARCHAR},
		#{askperson,jdbcType=VARCHAR},
		#{askno,jdbcType=VARCHAR}, #{organization,jdbcType=VARCHAR},
		#{orderperson,jdbcType=VARCHAR}, #{ordertime,jdbcType=VARCHAR}, #{doorstatus,jdbcType=INTEGER},
		#{guidetime,jdbcType=VARCHAR}, #{jzxx,jdbcType=VARCHAR}, #{regdept,jdbcType=VARCHAR},
		#{remark,jdbcType=VARCHAR}, #{username,jdbcType=VARCHAR}, #{daoyi,jdbcType=VARCHAR},
		#{cjstatus,jdbcType=INTEGER}, #{zxremark,jdbcType=VARCHAR}, #{regno,jdbcType=VARCHAR},
		#{source,jdbcType=VARCHAR}, #{isdelete,jdbcType=INTEGER}, #{askcontent,jdbcType=CLOB}
		)
	</insert>
    <insert id="insertSelective" parameterType="com.kqds.entity.base.KqdsNetOrder">
        insert into KQDS_NET_ORDER
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="seqId != null">
                SEQ_ID,
            </if>
            <if test="createuser != null">
                createuser,
            </if>
            <if test="createtime != null">
                createtime,
            </if>
            <if test="usercode != null">
                usercode,
            </if>
            <if test="acceptdate != null">
                acceptdate,
            </if>
            <if test="acceptphone != null">
                acceptphone,
            </if>
            <if test="accepttype != null">
                accepttype,
            </if>
            <if test="accepttool != null">
                accepttool,
            </if>
            <if test="askitem != null">
                askitem,
            </if>
            <if test="askperson != null">
                askperson,
            </if>
            <if test="askno != null">
                askno,
            </if>
            <if test="organization != null">
                organization,
            </if>
            <if test="orderperson != null">
                orderperson,
            </if>
            <if test="ordertime != null">
                ordertime,
            </if>
            <if test="doorstatus != null">
                doorstatus,
            </if>
            <if test="guidetime != null">
                guidetime,
            </if>
            <if test="jzxx != null">
                jzxx,
            </if>
            <if test="regdept != null">
                regdept,
            </if>
            <if test="remark != null">
                remark,
            </if>
            <if test="username != null">
                username,
            </if>
            <if test="daoyi != null">
                daoyi,
            </if>
            <if test="cjstatus != null">
                cjstatus,
            </if>
            <if test="zxremark != null">
                zxremark,
            </if>
            <if test="regno != null">
                regno,
            </if>
            <if test="source != null">
                source,
            </if>
            <if test="isdelete != null">
                isdelete,
            </if>
            <if test="askcontent != null">
                askcontent,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="seqId != null">
                #{seqId,jdbcType=VARCHAR},
            </if>
            <if test="createuser != null">
                #{createuser,jdbcType=VARCHAR},
            </if>
            <if test="createtime != null">
                #{createtime,jdbcType=VARCHAR},
            </if>
            <if test="usercode != null">
                #{usercode,jdbcType=VARCHAR},
            </if>
            <if test="acceptdate != null">
                #{acceptdate,jdbcType=VARCHAR},
            </if>
            <if test="acceptphone != null">
                #{acceptphone,jdbcType=VARCHAR},
            </if>
            <if test="accepttype != null">
                #{accepttype,jdbcType=VARCHAR},
            </if>
            <if test="accepttool != null">
                #{accepttool,jdbcType=VARCHAR},
            </if>
            <if test="askitem != null">
                #{askitem,jdbcType=VARCHAR},
            </if>
            <if test="askperson != null">
                #{askperson,jdbcType=VARCHAR},
            </if>
            <if test="askno != null">
                #{askno,jdbcType=VARCHAR},
            </if>
            <if test="organization != null">
                #{organization,jdbcType=VARCHAR},
            </if>
            <if test="orderperson != null">
                #{orderperson,jdbcType=VARCHAR},
            </if>
            <if test="ordertime != null">
                #{ordertime,jdbcType=VARCHAR},
            </if>
            <if test="doorstatus != null">
                #{doorstatus,jdbcType=INTEGER},
            </if>
            <if test="guidetime != null">
                #{guidetime,jdbcType=VARCHAR},
            </if>
            <if test="jzxx != null">
                #{jzxx,jdbcType=VARCHAR},
            </if>
            <if test="regdept != null">
                #{regdept,jdbcType=VARCHAR},
            </if>
            <if test="remark != null">
                #{remark,jdbcType=VARCHAR},
            </if>
            <if test="username != null">
                #{username,jdbcType=VARCHAR},
            </if>
            <if test="daoyi != null">
                #{daoyi,jdbcType=VARCHAR},
            </if>
            <if test="cjstatus != null">
                #{cjstatus,jdbcType=INTEGER},
            </if>
            <if test="zxremark != null">
                #{zxremark,jdbcType=VARCHAR},
            </if>
            <if test="regno != null">
                #{regno,jdbcType=VARCHAR},
            </if>
            <if test="source != null">
                #{source,jdbcType=VARCHAR},
            </if>
            <if test="isdelete != null">
                #{isdelete,jdbcType=INTEGER},
            </if>
            <if test="askcontent != null">
                #{askcontent,jdbcType=CLOB},
            </if>
        </trim>
    </insert>

    <update id="updateIsdeleteById">
        update KQDS_NET_ORDER
        <set>
            <if test="isdelete != null">
                isdelete = #{isdelete,jdbcType=INTEGER},
            </if>
        </set>
        where SEQ_ID = #{seqId,jdbcType=VARCHAR}
    </update>

    <update id="updateByPrimaryKeySelective" parameterType="com.kqds.entity.base.KqdsNetOrder">
        update KQDS_NET_ORDER
        <set>
            <if test="createuser != null">
                createuser = #{createuser,jdbcType=VARCHAR},
            </if>
            <if test="createtime != null">
                createtime = #{createtime,jdbcType=VARCHAR},
            </if>
            <if test="usercode != null">
                usercode = #{usercode,jdbcType=VARCHAR},
            </if>
            <if test="acceptdate != null">
                acceptdate = #{acceptdate,jdbcType=VARCHAR},
            </if>
            <if test="acceptphone != null">
                acceptphone = #{acceptphone,jdbcType=VARCHAR},
            </if>
            <if test="accepttype != null">
                accepttype = #{accepttype,jdbcType=VARCHAR},
            </if>
            <if test="accepttool != null">
                accepttool = #{accepttool,jdbcType=VARCHAR},
            </if>
            <if test="askitem != null">
                askitem = #{askitem,jdbcType=VARCHAR},
            </if>
            <if test="askperson != null">
                askperson = #{askperson,jdbcType=VARCHAR},
            </if>
            <if test="askno != null">
                askno = #{askno,jdbcType=VARCHAR},
            </if>
            <if test="organization != null">
                organization = #{organization,jdbcType=VARCHAR},
            </if>
            <if test="orderperson != null">
                orderperson = #{orderperson,jdbcType=VARCHAR},
            </if>
            <if test="ordertime != null">
                ordertime = #{ordertime,jdbcType=VARCHAR},
            </if>
            <if test="doorstatus != null">
                doorstatus = #{doorstatus,jdbcType=INTEGER},
            </if>
            <if test="guidetime != null">
                guidetime = #{guidetime,jdbcType=VARCHAR},
            </if>
            <if test="jzxx != null">
                jzxx = #{jzxx,jdbcType=VARCHAR},
            </if>
            <if test="regdept != null">
                regdept = #{regdept,jdbcType=VARCHAR},
            </if>
            <if test="remark != null">
                remark = #{remark,jdbcType=VARCHAR},
            </if>
            <if test="username != null">
                username = #{username,jdbcType=VARCHAR},
            </if>
            <if test="daoyi != null">
                daoyi = #{daoyi,jdbcType=VARCHAR},
            </if>
            <if test="cjstatus != null">
                cjstatus = #{cjstatus,jdbcType=INTEGER},
            </if>
            <if test="zxremark != null">
                zxremark = #{zxremark,jdbcType=VARCHAR},
            </if>
            <if test="regno != null">
                regno = #{regno,jdbcType=VARCHAR},
            </if>
            <if test="source != null">
                source = #{source,jdbcType=VARCHAR},
            </if>
            <if test="isdelete != null">
                isdelete = #{isdelete,jdbcType=INTEGER},
            </if>
            <if test="askcontent != null">
                askcontent = #{askcontent,jdbcType=CLOB},
            </if>
        </set>
        where SEQ_ID = #{seqId,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.kqds.entity.base.KqdsNetOrder">
		update KQDS_NET_ORDER
		set createuser = #{createuser,jdbcType=VARCHAR},
		createtime = #{createtime,jdbcType=VARCHAR},
		usercode = #{usercode,jdbcType=VARCHAR},
		acceptdate = #{acceptdate,jdbcType=VARCHAR},
		acceptphone = #{acceptphone,jdbcType=VARCHAR},
		accepttype = #{accepttype,jdbcType=VARCHAR},
		accepttool = #{accepttool,jdbcType=VARCHAR},
		askitem = #{askitem,jdbcType=VARCHAR},
		askperson = #{askperson,jdbcType=VARCHAR},
		askno = #{askno,jdbcType=VARCHAR},
		organization =
		#{organization,jdbcType=VARCHAR},
		orderperson = #{orderperson,jdbcType=VARCHAR},
		ordertime = #{ordertime,jdbcType=VARCHAR},
		doorstatus = #{doorstatus,jdbcType=INTEGER},
		guidetime =
		#{guidetime,jdbcType=VARCHAR},
		jzxx = #{jzxx,jdbcType=VARCHAR},
		regdept = #{regdept,jdbcType=VARCHAR},
		remark = #{remark,jdbcType=VARCHAR},
		username = #{username,jdbcType=VARCHAR},
		daoyi = #{daoyi,jdbcType=VARCHAR},
		cjstatus = #{cjstatus,jdbcType=INTEGER},
		zxremark = #{zxremark,jdbcType=VARCHAR},
		regno = #{regno,jdbcType=VARCHAR},
		source =
		#{source,jdbcType=VARCHAR},
		isdelete = #{isdelete,jdbcType=INTEGER},
		askcontent = #{askcontent,jdbcType=CLOB}
		where SEQ_ID = #{seqId,jdbcType=VARCHAR}
	</update>
    <update id="updateByPrimaryKey" parameterType="com.kqds.entity.base.KqdsNetOrder">
		update KQDS_NET_ORDER
		set createuser = #{createuser,jdbcType=VARCHAR},
		createtime = #{createtime,jdbcType=VARCHAR},
		usercode =
		#{usercode,jdbcType=VARCHAR},
		acceptdate = #{acceptdate,jdbcType=VARCHAR},
		acceptphone = #{acceptphone,jdbcType=VARCHAR},
		accepttype = #{accepttype,jdbcType=VARCHAR},
		accepttool =
		#{accepttool,jdbcType=VARCHAR},
		askitem = #{askitem,jdbcType=VARCHAR},
		askperson = #{askperson,jdbcType=VARCHAR},
		askno = #{askno,jdbcType=VARCHAR},
		organization =
		#{organization,jdbcType=VARCHAR},
		orderperson = #{orderperson,jdbcType=VARCHAR},
		ordertime = #{ordertime,jdbcType=VARCHAR},
		doorstatus = #{doorstatus,jdbcType=INTEGER},
		guidetime =
		#{guidetime,jdbcType=VARCHAR},
		jzxx = #{jzxx,jdbcType=VARCHAR},
		regdept = #{regdept,jdbcType=VARCHAR},
		remark = #{remark,jdbcType=VARCHAR},
		username = #{username,jdbcType=VARCHAR},
		daoyi = #{daoyi,jdbcType=VARCHAR},
		cjstatus = #{cjstatus,jdbcType=INTEGER},
		zxremark = #{zxremark,jdbcType=VARCHAR},
		regno = #{regno,jdbcType=VARCHAR},
		source =
		#{source,jdbcType=VARCHAR},
		isdelete = #{isdelete,jdbcType=INTEGER}
		where SEQ_ID = #{seqId,jdbcType=VARCHAR}
	</update>

    <!--#################################### auto create ################################# -->
    <!--表名 -->
    <sql id="tableName">
		KQDS_NET_ORDER
	</sql>

    <select id="selectCountByMap" parameterType="map" resultType="int">
        select
        count(1)
        from
        <include refid="tableName"></include>
        where 1=1
        <foreach collection="params" index="key" item="val" open="" close="" separator=" ">  <!-- separator为空格 -->
            and ${key} = #{val}
        </foreach>
    </select>

    <select id="selectBeanListByMap" parameterType="map" resultType="KqdsNetOrder">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from
        <include refid="tableName"></include>
        where 1=1
        <foreach collection="params" index="key" item="val" open="" close="" separator=" ">  <!-- separator为空格 -->
            and ${key} = #{val}
        </foreach>
    </select>


    <select id="selectPageWd" parameterType="map" resultType="json">
        select
        n.SEQ_ID,
        dept.DEPT_NAME as organizationname,
        n.organization,
        n.doorstatus,
        n.cjstatus,
        n.createtime,
        per3.user_name as createuser,
        n.usercode,
        n.username,
        n.guidetime,
        per2.user_name as daoyi,
        per1.user_name as askperson,
        kcit1.dict_name as askitem,
        n.ordertime,
        n.remark,
        n.askcontent,
        u.PhoneNumber1,
        per4.user_name as jdr,
        u.createtime jdsj,
        u.doorstatus zdoorstatus
        from KQDS_NET_ORDER n
        left join KQDS_UserDocument u on u.usercode = n.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = n.askperson
        LEFT JOIN SYS_PERSON
        per2 on per2.SEQ_ID = n.daoyi
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = n.createuser
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.createuser
        LEFT JOIN SYS_DICT kcit1 on n.askitem =
        kcit1.seq_id
        LEFT JOIN SYS_DEPT dept on n.organization = dept.dept_code and dept.dept_parent = '0'
        where 1=1
        <if test="usercode != null and usercode !='' ">
            and n.usercode = #{usercode}
        </if>
        <if test="seqId != null and seqId !='' ">
            and n.seq_id = #{seqId}
        </if>
        ORDER BY n.CreateTime desc
    </select>
    <select id="getNetOrderByWXOrderSeqId" parameterType="java.lang.String" resultType="json">
		select * from KQDS_NET_ORDER where askno = #{_parameter}
	</select>
    <select id="checkNetOrderCount" parameterType="map" resultType="json">
        select usercode from KQDS_NET_ORDER where usercode = #{usercode} and ordertime like '%' + #{ordertime} + '%'
        <if test="seqId != null and seqId !='' ">
            and seq_id != #{seqId}
        </if>
    </select>
    <select id="selectFirstByUsercode" parameterType="java.lang.String" resultType="json">
        <bind name="temp_dbType" value="${system_dbType}"/>
        <if test="temp_dbType == 0">
            select seq_id,accepttype,accepttool,askitem,askcontent,ordertime,usercode,username,acceptdate from
            KQDS_NET_ORDER
            where 1=1 and usercode = #{_parameter} order by
            createtime asc limit 0,1
        </if>
        <if test="temp_dbType == 1">
            select TOP 1 seq_id,accepttype,accepttool,askitem,askcontent,ordertime,usercode,username,acceptdate from
            KQDS_NET_ORDER
            where 1=1 and usercode = #{_parameter} order by
            createtime asc
        </if>
    </select>
    <select id="selectNoPageYyzxNum" parameterType="map" resultType="json">
        select
        count(*) as numall,
        sum(n.doorstatus) as doorstatus,
        sum(n.cjstatus) as cjstatus
        from KQDS_NET_ORDER n
        left join KQDS_UserDocument u on u.usercode = n.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = n.askperson
        LEFT JOIN SYS_PERSON
        per2 on per2.SEQ_ID = n.daoyi
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = n.createuser
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.createuser
        LEFT JOIN SYS_DICT kcit1 on n.askitem =
        kcit1.seq_id
        LEFT JOIN SYS_DEPT dept on n.organization = dept.dept_code and dept.dept_parent = '0'
        where 1=1
        and n.isdelete=0
        <if test="organization != null and organization !='' ">
            and n.organization = #{organization}
        </if>
        <if test="starttime != null and starttime !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="createtime != null and createtime !='' ">
            n.createtime like '%' + #{createtime} + '%'
        </if>
        <if test="usercode != null and usercode !='' ">
            and n.usercode = #{usercode}
        </if>
        <if test="isdelete != null and isdelete !='' ">
            and n.isdelete = #{isdelete}
        </if>
        <if test="username != null and username !='' ">
            and (u.usercode like '%' + #{username} + '%'
            or u.username like '%' + #{username} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{username} + '%'
            )
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and n.doorstatus = #{doorstatus}
        </if>
        <if test="askperson != null and askperson !='' ">
            and n.askperson = #{askperson}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="createuser != null and createuser !='' ">
            and u.createuser = #{createuser}
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and (
            n.askperson in (${visualstaff})
            or n.orderperson in (${visualstaff})
            or n.daoyi in (${visualstaff})
            or n.createuser in (${visualstaff})
            or u.glr in (${visualstaff})
            or u.createuser in (${visualstaff})
            )
        </if>
    </select>

    <select id="selectNoPageYyzx" parameterType="map" resultType="json">
        select
        n.SEQ_ID,
        n.isdelete,
        dept.DEPT_NAME as organizationname,
        n.organization,
        n.doorstatus,
        n.cjstatus,
        n.createtime,
        per3.user_name as createuser,
        n.usercode,
        n.username,
        n.guidetime,
        per2.user_name as
        daoyi,
        per1.user_name as askperson,
        kcit1.dict_name as askitem,
        n.ordertime,
        n.remark,
        n.askcontent,
        u.PhoneNumber1,
        per4.user_name as jdr,
        u.createtime jdsj,
        u.doorstatus zdoorstatus
        from KQDS_NET_ORDER n
        left join KQDS_UserDocument u on u.usercode = n.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = n.askperson
        LEFT JOIN SYS_PERSON
        per2 on per2.SEQ_ID = n.daoyi
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = n.createuser
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.createuser
        LEFT JOIN SYS_DICT kcit1 on n.askitem =
        kcit1.seq_id
        LEFT JOIN SYS_DEPT dept on n.organization = dept.dept_code and dept.dept_parent = '0'
        where 1=1
        <if test="organization != null and organization !='' ">
            and n.organization = #{organization}
        </if>
        <if test="starttime != null and starttime !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="createtime != null and createtime !='' ">
            n.createtime like '%' + #{createtime} + '%'
        </if>
        <if test="usercode != null and usercode !='' ">
            and n.usercode = #{usercode}
        </if>
        <if test="isdelete != null and isdelete !='' ">
            and n.isdelete = #{isdelete}
        </if>
        <if test="username != null and username !='' ">
            and (u.usercode like '%' + #{username} + '%'
            or u.username like '%' + #{username} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{username} + '%'
            )
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and n.doorstatus = #{doorstatus}
        </if>
        <if test="askperson != null and askperson !='' ">
            and n.askperson = #{askperson}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="createuser != null and createuser !='' ">
            and u.createuser = #{createuser}
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and (
            n.askperson in (${visualstaff})
            or n.orderperson in (${visualstaff})
            or n.daoyi in (${visualstaff})
            or n.createuser in (${visualstaff})
            or u.glr in (${visualstaff})
            or u.createuser in (${visualstaff})
            )
        </if>
        <if test="sortName !=null and sortName != '' ">
            ORDER BY ${sortName} ${sortOrder}
        </if>
        <if test="sortName == null">
            ORDER BY n.createtime desc
        </if>
    </select>

    <!-- 添加sql,用于正畸部门查询网电信息 -->
    <select id="selectNoPageYyzxNetNum" parameterType="map" resultType="json">
        select
        count(*) as numall,
        sum(n.cjstatus) as cjstatus,
        sum(n.doorstatus) as doorstatus
        from KQDS_NET_ORDER n
        left join KQDS_UserDocument u on u.usercode = n.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = n.askperson
        LEFT JOIN SYS_PERSON
        per2 on per2.SEQ_ID = n.daoyi
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = n.createuser
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.createuser
        LEFT JOIN SYS_DICT kcit1 on n.askitem =
        kcit1.seq_id
        LEFT JOIN SYS_DEPT dept on n.organization = dept.dept_code and dept.dept_parent = '0'
        where 1=1
        and n.isdelete=0
        <if test="organization != null and organization !='' ">
            and n.organization = #{organization}
        </if>
        <if test="starttime != null and starttime !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="createtime != null and createtime !='' ">
            n.createtime like '%' + #{createtime} + '%'
        </if>
        <if test="usercode != null and usercode !='' ">
            and n.usercode = #{usercode}
        </if>
        <if test="isdelete != null and isdelete !='' ">
            and n.isdelete = #{isdelete}
        </if>
        <if test="username != null and username !='' ">
            and (u.usercode like '%' + #{username} + '%'
            or u.username like '%' + #{username} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{username} + '%'
            )
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and n.doorstatus = #{doorstatus}
        </if>
        <if test="askperson != null and askperson !='' ">
            and n.askperson = #{askperson}
        </if>
        <!-- <if test="xiangmu != null and xiangmu !='' "> -->
        <!-- and n.askitem = #{xiangmu} -->
        and n.askitem = 'zjl667'
        <!-- </if> -->
        <if test="createuser != null and createuser !='' ">
            and u.createuser = #{createuser}
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and (
            n.askperson in (${visualstaff})
            or n.orderperson in (${visualstaff})
            or n.daoyi in (${visualstaff})
            or n.createuser in (${visualstaff})
            or u.glr in (${visualstaff})
            or u.createuser in (${visualstaff})
            )
        </if>
    </select>

    <!-- 添加sql,用于正畸部门查询网电信息 -->
    <select id="selectNoPageYyzxNet" parameterType="map" resultType="json">
        select
        n.SEQ_ID,
        n.isdelete,
        dept.DEPT_NAME as organizationname,
        n.organization,
        n.doorstatus,
        n.cjstatus,
        n.createtime,
        per3.user_name as createuser,
        n.usercode,
        n.username,
        n.guidetime,
        per2.user_name as
        daoyi,
        per1.user_name as askperson,
        kcit1.dict_name as askitem,
        n.ordertime,
        n.remark,
        n.askcontent,
        u.PhoneNumber1,
        per4.user_name as jdr,
        u.createtime jdsj,
        u.doorstatus zdoorstatus
        from KQDS_NET_ORDER n
        left join KQDS_UserDocument u on u.usercode = n.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = n.askperson
        LEFT JOIN SYS_PERSON
        per2 on per2.SEQ_ID = n.daoyi
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = n.createuser
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.createuser
        LEFT JOIN SYS_DICT kcit1 on n.askitem =
        kcit1.seq_id
        LEFT JOIN SYS_DEPT dept on n.organization = dept.dept_code and dept.dept_parent = '0'
        where 1=1
        <if test="organization != null and organization !='' ">
            and n.organization = #{organization}
        </if>
        <if test="starttime != null and starttime !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="createtime != null and createtime !='' ">
            n.createtime like '%' + #{createtime} + '%'
        </if>
        <if test="usercode != null and usercode !='' ">
            and n.usercode = #{usercode}
        </if>
        <if test="isdelete != null and isdelete !='' ">
            and n.isdelete = #{isdelete}
        </if>
        <if test="username != null and username !='' ">
            and (u.usercode like '%' + #{username} + '%'
            or u.username like '%' + #{username} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{username} + '%'
            )
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and n.doorstatus = #{doorstatus}
        </if>
        <if test="askperson != null and askperson !='' ">
            and n.askperson = #{askperson}
        </if>
        <!-- <if test="xiangmu != null and xiangmu !='' "> -->
        <!-- and n.askitem = #{xiangmu} -->
        and n.askitem = 'zjl667'
        <!-- </if> -->
        <if test="createuser != null and createuser !='' ">
            and u.createuser = #{createuser}
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and (
            n.askperson in (${visualstaff})
            or n.orderperson in (${visualstaff})
            or n.daoyi in (${visualstaff})
            or n.createuser in (${visualstaff})
            or u.glr in (${visualstaff})
            or u.createuser in (${visualstaff})
            )
        </if>
        <if test="sortName !=null and sortName !='' ">
            ORDER BY ${sortName} ${sortOrder}
        </if>
        <if test="sortName == null">
            ORDER BY n.createtime desc
        </if>
    </select>

    <select id="selectNoPageYyzxWdNum" parameterType="map" resultType="json">
        select
        sum(n.doorstatus) as doorstatus,
        sum(n.cjstatus) as cjstatus
        from KQDS_NET_ORDER n
        left join KQDS_UserDocument u on u.usercode = n.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = n.askperson
        LEFT JOIN SYS_PERSON
        per2 on per2.SEQ_ID = n.daoyi
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = n.createuser
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.createuser
        LEFT JOIN SYS_DICT kcit1 on n.askitem =
        kcit1.seq_id
        LEFT JOIN SYS_DEPT dept on n.organization = dept.dept_code and dept.dept_parent = '0'
        where 1=1
        <if test="organization != null and organization !='' ">
            and n.organization = #{organization}
        </if>
        <if test="starttime != null and starttime !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="createtime != null and createtime !='' ">
            n.createtime like '%' + #{createtime} + '%'
        </if>
        <if test="usercode != null and usercode !='' ">
            and n.usercode = #{usercode}
        </if>

        <if test="username != null and username !='' ">
            and (u.usercode like '%' + #{username} + '%'
            or u.username like '%' + #{username} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{username} + '%'
            )
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and n.doorstatus = #{doorstatus}
        </if>
        <if test="askperson != null and askperson !='' ">
            and n.askperson = #{askperson}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="createuser != null and createuser !='' ">
            and u.createuser = #{createuser}
        </if>
        <if test="wdPersonIds != null and wdPersonIds !='' ">
            and (u.createuser in (${wdPersonIds}) or u.glr in (${wdPersonIds}))
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and (u.createuser in (${visualstaff}) or u.glr in (${visualstaff}))
        </if>
    </select>

    <select id="selectNoPageYyzxWd" parameterType="map" resultType="json">
        select
        n.SEQ_ID,
        n.isdelete,
        dept.DEPT_NAME as organizationname,
        n.organization,
        n.doorstatus,
        n.cjstatus,
        n.createtime,
        per3.user_name as createuser,
        n.usercode,
        n.username,
        n.guidetime,
        per2.user_name as
        daoyi,
        per1.user_name as askperson,
        kcit1.dict_name as askitem,
        n.ordertime,
        n.remark,
        n.askcontent,
        u.PhoneNumber1,
        per4.user_name as jdr,
        u.createtime jdsj,
        u.doorstatus zdoorstatus
        from KQDS_NET_ORDER n
        left join KQDS_UserDocument u on u.usercode = n.usercode
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = n.askperson
        LEFT JOIN SYS_PERSON
        per2 on per2.SEQ_ID = n.daoyi
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = n.createuser
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.createuser
        LEFT JOIN SYS_DICT kcit1 on n.askitem =
        kcit1.seq_id
        LEFT JOIN SYS_DEPT dept on n.organization = dept.dept_code and dept.dept_parent = '0'
        where 1=1
        <if test="organization != null and organization !='' ">
            and n.organization = #{organization}
        </if>
        <if test="starttime != null and starttime !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="createtime != null and createtime !='' ">
            n.createtime like '%' + #{createtime} + '%'
        </if>
        <if test="usercode != null and usercode !='' ">
            and n.usercode = #{usercode}
        </if>

        <if test="username != null and username !='' ">
            and (u.usercode like '%' + #{username} + '%'
            or u.username like '%' + #{username} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{username} + '%'
            )
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and n.doorstatus = #{doorstatus}
        </if>
        <if test="askperson != null and askperson !='' ">
            and n.askperson = #{askperson}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="createuser != null and createuser !='' ">
            and u.createuser = #{createuser}
        </if>
        <if test="wdPersonIds != null and wdPersonIds !='' ">
            and (u.createuser in (${wdPersonIds}) or u.glr in (${wdPersonIds}))
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and (u.createuser in (${visualstaff}) or u.glr in (${visualstaff}))
        </if>
        <if test="sortName != null and sortName !='' ">
            ORDER BY ${sortName} ${sortOrder}
        </if>
        <if test="sortName == null">
            ORDER BY n.createtime desc
        </if>
    </select>
    <select id="selectWithPage" parameterType="map" resultType="json">
        select * from KQDS_NET_ORDER n
        where 1=1
        <if test="createtime != null and createtime !='' ">
            n.createtime like '%' + #{createtime} + '%'
        </if>
        <if test="starttime != null and starttime !='' ">
            and n.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and n.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="usercode != null and usercode !='' ">
            and n.usercode = #{usercode}
        </if>
        <if test="username != null and username !='' ">
            and (u.usercode like '%' + #{username} + '%'
            or u.username like '%' + #{username} + '%'
            or u.pym like '%' + #{username} + '%'
            )
        </if>
        <if test="organization != null and organization !='' ">
            and n.organization = #{organization}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and n.doorstatus = #{doorstatus}
        </if>
        <if test="askperson != null and askperson !='' ">
            and n.askperson = #{askperson}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and n.askitem = #{xiangmu}
        </if>
        <if test="regdept != null and regdept !='' ">
            and n.regdept = #{regdept}
        </if>
        ORDER BY n.createtime desc
    </select>
    <select id="selectWithNopage" parameterType="map" resultType="json">
        select
        a.seq_id,
        a.isdelete,
        a.username,
        a.ordertime,
        a.guidetime,
        a.username,
        a.acceptdate,
        a.doorstatus,
        a.askperson,
        per2.user_name as askpersonname,
        a.orderperson,
        per3.user_name as
        orderpersonname,
        a.cjstatus,
        a.askitem,
        kcit1.dict_name as askitemname,
        a.askcontent,
        a.remark,
        a.accepttype,
        kcit3.dict_name as accepttypename,
        a.accepttool,
        kcit4.dict_name as
        accepttoolname,
        a.zxremark,
        a.createuser,
        per1.user_name as createusername,
        a.createtime,
        odept.dept_name as organizationname,
        u.iscreatelclj
        from KQDS_NET_ORDER a
        LEFT JOIN SYS_DEPT odept on
        odept.dept_code = a.organization and odept.dept_parent = '0'
        LEFT JOIN SYS_DICT kcit1 on a.askitem = kcit1.seq_id
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = a.createuser
        LEFT JOIN
        SYS_PERSON per2 on per2.SEQ_ID = a.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = a.orderperson
        LEFT JOIN SYS_DICT kcit3 on a.accepttype = kcit3.seq_id
        LEFT JOIN SYS_DICT
        kcit4 on a.accepttool = kcit4.seq_id
        left join KQDS_UserDocument u on u.usercode = a.usercode
        where 1=1
        <if test="createtime != null and createtime !='' ">
            a.createtime like '%' + #{createtime} + '%'
        </if>
        <if test="starttime != null and starttime !='' ">
            and a.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and a.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="usercode != null and usercode !='' ">
            and a.usercode = #{usercode}
        </if>
        <if test="organization != null and organization !='' ">
            and a.organization = #{organization}
        </if>
        <if test="doorstatus != null and doorstatus !='' ">
            and a.doorstatus = #{doorstatus}
        </if>
        <if test="askperson != null and askperson !='' ">
            and a.askperson = #{askperson}
        </if>
        <if test="xiangmu != null and xiangmu !='' ">
            and a.askitem = #{xiangmu}
        </if>
        <if test="regdept != null and regdept !='' ">
            and a.regdept = #{regdept}
        </if>
        ORDER BY a.createtime desc
    </select>
    <select id="selectNetOrderList" parameterType="map" resultType="json">
        <bind name="temp_dbType" value="${system_dbType}"/>
        select
        odept.dept_name as organizationname,
        (select guider from KQDS_UserDocument where usercode = n.usercode) as guider,
        n.doorstatus,
        n.isdelete,
        n.cjstatus,
        n.ordertime,
        n.usercode,
        n.username,
        n.acceptdate,
        n.acceptphone,
        n.accepttype,
        kcit1.dict_name as accepttypename,
        n.accepttool,
        kcit2.dict_name as accepttoolname,
        n.askitem,
        kcit4.dict_name as askitemname,
        n.regdept,
        odept2.dept_name as regdeptname,
        n.askperson,
        per2.user_name as askpersonname,
        u.kefu,
        per4.user_name as kefuname,
        n.orderperson,
        per1.user_name as orderpersonname,
        n.daoyi,
        per3.user_name as daoyiname,
        n.seq_id,
        u.doorstatus zdoorstatus,
        u.familyship,
        u.iscreateLclj,
        u.arrearage,
        u.contagion,
        u.increase
        from KQDS_NET_ORDER n
        LEFT JOIN KQDS_UserDocument u on u.usercode = n.usercode
        LEFT JOIN SYS_PERSON per4 on per4.SEQ_ID = u.kefu
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization
        and
        odept.dept_parent = '0'
        LEFT JOIN SYS_DEPT odept2 on odept2.seq_id = n.regdept
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = n.orderperson
        LEFT JOIN SYS_PERSON per2 on
        per2.SEQ_ID =
        n.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = n.daoyi
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool =
        kcit2.seq_id
        LEFT
        JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        where 1=1
        <if test="temp_dbType == 0">
            and to_days(n.ordertime) = to_days(now())
            and length(n.ordertime)<![CDATA[ >= ]]>
            16
        </if>
        <if test="temp_dbType == 1">
            and datediff(day, n.ordertime,getdate())=0
            and len(n.ordertime)<![CDATA[ >= ]]>
            16
        </if>
        <if test="querytype != null and querytype !='' ">
            and n.askperson in (${querytype})
        </if>
        <if test="searchValue != null and searchValue !='' ">
            and (u.usercode like '%' + #{searchValue} + '%'
            or u.username like '%' + #{searchValue} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{searchValue} + '%'
            )
        </if>
        <if test="organization != null and organization !='' ">
            and n.organization = #{organization}
        </if>
        and n.isdelete = 0
        <if test="sortName != null and sortName != '' ">
            ORDER BY ${sortName} ${sortOrder}
        </if>
        <if test="sortName == null">
            ORDER BY n.createtime desc
        </if>
    </select>
    <select id="selectNetOrderListNum" parameterType="map" resultType="json">
        <bind name="temp_dbType" value="${system_dbType}"/>
        select
        sum(n.cjstatus) as cjstatus,
        sum(n.doorstatus) as doorstatus
        from KQDS_NET_ORDER n
        left join KQDS_UserDocument u on u.usercode = n.usercode
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization and odept.dept_parent = '0'
        where 1=1
        <if test="temp_dbType == 0">
            and to_days(n.ordertime) = to_days(now())
            and length(n.ordertime)<![CDATA[ >= ]]>
            16
        </if>
        <if test="temp_dbType == 1">
            and datediff(day, n.ordertime,getdate())=0
            and len(n.ordertime)<![CDATA[ >= ]]>
            16
        </if>
        <if test="querytype != null and querytype !='' ">
            and n.askperson in (${querytype})
        </if>
        <if test="searchValue != null and searchValue !='' ">
            and (u.usercode like '%' + #{searchValue} + '%'
            or u.username like '%' + #{searchValue} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{searchValue} + '%'
            )
        </if>
        <if test="organization != null and organization !='' ">
            and n.organization = #{organization}
        </if>
        and n.isdelete = 0
    </select>
    <select id="selectListNoPage" parameterType="java.lang.String" resultType="json">
		select * from KQDS_NET_ORDER where 1=1 and usercode =#{_parameter} order by createtime desc
	</select>
    <select id="getCountIndex" parameterType="map" resultType="int">
        <bind name="temp_dbType" value="${system_dbType}"/>
        select count(1)
        from KQDS_NET_ORDER n
        left join KQDS_UserDocument u on u.usercode = n.usercode
        LEFT JOIN SYS_DEPT odept on odept.dept_code = u.organization
        and
        odept.dept_parent = '0'
        LEFT JOIN SYS_DEPT odept2 on odept2.seq_id = n.regdept
        LEFT JOIN SYS_PERSON per1 on per1.SEQ_ID = n.orderperson
        LEFT JOIN SYS_PERSON per2 on
        per2.SEQ_ID =
        n.askperson
        LEFT JOIN SYS_PERSON per3 on per3.SEQ_ID = n.daoyi
        LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
        LEFT JOIN SYS_DICT kcit2 on n.accepttool =
        kcit2.seq_id
        LEFT
        JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
        where 1=1
        <if test="temp_dbType == 0">
            and to_days(n.ordertime) = to_days(now())
            and length(n.ordertime)<![CDATA[ >= ]]>
            16
        </if>
        <if test="temp_dbType == 1">
            and datediff(day, n.ordertime,getdate())=0
            and len(n.ordertime)<![CDATA[ >= ]]>
            16
        </if>
        <if test="querytype != null and querytype !='' ">
            and n.askperson in (${querytype})
        </if>
        <if test="searchValue != null and searchValue !='' ">
            and (u.usercode like '%' + #{searchValue} + '%'
            or u.username like '%' + #{searchValue} + '%'
            or ${p1}
            or ${p2}
            or u.pym like '%' + #{searchValue} + '%'
            )
        </if>
        <if test="organization != null and organization !='' ">
            and n.organization = #{organization}
        </if>
        and n.isdelete = 0
    </select>
    <select id="getCountYy1" parameterType="map" resultType="int">
		select count(1) nums
		from kqds_net_order
		where 1=1 and ordertime <![CDATA[ >= ]]>
		#{starttime} and ordertime <![CDATA[ <= ]]>
		#{endtime}
	</select>
    <select id="getCountYysm1" parameterType="map" resultType="int">
		select count(1) nums
		from kqds_net_order
		where 1=1 and doorstatus=1 and ordertime <![CDATA[ >= ]]>
		#{starttime} and ordertime <![CDATA[ <= ]]>
		#{endtime}
	</select>
    <select id="getSml" parameterType="map" resultType="json">
        <bind name="temp_dbType" value="${system_dbType}"/>
        select
        <if test="temp_dbType == 0">
            Round(a.col1/IFNULL(b.col1,0),4)*100 sml
        </if>
        <if test="temp_dbType == 1">
            Round(convert(float,a.col1)/NULLIF(b.col1,0),4)*100 sml
        </if>
        from ( select count(1) col1 from kqds_net_order
        where doorstatus = 1 and ordertime <![CDATA[ >= ]]>
        #{startDate} and ordertime <![CDATA[ <= ]]>
        #{endDate} ) a,
        (select count(1) col1 from kqds_net_order
        where 1=1 and ordertime <![CDATA[ >= ]]>
        #{startDate} and ordertime <![CDATA[ <= ]]>
        #{endDate} ) b
    </select>
    <select id="getCountJd" parameterType="map" resultType="int">
        select count(1) nums from KQDS_UserDocument where 1=1
        <if test="starttime != null and starttime !='' ">
            and createtime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and createtime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="wdperson != null and wdperson !='' ">
            and createuser = #{wdperson}
        </if>
    </select>
    <select id="getCountYy2" parameterType="map" resultType="int">
        select count(1) nums from KQDS_NET_ORDER a,(select usercode from KQDS_NET_ORDER group by usercode) b
        left join KQDS_UserDocument u on u.usercode = b.usercode
        where
        a.usercode=b.usercode
        <if test="starttime != null and starttime !='' ">
            and a.createtime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and a.createtime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="wdperson != null and wdperson !='' ">
            and u.createuser = #{wdperson}
        </if>
    </select>
    <select id="getCountYysm" parameterType="map" resultType="int">
        select count(1) nums from KQDS_NET_ORDER a,(select usercode from KQDS_NET_ORDER group by usercode) b
        left join KQDS_UserDocument u on u.usercode = b.usercode
        where
        a.usercode=b.usercode and a.doorstatus=1
        <if test="starttime != null and starttime !='' ">
            and a.createtime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and a.createtime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="wdperson != null and wdperson !='' ">
            and u.createuser = #{wdperson}
        </if>
    </select>
    <select id="getYysr" parameterType="map" resultType="json">
        select sum(detail.paymoney)as paymoney,
        sum(detail.payother2) as zs,
        sum(detail.paydjq) as djq,
        sum(detail.payintegral) as integral,
        sum(detail.payyjj) as yjj
        from
        KQDS_COSTORDER_DETAIL detail
        LEFT JOIN KQDS_COSTORDER cost on cost.costno = detail.costno
        left join KQDS_UserDocument u on u.usercode = detail.usercode
        where 1=1
        and cost.status=2
        <if test="starttime != null and starttime !='' ">
            and cost.sftime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and cost.sftime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="wdperson != null and wdperson !='' ">
            and u.createuser = #{wdperson}
        </if>
    </select>
    <select id="getYysrYjj" parameterType="map" resultType="json">
        select sum(detail.cmoney)as cmoney
        from KQDS_Member_Record detail
        left join KQDS_UserDocument u on u.usercode = detail.usercode
        where 1=1 and detail.type !='缴费' and detail.type
        !='转赠' and detail.type !='受赠'
        <if test="starttime != null and starttime !='' ">
            and detail.createtime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and detail.createtime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="wdperson != null and wdperson !='' ">
            and u.createuser = #{wdperson}
        </if>
    </select>
    <select id="getCountCj" parameterType="map" resultType="json">
        select count(1) nums from KQDS_NET_ORDER a,(select usercode from KQDS_NET_ORDER group by usercode) b
        left join KQDS_UserDocument u on u.usercode = b.usercode
        where
        a.usercode=b.usercode
        and a.usercode in (select r.usercode from KQDS_REG r where r.usercode = a.usercode and r.cjstatus = '1')
        <if test="starttime != null and starttime !='' ">
            and a.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and a.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="wdperson != null and wdperson !='' ">
            and u.createuser = #{wdperson}
        </if>
    </select>
    <select id="getCountYy" parameterType="map" resultType="int">
        select count(1) nums from KQDS_NET_ORDER a,(select usercode from KQDS_NET_ORDER group by usercode) b
        left join KQDS_UserDocument u on u.usercode = b.usercode
        where
        a.usercode=b.usercode
        <if test="wdperson != null and wdperson !='' ">
            and u.createuser = #{wdperson}
        </if>
        <if test="starttime != null and starttime !='' ">
            and a.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and a.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="visualstaffwd != null and visualstaffwd !='' ">
            and u.createuser in(${visualstaffwd})
        </if>
        <if test="askitem != null and askitem !='' ">
            and a.askitem = #{askitem}
        </if>
        <if test="usercodes != null and usercodes !='' ">
            and u.usercode in(#{usercodes})
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and u.createuser in(${visualstaff})
        </if>
    </select>
    <!-- 2019-08-15 lwg 咨询统计表 预约 -->
    <select id="getCountYyList" parameterType="map" resultType="json">
        SELECT ISNULL(COUNT(a.nums), 0) as num,c.user_name,c.seq_id from sys_person c
        LEFT JOIN
        (select p.user_name as us,COUNT(o.usercode) as nums,p.SEQ_ID as seq
        from sys_person p
        LEFT JOIN KQDS_UserDocument u on u.CreateUser=p.SEQ_ID
        LEFT JOIN KQDS_NET_ORDER o ON o.usercode=u.usercode
        where 1=1
        and o.ordertime != ''
        and o.isdelete !=1
        <if test="deptId != null and deptId != '' ">
            and p.dept_id IN (#{deptId})
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and p.seq_id in (${visualstaff})
        </if>
        <if test="organization2 != null and organization2 !='' ">
            and u.organization= #{organization2}
        </if>
        <if test="devchannel !=null and devchannel !='' ">
            and u.devchannel=#{devchannel}
        </if>
        <if test="nexttype !=null and nexttype !='' ">
            and u.nexttype=#{nexttype}
        </if>
        <if test="jdtime2!=null and jdtime2 !=''">
            and u.createtime <![CDATA[ <= ]]> #{jdtime2}
        </if>
        <if test="jdtime1!=null and jdtime1 !=''">
            and u.createtime <![CDATA[ >= ]]> #{jdtime1}
        </if>
        <if test="yytime2!=null and yytime2 !=''">
            and o.createtime <![CDATA[ <= ]]> #{yytime2}
        </if>
        <if test="yytime1!=null and yytime1 !=''">
            and o.createtime <![CDATA[ >= ]]> #{yytime1}
        </if>
        <if test="askitem != null and askitem != '' ">
            and o.askitem=#{askitem}
        </if>
        <if test="accepttool != null and accepttool != '' ">
            and o.accepttool=#{accepttool}
        </if>
        GROUP BY p.user_name,p.seq_id,o.usercode
        <if test="askitem != null and askitem != '' ">
            ,o.askitem
        </if>
        ) as a on a.seq=c.seq_id
        where 1=1
        <if test="deptId != null and deptId != '' ">
            and c.dept_id IN (#{deptId})
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and c.seq_id in (${visualstaff})
        </if>
        GROUP BY a.us,c.user_name,c.seq_id
    </select>

    <!-- 2019-08-15 lwg 咨询项目情况统计表 预约 -->
    <select id="getCountYyItemList" parameterType="map" resultType="json">
        select p.user_name,COUNT(n.askitem) as yynums,p.SEQ_ID,n.askitem
        from sys_person p
        LEFT JOIN KQDS_UserDocument u on u.CreateUser=p.SEQ_ID
        LEFT JOIN (select a.usercode,a.askitem,a.createtime,a.accepttool,a.isdelete,a.ordertime from KQDS_NET_ORDER a ,
        (select usercode,min(createtime) createtime from KQDS_NET_ORDER group by usercode) b
        where a.usercode=b.usercode and a.createtime=b.createtime and a.ordertime != '' and a.isdelete!=1) n
        on n.usercode = u.usercode
        where 1=1
        <if test="deptId != null and deptId != '' ">
            and p.dept_id IN (#{deptId})
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and p.seq_id in (${visualstaff})
        </if>
        <if test="organization2 != null and organization2 !='' ">
            and u.organization= #{organization2}
        </if>
        <if test="devchannel !=null and devchannel !='' ">
            and u.devchannel=#{devchannel}
        </if>
        <if test="nexttype !=null and nexttype !='' ">
            and u.nexttype=#{nexttype}
        </if>
        <if test="jdtime2!=null and jdtime2 !=''">
            and u.createtime <![CDATA[ <= ]]> #{jdtime2}
        </if>
        <if test="jdtime1!=null and jdtime1 !=''">
            and u.createtime <![CDATA[ >= ]]> #{jdtime1}
        </if>
        <if test="yytime2!=null and yytime2 !=''">
            and n.createtime <![CDATA[ <= ]]> #{yytime2}
        </if>
        <if test="yytime1!=null and yytime1 !=''">
            and n.createtime <![CDATA[ >= ]]> #{yytime1}
        </if>
        <if test="askitem != null and askitem != '' ">
            and n.askitem=#{askitem}
        </if>
        <if test="accepttool != null and accepttool != '' ">
            and n.accepttool=#{accepttool}
        </if>
        AND n.askitem!=''
        GROUP BY p.user_name,p.seq_id,n.askitem
    </select>

    <!-- 2019-08-15 lwg 咨询项目统计表 预约 -->
    <select id="getCountYyItemStatisticsList" parameterType="map" resultType="json">
        select COUNT(n.askitem) as yynums,n.askitem
        from sys_person p
        LEFT JOIN KQDS_UserDocument u on u.CreateUser=p.SEQ_ID
        LEFT JOIN (select a.usercode,a.askitem,a.createtime,a.accepttool,a.isdelete,a.ordertime from KQDS_NET_ORDER a ,
        (select usercode,min(createtime) createtime from KQDS_NET_ORDER group by usercode) b
        where a.usercode=b.usercode and a.createtime=b.createtime and a.ordertime != '' and a.isdelete!=1) n
        on n.usercode = u.usercode
        where 1=1
        <if test="deptId != null and deptId != '' ">
            and p.dept_id IN (#{deptId})
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and p.seq_id in (${visualstaff})
        </if>
        <if test="organization2 != null and organization2 !='' ">
            and u.organization= #{organization2}
        </if>
        <if test="devchannel !=null and devchannel !='' ">
            and u.devchannel=#{devchannel}
        </if>
        <if test="nexttype !=null and nexttype !='' ">
            and u.nexttype=#{nexttype}
        </if>
        <if test="jdtime2!=null and jdtime2 !=''">
            and u.createtime <![CDATA[ <= ]]> #{jdtime2}
        </if>
        <if test="jdtime1!=null and jdtime1 !=''">
            and u.createtime <![CDATA[ >= ]]> #{jdtime1}
        </if>
        <if test="yytime2!=null and yytime2 !=''">
            and n.createtime <![CDATA[ <= ]]> #{yytime2}
        </if>
        <if test="yytime1!=null and yytime1 !=''">
            and n.createtime <![CDATA[ >= ]]> #{yytime1}
        </if>
        <if test="askitem != null and askitem != '' ">
            and n.askitem=#{askitem}
        </if>
        <if test="accepttool != null and accepttool != '' ">
            and n.accepttool=#{accepttool}
        </if>
        AND n.askitem!=''
        GROUP BY n.askitem
    </select>
    <!-- 2019-08-15 lwg 咨询统计表到诊 -->
    <select id="getCountDoorstatus" parameterType="map" resultType="json">
        SELECT ISNULL(a.nums, 0) as num,c.user_name,c.seq_id from sys_person c
        LEFT JOIN (
        select p.user_name as us,COUNT(p.USER_NAME) as nums,p.SEQ_ID as seq
        from sys_person p
        LEFT JOIN KQDS_UserDocument u on u.CreateUser=p.SEQ_ID
        LEFT JOIN KQDS_REG r on r.usercode=u.usercode
        LEFT JOIN KQDS_NET_ORDER o ON o.usercode = r.usercode
        where 1=1
        <if test="jdtime1!=null and jdtime1=='' and jdtime2 !=null and jdtime2 !='' or yytime1!=null and yytime1!='' and yytime2!=null and yytime2 !=''">
            and r.recesort='20'
        </if>
        and r.del !=1
        and o.isdelete!=1
        and o.doorstatus =1
        <if test="deptId != null and deptId != '' ">
            and p.dept_id IN (#{deptId})
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and p.seq_id in (${visualstaff})
        </if>
        <if test="organization2 != null and organization2 !='' ">
            and r.organization = #{organization2}
        </if>
        <if test="devchannel != null and devchannel != '' ">
            and u.devchannel=#{devchannel}
        </if>
        <if test="nexttype !=null and nexttype !='' ">
            and u.nexttype=#{nexttype}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and r.cjstatus=#{cjstatus}
        </if>
        <if test="accepttype != null and accepttype !='' ">
            and o.accepttype=#{accepttype}
        </if>
        <if test="accepttool !=null and accepttool !='' ">
            and o.accepttool=#{accepttool}
        </if>
        <if test="jdtime1 != null and jdtime1 != '' ">
            and u.createtime <![CDATA[ >= ]]> #{jdtime1}
        </if>
        <if test="jdtime2 !=null and jdtime2 !=''">
            and u.createtime <![CDATA[ <= ]]> #{jdtime2}
        </if>
        <if test="yytime1 != null and yytime1 != '' ">
            and o.createtime <![CDATA[ >= ]]> #{yytime1}
        </if>
        <if test="yytime2 !=null and yytime2 !=''">
            and o.createtime <![CDATA[ <= ]]> #{yytime2}
        </if>
        <if test="askitem != null and askitem != '' ">
            and o.askitem=#{askitem}
        </if>
        <if test="dztime1 != null and dztime1 != '' ">
            and r.createtime <![CDATA[ >= ]]> #{dztime1}
        </if>
        <if test="dztime2 !=null and dztime2 !=''">
            and r.createtime <![CDATA[ <= ]]> #{dztime2}
        </if>
        GROUP BY p.user_name,p.seq_id
        <if test="askitem != null and askitem != '' ">
            ,o.askitem
        </if>
        ) as a on a.seq=c.seq_id
        where 1=1
        <if test="deptId != null and deptId != '' ">
            and c.dept_id IN (#{deptId})
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and c.seq_id in (${visualstaff})
        </if>
    </select>
    <!-- 2019-08-15 lwg 咨询项目情况统计表 到诊 -->
    <select id="getCountDoorstatusItemList" parameterType="map" resultType="json">
        select p.user_name ,COUNT(o.askitem) as yysmnums,p.SEQ_ID,o.askitem
        from sys_person p
        LEFT JOIN KQDS_UserDocument u on u.CreateUser=p.SEQ_ID
        LEFT JOIN KQDS_REG r on r.usercode=u.usercode
        LEFT JOIN KQDS_NET_ORDER o ON o.usercode = r.usercode
        where 1=1
        and r.recesort='20'
        and r.del !=1
        and o.isdelete!=1
        and o.doorstatus =1
        <if test="deptId != null and deptId != '' ">
            and p.dept_id IN (#{deptId})
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and p.seq_id in (${visualstaff})
        </if>
        <if test="organization2 != null and organization2 !='' ">
            and r.organization = #{organization2}
        </if>
        <if test="devchannel != null and devchannel != '' ">
            and u.devchannel=#{devchannel}
        </if>
        <if test="nexttype !=null and nexttype !='' ">
            and u.nexttype=#{nexttype}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and r.cjstatus=#{cjstatus}
        </if>
        <if test="accepttype != null and accepttype !='' ">
            and o.accepttype=#{accepttype}
        </if>
        <if test="accepttool !=null and accepttool !='' ">
            and o.accepttool=#{accepttool}
        </if>
        <if test="jdtime1 != null and jdtime1 != '' ">
            and u.createtime <![CDATA[ >= ]]> #{jdtime1}
        </if>
        <if test="jdtime2 !=null and jdtime2 !=''">
            and u.createtime <![CDATA[ <= ]]> #{jdtime2}
        </if>
        <if test="yytime1 != null and yytime1 != '' ">
            and o.createtime <![CDATA[ >= ]]> #{yytime1}
        </if>
        <if test="yytime2 !=null and yytime2 !=''">
            and o.createtime <![CDATA[ <= ]]> #{yytime2}
        </if>
        <if test="askitem != null and askitem != '' ">
            and o.askitem=#{askitem}
        </if>
        <if test="dztime1 != null and dztime1 != '' ">
            and r.createtime <![CDATA[ >= ]]> #{dztime1}
        </if>
        <if test="dztime2 !=null and dztime2 !=''">
            and r.createtime <![CDATA[ <= ]]> #{dztime2}
        </if>
        GROUP BY p.user_name,p.seq_id,o.askitem
    </select>

    <!-- 2019-08-15 lwg 咨询项目统计表 到诊 -->
    <select id="getCountDoorstatusItemStatisticsList" parameterType="map" resultType="json">
        select COUNT(o.askitem) as yysmnums,o.askitem
        from sys_person p
        LEFT JOIN KQDS_UserDocument u on u.CreateUser=p.SEQ_ID
        LEFT JOIN KQDS_REG r on r.usercode=u.usercode
        LEFT JOIN KQDS_NET_ORDER o ON o.usercode = r.usercode
        where 1=1
        and r.recesort='20'
        and r.del !=1
        and o.isdelete!=1
        and o.doorstatus =1
        <if test="deptId != null and deptId != '' ">
            and p.dept_id IN (#{deptId})
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and p.seq_id in (${visualstaff})
        </if>
        <if test="organization2 != null and organization2 !='' ">
            and r.organization = #{organization2}
        </if>
        <if test="devchannel != null and devchannel != '' ">
            and u.devchannel=#{devchannel}
        </if>
        <if test="nexttype !=null and nexttype !='' ">
            and u.nexttype=#{nexttype}
        </if>
        <if test="cjstatus != null and cjstatus !='' ">
            and r.cjstatus=#{cjstatus}
        </if>
        <if test="accepttype != null and accepttype !='' ">
            and o.accepttype=#{accepttype}
        </if>
        <if test="accepttool !=null and accepttool !='' ">
            and o.accepttool=#{accepttool}
        </if>
        <if test="jdtime1 != null and jdtime1 != '' ">
            and u.createtime <![CDATA[ >= ]]> #{jdtime1}
        </if>
        <if test="jdtime2 !=null and jdtime2 !=''">
            and u.createtime <![CDATA[ <= ]]> #{jdtime2}
        </if>
        <if test="yytime1 != null and yytime1 != '' ">
            and o.createtime <![CDATA[ >= ]]> #{yytime1}
        </if>
        <if test="yytime2 !=null and yytime2 !=''">
            and o.createtime <![CDATA[ <= ]]> #{yytime2}
        </if>
        <if test="askitem != null and askitem != '' ">
            and o.askitem=#{askitem}
        </if>
        <if test="dztime1 != null and dztime1 != '' ">
            and r.createtime <![CDATA[ >= ]]> #{dztime1}
        </if>
        <if test="dztime2 !=null and dztime2 !=''">
            and r.createtime <![CDATA[ <= ]]> #{dztime2}
        </if>
        GROUP BY o.askitem
    </select>

    <select id="getCountYysm2" parameterType="map" resultType="int">
        select count(1) nums from KQDS_NET_ORDER a,(select usercode from KQDS_NET_ORDER group by usercode) b
        left join KQDS_UserDocument u on u.usercode = b.usercode
        where
        a.usercode=b.usercode and a.doorstatus=1
        <if test="wdperson != null and wdperson !='' ">
            and u.createuser = #{wdperson}
        </if>
        <if test="starttime != null and starttime !='' ">
            and a.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and a.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="visualstaffwd != null and visualstaffwd !='' ">
            and u.createuser in(${visualstaffwd})
        </if>
        <if test="askitem != null and askitem !='' ">
            and a.askitem = #{askitem}
        </if>
        <if test="usercodes != null and usercodes !='' ">
            and u.usercode in(#{usercodes})
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and u.createuser in(${visualstaff})
        </if>
    </select>
    <select id="getCountCj2" parameterType="map" resultType="int">
        select count(1) nums from KQDS_NET_ORDER a,(select usercode from KQDS_NET_ORDER group by usercode) b
        left join KQDS_UserDocument u on u.usercode = b.usercode
        where
        a.usercode=b.usercode and a.doorstatus=1
        and a.usercode in (select r.usercode from KQDS_REG r where r.usercode = a.usercode and r.cjstatus = '1')
        <if test="wdperson != null and wdperson !='' ">
            and u.createuser = #{wdperson}
        </if>
        <if test="starttime != null and starttime !='' ">
            and a.ordertime <![CDATA[ >= ]]>
            #{starttime}
        </if>
        <if test="endtime != null and endtime !='' ">
            and a.ordertime <![CDATA[ <= ]]>
            #{endtime}
        </if>
        <if test="visualstaffwd != null and visualstaffwd !='' ">
            and u.createuser in(${visualstaffwd})
        </if>
        <if test="askitem != null and askitem !='' ">
            and a.askitem = #{askitem}
        </if>
        <if test="usercodes != null and usercodes !='' ">
            and u.usercode in(#{usercodes})
        </if>
        <if test="visualstaff != null and visualstaff !='' ">
            and u.createuser in(${visualstaff})
        </if>
    </select>
    <select id="getCountCjList" parameterType="map" resultType="json">
        SELECT ISNULL(a.nums, 0) as num,c.user_name from sys_person c
        LEFT JOIN (
        select p.user_name as us,COUNT(p.USER_NAME) as nums,p.SEQ_ID as seq
        from sys_person p
        LEFT JOIN KQDS_UserDocument u on u.CreateUser=p.SEQ_ID
        LEFT JOIN KQDS_REG r on r.usercode=u.usercode
        LEFT JOIN KQDS_NET_ORDER o on o.regno=r.SEQ_ID
        where 1=1
        and r.recesort='20'
        and r.del !=1
        <if test="deptId != null and deptId != '' ">
            and p.dept_id IN (#{deptId})
        </if>
        <if test="seqId != null and seqId !='' ">
            and p.seq_id=#{seqId}
        </if>
        <if test="organization2 != null and organization2 !='' ">
            and r.organization = #{organization2}
        </if>
        <if test="devchannel != null and devchannel != '' ">
            and u.devchannel=#{devchannel}
        </if>
        and r.cjstatus=1
        <if test="accepttype != null and accepttype !='' ">
            and o.accepttype=#{accepttype}
        </if>
        <if test="accepttool !=null and accepttool !='' ">
            and o.accepttool=#{accepttool}
        </if>
        <if test="jdtime1 != null and jdtime1 != '' ">
            and u.createtime <![CDATA[ >= ]]> #{jdtime1}
        </if>
        <if test="jdtime2 !=null and jdtime2 !=''">
            and u.createtime <![CDATA[ <= ]]> #{jdtime2}
        </if>
        <if test="yytime1 != null and yytime1 != '' ">
            and o.createtime <![CDATA[ >= ]]> #{yytime1}
        </if>
        <if test="yytime2 !=null and yytime2 !=''">
            and o.createtime <![CDATA[ <= ]]> #{yytime2}
        </if>
        <if test="dztime1 != null and dztime1 != '' ">
            and r.createtime <![CDATA[ >= ]]> #{dztime1}
        </if>
        <if test="dztime2 !=null and dztime2 !=''">
            and r.createtime <![CDATA[ <= ]]> #{dztime2}
        </if>
        GROUP BY p.user_name,p.seq_id
        ) as a on a.seq=c.seq_id
        where 1=1
        <if test="deptId != null and deptId != '' ">
            and c.dept_id IN (#{deptId})
        </if>
        <if test="seqId != null and seqId !='' ">
            and c.seq_id=#{seqId}
        </if>
        ORDER BY c.SEQ_ID DESC
    </select>
    <select id="getCountWd" parameterType="map" resultType="int">
        select count(1) from KQDS_NET_ORDER n
        where 1=1
        and (n.askperson in (${visualstaff}) or n.createuser in (${visualstaff}) )
        <if test="ordertime != null and ordertime !='' ">
            ${ordertime}
        </if>
        <if test="organization != null and organization !='' ">
            and n.organization=#{organization}
        </if>
    </select>
    <select id="getWdList" parameterType="map" resultType="json">
		select odept.dept_name as organizationname,kcit1.dict_name as askitemname,kcit3.dict_name as
		accepttypename,kcit4.dict_name as accepttoolname,u.age,u.sex,n.* from KQDS_NET_ORDER n
		left join KQDS_USERDOCUMENT u on u.usercode = n.usercode
		LEFT JOIN SYS_DICT kcit3 on
		n.accepttype = kcit3.seq_id
		LEFT JOIN SYS_DICT kcit4 on n.accepttool = kcit4.seq_id
		LEFT JOIN SYS_DICT kcit1 on n.askitem = kcit1.seq_id
		LEFT JOIN SYS_DEPT odept on
		odept.dept_code =
		n.organization and odept.dept_parent = '0'
		where 1=1
		and (n.askperson in (${visualstaff}) or n.createuser in (${visualstaff}) )
		${ordertime}
		and n.organization =
		#{organization}
	</select>
    <select id="getWdListByUsercode" parameterType="map" resultType="json">
		select odept.dept_name as organizationname,kcit1.dict_name as askitemname,kcit3.dict_name as
		accepttypename,kcit4.dict_name as accepttoolname,u.age,u.sex,n.* from KQDS_NET_ORDER n
		left join KQDS_USERDOCUMENT u on u.usercode = n.usercode
		LEFT JOIN SYS_DICT kcit3 on
		n.accepttype = kcit3.seq_id
		LEFT JOIN SYS_DICT kcit4 on n.accepttool = kcit4.seq_id
		LEFT JOIN SYS_DICT kcit1 on n.askitem = kcit1.seq_id
		LEFT JOIN SYS_DEPT odept on
		odept.dept_code =
		n.organization and odept.dept_parent = '0'
		where 1=1
		and u.usercode = #{usercode}
		and n.organization = #{organization}
	</select>

    <insert id="batchSaveNetOrder" parameterType="java.util.List">
		insert into KQDS_NET_ORDER (SEQ_ID, createuser, createtime,
		usercode, acceptdate, acceptphone,
		accepttype, accepttool, askitem,
		askperson,
		askno, organization,
		orderperson, ordertime, doorstatus,
		guidetime, jzxx, regdept,
		remark, username, daoyi,
		cjstatus, zxremark, regno,
		source, isdelete, askcontent
		)
		values
		(#{seqId,jdbcType=VARCHAR}, #{createuser,jdbcType=VARCHAR}, #{createtime,jdbcType=VARCHAR},
		#{usercode,jdbcType=VARCHAR}, #{acceptdate,jdbcType=VARCHAR},
		#{acceptphone,jdbcType=VARCHAR},
		#{accepttype,jdbcType=VARCHAR}, #{accepttool,jdbcType=VARCHAR}, #{askitem,jdbcType=VARCHAR},
		#{askperson,jdbcType=VARCHAR},
		#{askno,jdbcType=VARCHAR}, #{organization,jdbcType=VARCHAR},
		#{orderperson,jdbcType=VARCHAR}, #{ordertime,jdbcType=VARCHAR}, #{doorstatus,jdbcType=INTEGER},
		#{guidetime,jdbcType=VARCHAR}, #{jzxx,jdbcType=VARCHAR}, #{regdept,jdbcType=VARCHAR},
		#{remark,jdbcType=VARCHAR}, #{username,jdbcType=VARCHAR}, #{daoyi,jdbcType=VARCHAR},
		#{cjstatus,jdbcType=INTEGER}, #{zxremark,jdbcType=VARCHAR}, #{regno,jdbcType=VARCHAR},
		#{source,jdbcType=VARCHAR}, #{isdelete,jdbcType=INTEGER}, #{askcontent,jdbcType=CLOB}
		)
	</insert>
    <select id="selectNameBySeqid" parameterType="java.util.Map" resultType="json">
		select 
		n.seq_id as seqid,
		kcit4.dict_name as askitem,
		kcit1.dict_name as accepttype,
		kcit2.dict_name as accepttool
		from KQDS_NET_ORDER n
		LEFT JOIN SYS_DICT kcit1 on n.accepttype = kcit1.seq_id
		LEFT JOIN SYS_DICT kcit2 on n.accepttool = kcit2.seq_id
		LEFT JOIN SYS_DICT kcit4 on n.askitem = kcit4.seq_id
		where n.seq_id in (${nseqid})
	</select>
</mapper>